{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/Task.tsx"],"sourcesContent":["\nimport { useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\nimport { CheckSquare, Link2, AlertCircle } from \"lucide-react\";\n\nconst PASTEL_COLORS = [\n  \"#E0F7FA\", // Cyan\n  \"#F1F8E9\", // Light Green\n  \"#FFF8E1\", // Amber\n  \"#F3E5F5\", // Purple\n  \"#E3F2FD\", // Blue\n  \"#FBE9E7\", // Deep Orange\n  \"#FFF3E0\", // Orange\n  \"#E8F5E9\", // Green\n  \"#FCE4EC\", // Pink\n  \"#E1F5FE\", // Light Blue\n];\n\nconst PRIORITY_COLORS = {\n  LOW: \"#D1FAE5\",\n  MEDIUM: \"#FEF3C7\",\n  HIGH: \"#FED7AA\",\n  URGENT: \"#FECACA\",\n};\n\nconst PRIORITY_LABELS = {\n  LOW: \"Baja\",\n  MEDIUM: \"Media\",\n  HIGH: \"Alta\",\n  URGENT: \"Urgente\",\n};\n\nfunction getTaskColor(id: string): string {\n  let hash = 0;\n  for (let i = 0; i < id.length; i++) {\n    hash = id.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  const index = Math.abs(hash) % PASTEL_COLORS.length;\n  return PASTEL_COLORS[index];\n}\n\nexport function Task({\n  id,\n  title,\n  isActive,\n  className,\n  onClick,\n  subtasksCount = 0,\n  isSubtask = false,\n  parentId,\n  level = 0,\n  priority,\n  assignees = [],\n  links = [],\n  checklist = [],\n}: {\n  id: string;\n  title: string;\n  isActive: boolean;\n  className?: string;\n  onClick?: (taskId: string) => void;\n  subtasksCount?: number;\n  isSubtask?: boolean;\n  parentId?: string | null;\n  level?: number;\n  priority?: string;\n  assignees?: { id: string; name: string | null; email: string | null; image: string | null }[];\n  links?: { title: string; url: string }[];\n  checklist?: { id: string; text: string; completed: boolean }[];\n}) {\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({\n    id,\n    data: {\n      type: \"Task\",\n    },\n  });\n\n  const colorSeed = parentId || id;\n  const backgroundColor = getTaskColor(colorSeed);\n\n  const style = {\n    transition,\n    transform: CSS.Transform.toString(transform),\n    marginLeft: level > 0 ? `${level * 20}px` : '0',\n    backgroundColor: isActive ? undefined : backgroundColor,\n  };\n\n  const completedChecklistItems = checklist.filter(item => item.completed).length;\n  const totalChecklistItems = checklist.length;\n\n  return (\n    <div\n      ref={setNodeRef}\n      style={style}\n      {...attributes}\n      {...listeners}\n      onClick={onClick ? () => onClick(id) : undefined}\n      className={`card ${isActive ? \"active\" : \"\"} ${isDragging ? \"dragging\" : \"\"} ${className || \"\"} `}\n    >\n      {/* Priority Badge */}\n      {priority && priority !== \"MEDIUM\" && (\n        <div\n          className=\"inline-block px-2 py-0.5 rounded text-xs font-medium mb-2\"\n          style={{\n            backgroundColor: PRIORITY_COLORS[priority as keyof typeof PRIORITY_COLORS],\n            color: '#1E293B'\n          }}\n        >\n          {PRIORITY_LABELS[priority as keyof typeof PRIORITY_LABELS]}\n        </div>\n      )}\n\n      <h3\n        style={{ color: 'black !important' }}\n        className=\"truncate overflow-hidden text-ellipsis\"\n        title={title}\n      >\n        {title}\n      </h3>\n\n      {/* Metadata Row */}\n      <div className=\"flex items-center gap-2 mt-2 flex-wrap\">\n        {/* Subtasks Count */}\n        {subtasksCount > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <CheckSquare size={14} />\n            <span>{subtasksCount}</span>\n          </div>\n        )}\n\n        {/* Checklist Progress */}\n        {totalChecklistItems > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <CheckSquare size={14} />\n            <span>{completedChecklistItems}/{totalChecklistItems}</span>\n          </div>\n        )}\n\n        {/* Links Indicator */}\n        {links.length > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <Link2 size={14} />\n            <span>{links.length}</span>\n          </div>\n        )}\n\n        {/* Assignee Avatars */}\n        {assignees.length > 0 && (\n          <div className=\"flex -space-x-2 ml-auto\">\n            {assignees.slice(0, 3).map((assignee) => (\n              assignee.image ? (\n                <img\n                  key={assignee.id}\n                  src={assignee.image}\n                  alt={assignee.name || assignee.email || \"User\"}\n                  className=\"w-6 h-6 rounded-full border-2 border-white\"\n                  title={assignee.name || assignee.email || \"\"}\n                />\n              ) : (\n                <div\n                  key={assignee.id}\n                  className=\"w-6 h-6 rounded-full bg-blue-200 border-2 border-white flex items-center justify-center text-xs font-medium text-neutral-900\"\n                  title={assignee.name || assignee.email || \"\"}\n                >\n                  {(assignee.name || assignee.email || \"?\")[0].toUpperCase()}\n                </div>\n              )\n            ))}\n            {assignees.length > 3 && (\n              <div className=\"w-6 h-6 rounded-full bg-gray-300 border-2 border-white flex items-center justify-center text-xs font-medium text-gray-700\">\n                +{assignees.length - 3}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;;;;;;AAEA,MAAM,gBAAgB;IACpB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAM,kBAAkB;IACtB,KAAK;IACL,QAAQ;IACR,MAAM;IACN,QAAQ;AACV;AAEA,MAAM,kBAAkB;IACtB,KAAK;IACL,QAAQ;IACR,MAAM;IACN,QAAQ;AACV;AAEA,SAAS,aAAa,EAAU;IAC9B,IAAI,OAAO;IACX,IAAK,IAAI,IAAI,GAAG,IAAI,GAAG,MAAM,EAAE,IAAK;QAClC,OAAO,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,IAAI,IAAI;IAC/C;IACA,MAAM,QAAQ,KAAK,GAAG,CAAC,QAAQ,cAAc,MAAM;IACnD,OAAO,aAAa,CAAC,MAAM;AAC7B;AAEO,SAAS,KAAK,EACnB,EAAE,EACF,KAAK,EACL,QAAQ,EACR,SAAS,EACT,OAAO,EACP,gBAAgB,CAAC,EACjB,YAAY,KAAK,EACjB,QAAQ,EACR,QAAQ,CAAC,EACT,QAAQ,EACR,YAAY,EAAE,EACd,QAAQ,EAAE,EACV,YAAY,EAAE,EAef;;IACC,MAAM,EACJ,UAAU,EACV,SAAS,EACT,UAAU,EACV,SAAS,EACT,UAAU,EACV,UAAU,EACX,GAAG,IAAA,qLAAW,EAAC;QACd;QACA,MAAM;YACJ,MAAM;QACR;IACF;IAEA,MAAM,YAAY,YAAY;IAC9B,MAAM,kBAAkB,aAAa;IAErC,MAAM,QAAQ;QACZ;QACA,WAAW,+KAAG,CAAC,SAAS,CAAC,QAAQ,CAAC;QAClC,YAAY,QAAQ,IAAI,GAAG,QAAQ,GAAG,EAAE,CAAC,GAAG;QAC5C,iBAAiB,WAAW,YAAY;IAC1C;IAEA,MAAM,0BAA0B,UAAU,MAAM,CAAC,CAAA,OAAQ,KAAK,SAAS,EAAE,MAAM;IAC/E,MAAM,sBAAsB,UAAU,MAAM;IAE5C,qBACE,6LAAC;QACC,KAAK;QACL,OAAO;QACN,GAAG,UAAU;QACb,GAAG,SAAS;QACb,SAAS,UAAU,IAAM,QAAQ,MAAM;QACvC,WAAW,CAAC,KAAK,EAAE,WAAW,WAAW,GAAG,CAAC,EAAE,aAAa,aAAa,GAAG,CAAC,EAAE,aAAa,GAAG,CAAC,CAAC;;YAGhG,YAAY,aAAa,0BACxB,6LAAC;gBACC,WAAU;gBACV,OAAO;oBACL,iBAAiB,eAAe,CAAC,SAAyC;oBAC1E,OAAO;gBACT;0BAEC,eAAe,CAAC,SAAyC;;;;;;0BAI9D,6LAAC;gBACC,OAAO;oBAAE,OAAO;gBAAmB;gBACnC,WAAU;gBACV,OAAO;0BAEN;;;;;;0BAIH,6LAAC;gBAAI,WAAU;;oBAEZ,gBAAgB,mBACf,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,6OAAW;gCAAC,MAAM;;;;;;0CACnB,6LAAC;0CAAM;;;;;;;;;;;;oBAKV,sBAAsB,mBACrB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,6OAAW;gCAAC,MAAM;;;;;;0CACnB,6LAAC;;oCAAM;oCAAwB;oCAAE;;;;;;;;;;;;;oBAKpC,MAAM,MAAM,GAAG,mBACd,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,oNAAK;gCAAC,MAAM;;;;;;0CACb,6LAAC;0CAAM,MAAM,MAAM;;;;;;;;;;;;oBAKtB,UAAU,MAAM,GAAG,mBAClB,6LAAC;wBAAI,WAAU;;4BACZ,UAAU,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,WAC1B,SAAS,KAAK,iBACZ,6LAAC;oCAEC,KAAK,SAAS,KAAK;oCACnB,KAAK,SAAS,IAAI,IAAI,SAAS,KAAK,IAAI;oCACxC,WAAU;oCACV,OAAO,SAAS,IAAI,IAAI,SAAS,KAAK,IAAI;mCAJrC,SAAS,EAAE;;;;yDAOlB,6LAAC;oCAEC,WAAU;oCACV,OAAO,SAAS,IAAI,IAAI,SAAS,KAAK,IAAI;8CAEzC,CAAC,SAAS,IAAI,IAAI,SAAS,KAAK,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,WAAW;mCAJnD,SAAS,EAAE;;;;;4BAQrB,UAAU,MAAM,GAAG,mBAClB,6LAAC;gCAAI,WAAU;;oCAA4H;oCACvI,UAAU,MAAM,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;AAQrC;GAhJgB;;QAoCV,qLAAW;;;KApCD"}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/Column.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useDroppable } from \"@dnd-kit/core\";\nimport { SortableContext, useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\nimport { Task } from \"./Task\";\nimport { Plus, X, GripVertical } from \"lucide-react\";\n\ninterface ColumnProps {\n  id: string;\n  title: string;\n  tasks: any[]; // Consider defining a more specific type for tasks if possible\n  onEditName: (columnId: string, newName: string) => void;\n  onDelete: (columnId: string) => void;\n  onCreateTask: (columnId: string) => void;\n  onTaskClick: (taskId: string) => void;\n}\n\nexport function Column({ id, title, tasks, onEditName, onDelete, onCreateTask, onTaskClick }: ColumnProps) {\n  const { setNodeRef: setDroppableNodeRef } = useDroppable({\n    id,\n    data: {\n      type: \"Column\",\n    },\n  });\n\n  const {\n    setNodeRef: setSortableNodeRef,\n    attributes,\n    listeners,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({ id: id, data: { type: \"Column\" } });\n\n  const style = {\n    transition,\n    transform: CSS.Transform.toString(transform),\n  };\n\n  const [isEditingTitle, setIsEditingTitle] = useState(false);\n  const [newTitle, setNewTitle] = useState(title);\n\n  const handleTitleDoubleClick = () => {\n    setIsEditingTitle(true);\n  };\n\n  const handleTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setNewTitle(e.target.value);\n  };\n\n  const handleTitleBlur = () => {\n    if (newTitle.trim() !== title) {\n      onEditName(id, newTitle.trim());\n    }\n    setIsEditingTitle(false);\n  };\n\n  const handleTitleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === \"Enter\") {\n      handleTitleBlur();\n    }\n    if (e.key === \"Escape\") {\n      setNewTitle(title);\n      setIsEditingTitle(false);\n    }\n  };\n\n  const handleAddTask = () => {\n    onCreateTask(id); // Call the prop with the column's ID\n  };\n\n  return (\n    <section\n      ref={(node) => {\n        setDroppableNodeRef(node);\n        setSortableNodeRef(node);\n      }}\n      style={style}\n      {...attributes}\n      className={`column flex-shrink-0 ${isDragging ? \"dragging\" : \"\"}`}\n    >\n      <div className=\"flex justify-between items-center mb-1\">\n        {isEditingTitle ? (\n          <input\n            type=\"text\"\n            value={newTitle}\n            onChange={handleTitleChange}\n            onBlur={handleTitleBlur}\n            onKeyDown={handleTitleKeyDown}\n            className=\"column-title-edit\" // Add specific styling for editing input\n            autoFocus\n          />\n        ) : (\n          <h2 className=\"column-title\" onDoubleClick={handleTitleDoubleClick}>\n            {title}\n          </h2>\n        )}\n        <div className=\"flex gap-2\">\n          {/* Add Task Button */}\n          <button onClick={handleAddTask} className=\"rounded-full w-8 h-8 flex items-center justify-center bg-[#2563EB] hover:bg-[#3B82F6]\" style={{ borderWidth: '1px', borderColor: 'white', borderStyle: 'solid' }}>\n            <Plus size={16} stroke=\"white\" fill=\"white\" />\n          </button>\n          {/* Delete Column Button */}\n          <button onClick={() => onDelete(id)} className=\"rounded-full w-8 h-8 flex items-center justify-center bg-[#EF4444] hover:bg-[#DC2626]\" style={{ borderWidth: '1px', borderColor: 'white', borderStyle: 'solid' }}>\n            <X size={16} stroke=\"white\" fill=\"white\" />\n          </button>\n          {/* Draggable handle for column */}\n          <button {...listeners} className=\"rounded-full w-8 h-8 flex items-center justify-center bg-[#FACC15] hover:bg-[#EAB308] cursor-grab\" style={{ borderWidth: '1px', borderColor: 'white', borderStyle: 'solid' }}>\n            <GripVertical size={16} stroke=\"white\" fill=\"white\" />\n          </button>\n        </div>\n      </div>\n      <div className=\"flex flex-col gap-[12px]\">\n        <SortableContext items={tasks.map((t) => t.id)}>\n          {tasks.map((task) => {\n            // Calculate the depth level of this task\n            const calculateLevel = (t: typeof task, allTasks: typeof tasks): number => {\n              if (!t.parentId) return 0;\n              const parent = allTasks.find(p => p.id === t.parentId);\n              if (!parent) return 0;\n              return 1 + calculateLevel(parent, allTasks);\n            };\n\n            const level = calculateLevel(task, tasks);\n\n            return (\n              <Task\n                key={task.id}\n                id={task.id}\n                title={task.title}\n                isActive={task.isActive}\n                onClick={onTaskClick}\n                subtasksCount={task.children?.length || 0}\n                isSubtask={!!task.parentId}\n                parentId={task.parentId}\n                level={level}\n                priority={task.priority || undefined}\n                assignees={task.assignees || []}\n                links={task.links ? JSON.parse(task.links) : []}\n                checklist={task.checklist ? JSON.parse(task.checklist) : []}\n              />\n            );\n          })}\n        </SortableContext>\n      </div>\n    </section>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 486, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 504, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n        shiny:\n          \"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground shadow-md hover:shadow-lg transition-shadow\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-lg px-3\",\n        lg: \"h-11 rounded-lg px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,uRACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;YACN,OACE;QACJ;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,2KAAgB,MAC7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAC9B,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 572, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/FileUploader.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useCallback } from \"react\";\nimport { Upload, X, File, Image as ImageIcon } from \"lucide-react\";\n\ninterface FileUploaderProps {\n    projectId: string;\n    taskId: string;\n    onUploadComplete: (fileData: {\n        url: string;\n        name: string;\n        size: number;\n        type: string;\n        uploadedAt: string;\n    }) => void;\n}\n\nexport function FileUploader({ projectId, taskId, onUploadComplete }: FileUploaderProps) {\n    const [isDragging, setIsDragging] = useState(false);\n    const [isUploading, setIsUploading] = useState(false);\n    const [uploadProgress, setUploadProgress] = useState(0);\n    const [error, setError] = useState<string | null>(null);\n\n    const handleDragOver = useCallback((e: React.DragEvent) => {\n        e.preventDefault();\n        setIsDragging(true);\n    }, []);\n\n    const handleDragLeave = useCallback((e: React.DragEvent) => {\n        e.preventDefault();\n        setIsDragging(false);\n    }, []);\n\n    const uploadFile = async (file: File) => {\n        setIsUploading(true);\n        setError(null);\n        setUploadProgress(0);\n\n        try {\n            const formData = new FormData();\n            formData.append(\"file\", file);\n            formData.append(\"projectId\", projectId);\n            formData.append(\"taskId\", taskId);\n\n            // Simulate progress (since we can't track real progress easily with fetch)\n            const progressInterval = setInterval(() => {\n                setUploadProgress((prev) => Math.min(prev + 10, 90));\n            }, 200);\n\n            const response = await fetch(\"/api/upload\", {\n                method: \"POST\",\n                body: formData,\n            });\n\n            clearInterval(progressInterval);\n            setUploadProgress(100);\n\n            if (!response.ok) {\n                const errorData = await response.json();\n                throw new Error(errorData.message || \"Upload failed\");\n            }\n\n            const fileData = await response.json();\n            onUploadComplete(fileData);\n\n            // Reset after success\n            setTimeout(() => {\n                setIsUploading(false);\n                setUploadProgress(0);\n            }, 500);\n        } catch (err) {\n            console.error(\"Upload error:\", err);\n            setError(err instanceof Error ? err.message : \"Upload failed\");\n            setIsUploading(false);\n            setUploadProgress(0);\n        }\n    };\n\n    const handleDrop = useCallback(\n        async (e: React.DragEvent) => {\n            e.preventDefault();\n            setIsDragging(false);\n\n            const files = Array.from(e.dataTransfer.files);\n            if (files.length > 0) {\n                await uploadFile(files[0]);\n            }\n        },\n        [projectId, taskId]\n    );\n\n    const handleFileSelect = useCallback(\n        async (e: React.ChangeEvent<HTMLInputElement>) => {\n            const files = e.target.files;\n            if (files && files.length > 0) {\n                await uploadFile(files[0]);\n            }\n            // Reset input\n            e.target.value = \"\";\n        },\n        [projectId, taskId]\n    );\n\n    return (\n        <div className=\"w-full\">\n            <div\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                onDrop={handleDrop}\n                className={`\n          border-2 border-dashed rounded-lg p-6 text-center transition-colors\n          ${isDragging ? \"border-blue-500 bg-blue-50\" : \"border-gray-300 bg-gray-50\"}\n          ${isUploading ? \"opacity-50 pointer-events-none\" : \"cursor-pointer hover:border-blue-400\"}\n        `}\n            >\n                <input\n                    type=\"file\"\n                    id=\"file-upload\"\n                    className=\"hidden\"\n                    onChange={handleFileSelect}\n                    disabled={isUploading}\n                />\n\n                {isUploading ? (\n                    <div className=\"space-y-3\">\n                        <Upload className=\"w-8 h-8 mx-auto text-blue-500 animate-bounce\" />\n                        <p className=\"text-sm text-gray-600\">Subiendo archivo...</p>\n                        <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                            <div\n                                className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\n                                style={{ width: `${uploadProgress}%` }}\n                            />\n                        </div>\n                        <p className=\"text-xs text-gray-500\">{uploadProgress}%</p>\n                    </div>\n                ) : (\n                    <label htmlFor=\"file-upload\" className=\"cursor-pointer\">\n                        <Upload className=\"w-8 h-8 mx-auto text-gray-400 mb-2\" />\n                        <p className=\"text-sm text-gray-600 mb-1\">\n                            Arrastra un archivo aquí o haz clic para seleccionar\n                        </p>\n                        <p className=\"text-xs text-gray-400\">\n                            Máximo 50MB • Imágenes, videos, PDFs, documentos\n                        </p>\n                    </label>\n                )}\n            </div>\n\n            {error && (\n                <div className=\"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2\">\n                    <X className=\"w-4 h-4 text-red-500 mt-0.5 flex-shrink-0\" />\n                    <p className=\"text-sm text-red-600\">{error}</p>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 822, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst prismaClientSingleton = () => {\n  return new PrismaClient();\n};\n\ndeclare global {\n  var prisma: undefined | ReturnType<typeof prismaClientSingleton>;\n}\n\nconst prisma = globalThis.prisma ?? prismaClientSingleton();\n\nexport default prisma;\n\nif (process.env.NODE_ENV !== \"production\") globalThis.prisma = prisma;"],"names":[],"mappings":";;;;AAcI;AAdJ;;AAEA,MAAM,wBAAwB;IAC5B,OAAO,IAAI,yKAAY;AACzB;AAMA,MAAM,SAAS,WAAW,MAAM,IAAI;uCAErB;AAEf,wCAA2C,WAAW,MAAM,GAAG"}},
    {"offset": {"line": 842, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/lib/permissions.ts"],"sourcesContent":["export const ROLES = {\n    ADMIN: 'ADMIN',\n    PROJECT_MANAGER: 'PROJECT_MANAGER',\n    ARTIST: 'ARTIST',\n    VIEWER: 'VIEWER',\n} as const;\n\nexport type Role = keyof typeof ROLES;\n\nexport const PERMISSIONS = {\n    // Workspace\n    MANAGE_WORKSPACE: ['ADMIN'],\n    CREATE_PROJECT: ['ADMIN', 'PROJECT_MANAGER'],\n    DELETE_PROJECT: ['ADMIN'],\n\n    // Project\n    MANAGE_PROJECT: ['ADMIN', 'PROJECT_MANAGER'],\n    VIEW_PROJECT: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST', 'VIEWER'],\n    MANAGE_ROLES: ['ADMIN', 'PROJECT_MANAGER'],\n\n    // Tasks\n    CREATE_TASK: ['ADMIN', 'PROJECT_MANAGER'],\n    EDIT_ANY_TASK: ['ADMIN', 'PROJECT_MANAGER'],\n    EDIT_OWN_TASK: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'],\n    DELETE_TASK: ['ADMIN', 'PROJECT_MANAGER'],\n    ASSIGN_TASK: ['ADMIN', 'PROJECT_MANAGER'],\n\n    // Comments\n    ADD_COMMENT: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'],\n    DELETE_ANY_COMMENT: ['ADMIN', 'PROJECT_MANAGER'],\n    DELETE_OWN_COMMENT: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'],\n\n    // Files\n    UPLOAD_FILE: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'],\n    DELETE_FILE: ['ADMIN', 'PROJECT_MANAGER'],\n} as const;\n\nexport function hasPermission(userRole: string, allowedRoles: readonly string[]): boolean {\n    return allowedRoles.includes(userRole);\n}\n\nimport prisma from \"@/lib/prisma\";\n\nexport async function getUserRoleInProject(userId: string, projectId: string): Promise<string> {\n    // 1. Check direct project role\n    const projectUser = await prisma.projectUser.findUnique({\n        where: {\n            projectId_userId: {\n                projectId,\n                userId,\n            },\n        },\n    });\n\n    if (projectUser) return projectUser.role;\n\n    // 2. Check workspace role (if implemented, workspace admins might have access to all projects)\n    // For now, we'll assume project-level roles are primary. \n    // But we should check if the user is a workspace admin.\n\n    const project = await prisma.project.findUnique({\n        where: { id: projectId },\n        select: { workspaceId: true },\n    });\n\n    if (project) {\n        const workspaceUser = await prisma.workspaceUser.findUnique({\n            where: {\n                workspaceId_userId: {\n                    workspaceId: project.workspaceId,\n                    userId,\n                },\n            },\n        });\n\n        if (workspaceUser && workspaceUser.role === ROLES.ADMIN) {\n            return ROLES.ADMIN;\n        }\n    }\n\n    // Default fallback (e.g., if user is owner of project)\n    const projectOwner = await prisma.project.findUnique({\n        where: { id: projectId },\n        select: { ownerId: true },\n    });\n\n    if (projectOwner && projectOwner.ownerId === userId) {\n        return ROLES.ADMIN;\n    }\n\n    return ROLES.VIEWER; // Default role if found but no specific role assigned? Or maybe null?\n    // For safety, let's return a restricted role or handle \"not found\"\n}\n"],"names":[],"mappings":";;;;;;;;;;AAyCA;AAzCO,MAAM,QAAQ;IACjB,OAAO;IACP,iBAAiB;IACjB,QAAQ;IACR,QAAQ;AACZ;AAIO,MAAM,cAAc;IACvB,YAAY;IACZ,kBAAkB;QAAC;KAAQ;IAC3B,gBAAgB;QAAC;QAAS;KAAkB;IAC5C,gBAAgB;QAAC;KAAQ;IAEzB,UAAU;IACV,gBAAgB;QAAC;QAAS;KAAkB;IAC5C,cAAc;QAAC;QAAS;QAAmB;QAAU;KAAS;IAC9D,cAAc;QAAC;QAAS;KAAkB;IAE1C,QAAQ;IACR,aAAa;QAAC;QAAS;KAAkB;IACzC,eAAe;QAAC;QAAS;KAAkB;IAC3C,eAAe;QAAC;QAAS;QAAmB;KAAS;IACrD,aAAa;QAAC;QAAS;KAAkB;IACzC,aAAa;QAAC;QAAS;KAAkB;IAEzC,WAAW;IACX,aAAa;QAAC;QAAS;QAAmB;KAAS;IACnD,oBAAoB;QAAC;QAAS;KAAkB;IAChD,oBAAoB;QAAC;QAAS;QAAmB;KAAS;IAE1D,QAAQ;IACR,aAAa;QAAC;QAAS;QAAmB;KAAS;IACnD,aAAa;QAAC;QAAS;KAAkB;AAC7C;AAEO,SAAS,cAAc,QAAgB,EAAE,YAA+B;IAC3E,OAAO,aAAa,QAAQ,CAAC;AACjC;;AAIO,eAAe,qBAAqB,MAAc,EAAE,SAAiB;IACxE,+BAA+B;IAC/B,MAAM,cAAc,MAAM,kIAAM,CAAC,WAAW,CAAC,UAAU,CAAC;QACpD,OAAO;YACH,kBAAkB;gBACd;gBACA;YACJ;QACJ;IACJ;IAEA,IAAI,aAAa,OAAO,YAAY,IAAI;IAExC,+FAA+F;IAC/F,0DAA0D;IAC1D,wDAAwD;IAExD,MAAM,UAAU,MAAM,kIAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAC5C,OAAO;YAAE,IAAI;QAAU;QACvB,QAAQ;YAAE,aAAa;QAAK;IAChC;IAEA,IAAI,SAAS;QACT,MAAM,gBAAgB,MAAM,kIAAM,CAAC,aAAa,CAAC,UAAU,CAAC;YACxD,OAAO;gBACH,oBAAoB;oBAChB,aAAa,QAAQ,WAAW;oBAChC;gBACJ;YACJ;QACJ;QAEA,IAAI,iBAAiB,cAAc,IAAI,KAAK,MAAM,KAAK,EAAE;YACrD,OAAO,MAAM,KAAK;QACtB;IACJ;IAEA,uDAAuD;IACvD,MAAM,eAAe,MAAM,kIAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QACjD,OAAO;YAAE,IAAI;QAAU;QACvB,QAAQ;YAAE,SAAS;QAAK;IAC5B;IAEA,IAAI,gBAAgB,aAAa,OAAO,KAAK,QAAQ;QACjD,OAAO,MAAM,KAAK;IACtB;IAEA,OAAO,MAAM,MAAM,EAAE,sEAAsE;AAC3F,mEAAmE;AACvE"}},
    {"offset": {"line": 995, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/hooks/usePermissions.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport { hasPermission, ROLES } from \"@/lib/permissions\";\n\nexport function usePermissions(projectId: string) {\n    const { data: session } = useSession();\n    const [userRole, setUserRole] = useState<string | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n\n    useEffect(() => {\n        if (!projectId || !session?.user) return;\n\n        setIsLoading(true);\n        fetch(`/api/projects/${projectId}/role`)\n            .then((res) => res.json())\n            .then((data) => {\n                setUserRole(data.role);\n                setIsLoading(false);\n            })\n            .catch((err) => {\n                console.error(\"Error fetching user role:\", err);\n                setIsLoading(false);\n            });\n    }, [projectId, session]);\n\n    const can = (permission: readonly string[]) => {\n        if (!userRole) return false;\n        return hasPermission(userRole, permission);\n    };\n\n    const isOwner = (userId: string) => {\n        return session?.user?.id === userId;\n    };\n\n    return {\n        userRole,\n        can,\n        isLoading,\n        isAdmin: userRole === ROLES.ADMIN,\n        isProjectManager: userRole === ROLES.PROJECT_MANAGER,\n        isArtist: userRole === ROLES.ARTIST,\n        isViewer: userRole === ROLES.VIEWER\n    };\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;AAEO,SAAS,eAAe,SAAiB;;IAC5C,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,IAAA,+JAAU;IACpC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAgB;IACxD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,IAAA,0KAAS;oCAAC;YACN,IAAI,CAAC,aAAa,CAAC,SAAS,MAAM;YAElC,aAAa;YACb,MAAM,CAAC,cAAc,EAAE,UAAU,KAAK,CAAC,EAClC,IAAI;4CAAC,CAAC,MAAQ,IAAI,IAAI;2CACtB,IAAI;4CAAC,CAAC;oBACH,YAAY,KAAK,IAAI;oBACrB,aAAa;gBACjB;2CACC,KAAK;4CAAC,CAAC;oBACJ,QAAQ,KAAK,CAAC,6BAA6B;oBAC3C,aAAa;gBACjB;;QACR;mCAAG;QAAC;QAAW;KAAQ;IAEvB,MAAM,MAAM,CAAC;QACT,IAAI,CAAC,UAAU,OAAO;QACtB,OAAO,IAAA,6IAAa,EAAC,UAAU;IACnC;IAEA,MAAM,UAAU,CAAC;QACb,OAAO,SAAS,MAAM,OAAO;IACjC;IAEA,OAAO;QACH;QACA;QACA;QACA,SAAS,aAAa,qIAAK,CAAC,KAAK;QACjC,kBAAkB,aAAa,qIAAK,CAAC,eAAe;QACpD,UAAU,aAAa,qIAAK,CAAC,MAAM;QACnC,UAAU,aAAa,qIAAK,CAAC,MAAM;IACvC;AACJ;GAvCgB;;QACc,+JAAU"}},
    {"offset": {"line": 1062, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/TaskDetailModal.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { X, File, Download, Trash2 } from \"lucide-react\";\nimport { createPortal } from \"react-dom\";\nimport { useRouter } from \"next/navigation\";\nimport { FileUploader } from \"./FileUploader\";\nimport { usePermissions } from \"@/hooks/usePermissions\";\nimport { PERMISSIONS } from \"@/lib/permissions\";\nimport { useSession } from \"next-auth/react\";\n\n// Recursive type for subtasks\ntype Subtask = {\n  id: string;\n  title: string;\n  description?: string;\n  children?: Subtask[];\n};\n\ninterface TaskDetailModalProps {\n  task: {\n    id: string;\n    title: string;\n    description?: string;\n    projectId: string;\n    columnId: string;\n    parentId?: string | null;\n    children?: Subtask[];\n    startDate?: string | null;\n    endDate?: string | null;\n    toleranceDate?: string | null;\n    priority?: string | null;\n    tags?: string | null;\n    links?: string | null;\n    checklist?: string | null;\n    attachments?: string | null;\n    images?: string | null;\n    assignees?: { id: string; name: string | null; email: string | null; image: string | null }[];\n  } | null;\n  onClose: () => void;\n  onTaskUpdate: () => void;\n  availableUsers: { id: string; name: string | null; email: string | null; image: string | null }[];\n}\n\nexport function TaskDetailModal({ task, onClose, onTaskUpdate, availableUsers }: TaskDetailModalProps) {\n  // ... existing state ...\n  const [selectedAssignees, setSelectedAssignees] = useState<string[]>(\n    task?.assignees?.map(a => a.id) || []\n  );\n\n  // ... existing code ...\n\n  const handleAddAssignee = async (userId: string) => {\n    if (!userId || selectedAssignees.includes(userId)) return;\n    const newAssignees = [...selectedAssignees, userId];\n    setSelectedAssignees(newAssignees);\n    try {\n      await fetch(`/api/projects/${task?.projectId}/tasks/${task?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ assignees: newAssignees }),\n      });\n      onTaskUpdate();\n    } catch (error) {\n      console.error(\"Error adding assignee:\", error);\n    }\n  };\n\n  const handleRemoveAssignee = async (userId: string) => {\n    const newAssignees = selectedAssignees.filter(id => id !== userId);\n    setSelectedAssignees(newAssignees);\n    try {\n      await fetch(`/api/projects/${task?.projectId}/tasks/${task?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ assignees: newAssignees }),\n      });\n      onTaskUpdate();\n    } catch (error) {\n      console.error(\"Error removing assignee:\", error);\n    }\n  };\n\n  // ... rest of the component ...\n  const [mounted, setMounted] = useState(false);\n  const modalRef = useRef<HTMLDivElement>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const [subtaskTitle, setSubtaskTitle] = useState(\"\");\n  const [isAddingSubtask, setIsAddingSubtask] = useState(false);\n  const router = useRouter();\n  const { data: session } = useSession();\n\n  // Permissions\n  const { can } = usePermissions(task?.projectId || \"\");\n  const isOwnTask = task?.assignees?.some(a => a.id === session?.user?.id) || false;\n\n  const canEdit = can(PERMISSIONS.EDIT_ANY_TASK) || (isOwnTask && can(PERMISSIONS.EDIT_OWN_TASK));\n  const canDelete = can(PERMISSIONS.DELETE_TASK);\n  const canAssign = can(PERMISSIONS.ASSIGN_TASK);\n\n  // Rich fields state\n  const [priority, setPriority] = useState<string>(task?.priority || \"MEDIUM\");\n  const [tags, setTags] = useState<{ name: string, color: string }[]>(\n    task?.tags ? JSON.parse(task.tags) : []\n  );\n  const [links, setLinks] = useState<{ title: string, url: string }[]>(\n    task?.links ? JSON.parse(task.links) : []\n  );\n  const [checklist, setChecklist] = useState<{ id: string, text: string, completed: boolean }[]>(\n    task?.checklist ? JSON.parse(task.checklist) : []\n  );\n  const [attachments, setAttachments] = useState<{ url: string, name: string, size: number, type: string, uploadedAt: string }[]>(\n    task?.attachments ? JSON.parse(task.attachments) : []\n  );\n  const [newTagName, setNewTagName] = useState(\"\");\n  const [newLinkTitle, setNewLinkTitle] = useState(\"\");\n  const [newLinkUrl, setNewLinkUrl] = useState(\"\");\n  const [newChecklistItem, setNewChecklistItem] = useState(\"\");\n\n  // User assignment state\n  // availableUsers is now passed as a prop\n  // selectedAssignees is initialized at the top\n\n\n  // Sync selectedAssignees when task.assignees changes\n  useEffect(() => {\n    if (task?.assignees) {\n      setSelectedAssignees(task.assignees.map(a => a.id));\n    }\n  }, [task?.assignees]);\n\n  useEffect(() => {\n    setMounted(true);\n    // Set initial centered position\n    if (typeof window !== 'undefined') {\n      setPosition({\n        x: (window.innerWidth - 560) / 2,\n        y: (window.innerHeight - 600) / 2  // Center vertically (assuming ~600px modal height)\n      });\n    }\n    return () => setMounted(false);\n  }, []);\n\n  // The handleMouseDown, handleMouseMove, handleMouseUp, and their useEffect\n  // have been updated to reflect the new dragging logic using dragStart\n  const handleMouseDown = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    setIsDragging(true);\n\n    // Calculate offset based on current state position\n    setDragStart({\n      x: e.clientX - position.x,\n      y: e.clientY - position.y\n    });\n  }, [position]);\n\n  const handleMouseMove = useCallback((e: MouseEvent) => {\n    if (isDragging) {\n      setPosition({\n        x: e.clientX - dragStart.x,\n        y: e.clientY - dragStart.y,\n      });\n    }\n  }, [isDragging, dragStart]);\n\n  const handleMouseUp = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  useEffect(() => {\n    if (isDragging) {\n      window.addEventListener('mousemove', handleMouseMove);\n      window.addEventListener('mouseup', handleMouseUp);\n    } else {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('mouseup', handleMouseUp);\n    }\n    return () => {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isDragging, handleMouseMove, handleMouseUp]);\n\n  // Fetch available users for assignment\n\n\n  const handleAddSubtask = async () => {\n    if (!subtaskTitle.trim() || !task) return;\n\n    setIsAddingSubtask(true);\n    try {\n      const response = await fetch(`/api/projects/${task.projectId}/tasks`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          title: subtaskTitle,\n          columnId: task.columnId,\n          parentId: task.id,\n        }),\n      });\n\n      if (response.ok) {\n        setSubtaskTitle(\"\");\n        onTaskUpdate(); // Refresh data via parent callback\n      } else {\n        console.error(\"Failed to create subtask\");\n      }\n    } catch (error) {\n      console.error(\"Error creating subtask:\", error);\n    } finally {\n      setIsAddingSubtask(false);\n    }\n  };\n\n  if (!task || !mounted) return null;\n\n  return createPortal(\n    <div\n      className=\"fixed inset-0 bg-gray-600 bg-opacity-75 z-50\"\n      onClick={onClose}\n    >\n      <div\n        ref={modalRef}\n        className=\"task-detail-modal\"\n        style={{\n          position: 'fixed',\n          left: position.x,\n          top: position.y,\n          cursor: isDragging ? 'grabbing' : 'grab',\n          minWidth: '320px',\n          maxWidth: '560px',\n        }}\n        onMouseDown={handleMouseDown}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className=\"modal-header flex justify-between items-center pb-4 border-b border-gray-200 mb-6 cursor-move -mt-[10px]\">\n          <h2 className=\"text-2xl font-bold text-[#0F172A]\">{task.title}</h2>\n          <button\n            onClick={onClose}\n            className=\"modal-close-btn\"\n          >\n            <X size={16} stroke=\"white\" fill=\"white\" />\n          </button>\n        </div>\n        <div className=\"modal-body overflow-y-auto max-h-[60vh] space-y-6 mt-[5px]\">\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2\">Description</h3>\n            <p className=\"text-gray-700 leading-loose\">{task.description || \"No description provided.\"}</p>\n          </div>\n\n          {/* Date Fields Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Fechas</h3>\n            <div className=\"grid grid-cols-1 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de inicio</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={task.startDate ? new Date(task.startDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ startDate: newDate }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error updating start date:\", error);\n                    }\n                  }}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de finalización</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={task.endDate ? new Date(task.endDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ endDate: newDate }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error updating end date:\", error);\n                    }\n                  }}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de tolerancia</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={task.toleranceDate ? new Date(task.toleranceDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ toleranceDate: newDate }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error updating tolerance date:\", error);\n                    }\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Priority Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Prioridad</h3>\n            <select\n              className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n              value={priority}\n              onChange={async (e) => {\n                const newPriority = e.target.value;\n                setPriority(newPriority);\n                try {\n                  await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                    method: \"PUT\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({ priority: newPriority }),\n                  });\n                  onTaskUpdate();\n                } catch (error) {\n                  console.error(\"Error updating priority:\", error);\n                }\n              }}\n            >\n              <option value=\"LOW\">Baja</option>\n              <option value=\"MEDIUM\">Media</option>\n              <option value=\"HIGH\">Alta</option>\n              <option value=\"URGENT\">Urgente</option>\n            </select>\n          </div>\n\n          {/* User Assignment Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Asignado a</h3>\n            <div className=\"flex flex-wrap gap-2 mb-3\">\n              {selectedAssignees.map((assigneeId) => {\n                const assignee = availableUsers.find(u => u.id === assigneeId) ||\n                  task?.assignees?.find(a => a.id === assigneeId);\n                if (!assignee) return null;\n\n                return (\n                  <div\n                    key={assignee.id}\n                    className=\"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-full\"\n                  >\n                    {assignee.image ? (\n                      <img\n                        src={assignee.image}\n                        alt={assignee.name || assignee.email || \"User\"}\n                        className=\"w-6 h-6 rounded-full\"\n                      />\n                    ) : (\n                      <div className=\"w-6 h-6 rounded-full bg-blue-200 flex items-center justify-center text-xs font-medium text-neutral-900\">\n                        {(assignee.name || assignee.email || \"?\")[0].toUpperCase()}\n                      </div>\n                    )}\n                    <span className=\"text-sm text-gray-700\">{assignee.name || assignee.email}</span>\n                    {canAssign && (\n                      <button\n                        className=\"text-gray-600 hover:text-red-600 ml-1\"\n                        onClick={async () => {\n                          const newAssignees = selectedAssignees.filter(id => id !== assignee.id);\n                          setSelectedAssignees(newAssignees);\n                          try {\n                            await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                              method: \"PUT\",\n                              headers: { \"Content-Type\": \"application/json\" },\n                              body: JSON.stringify({ assignees: newAssignees }),\n                            });\n                            onTaskUpdate();\n                          } catch (error) {\n                            console.error(\"Error removing assignee:\", error);\n                          }\n                        }}\n                      >\n                        ×\n                      </button>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n            <select\n              className=\"w-full p-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-600\"\n              onChange={(e) => {\n                if (e.target.value) {\n                  handleAddAssignee(e.target.value);\n                  e.target.value = \"\";\n                }\n              }}\n              disabled={!canAssign}\n            >\n              <option value=\"\">Agregar usuario...</option>\n              {availableUsers\n                .filter(user => !selectedAssignees.includes(user.id))\n                .map(user => (\n                  <option key={user.id} value={user.id}>\n                    {user.name || user.email}\n                  </option>\n                ))}\n            </select>\n          </div>\n\n          {/* Tags Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Etiquetas</h3>\n            <div className=\"flex flex-wrap gap-2 mb-3\">\n              {tags.map((tag, index) => (\n                <span\n                  key={index}\n                  className=\"px-3 py-1 rounded-full text-sm font-medium\"\n                  style={{ backgroundColor: tag.color || '#E0E7FF', color: '#1E293B' }}\n                >\n                  {tag.name}\n                  {canEdit && (\n                    <button\n                      className=\"ml-2 text-gray-600 hover:text-red-600\"\n                      onClick={async () => {\n                        const newTags = tags.filter((_, i) => i !== index);\n                        setTags(newTags);\n                        try {\n                          await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                            method: \"PUT\",\n                            headers: { \"Content-Type\": \"application/json\" },\n                            body: JSON.stringify({ tags: newTags }),\n                          });\n                          onTaskUpdate();\n                        } catch (error) {\n                          console.error(\"Error removing tag:\", error);\n                        }\n                      }}\n                    >\n                      ×\n                    </button>\n                  )}\n                </span>\n              ))}\n            </div>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Nueva etiqueta\"\n                className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newTagName}\n                onChange={(e) => setNewTagName(e.target.value)}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && newTagName.trim()) {\n                    const colors = ['#E0E7FF', '#FEF3C7', '#D1FAE5', '#FCE7F3', '#E0F2FE'];\n                    const newTag = { name: newTagName.trim(), color: colors[tags.length % colors.length] };\n                    const newTags = [...tags, newTag];\n                    setTags(newTags);\n                    setNewTagName(\"\");\n                    fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ tags: newTags }),\n                    }).then(() => onTaskUpdate());\n                  }\n                }}\n                disabled={!canEdit}\n              />\n              <button\n                className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                onClick={async () => {\n                  if (!newTagName.trim()) return;\n                  const colors = ['#E0E7FF', '#FEF3C7', '#D1FAE5', '#FCE7F3', '#E0F2FE'];\n                  const newTag = { name: newTagName.trim(), color: colors[tags.length % colors.length] };\n                  const newTags = [...tags, newTag];\n                  setTags(newTags);\n                  setNewTagName(\"\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ tags: newTags }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error adding tag:\", error);\n                  }\n                }}\n              >\n                Agregar\n              </button>\n            </div>\n          </div>\n\n          {/* Links Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Enlaces</h3>\n            <div className=\"space-y-2 mb-3\">\n              {links.map((link, index) => (\n                <div key={index} className=\"flex items-center justify-between p-2 bg-gray-50 rounded-lg\">\n                  <a\n                    href={link.url}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-blue-600 hover:underline flex-1 truncate\"\n                  >\n                    {link.title || link.url}\n                  </a>\n                  <button\n                    className=\"ml-2 text-gray-600 hover:text-red-600\"\n                    onClick={async () => {\n                      const newLinks = links.filter((_, i) => i !== index);\n                      setLinks(newLinks);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ links: newLinks }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error removing link:\", error);\n                      }\n                    }}\n                  >\n                    ×\n                  </button>\n                </div>\n              ))}\n            </div>\n            <div className=\"space-y-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Título del enlace\"\n                className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newLinkTitle}\n                onChange={(e) => setNewLinkTitle(e.target.value)}\n              />\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"url\"\n                  placeholder=\"https://ejemplo.com\"\n                  className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                  value={newLinkUrl}\n                  onChange={(e) => setNewLinkUrl(e.target.value)}\n                />\n                <button\n                  className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                  onClick={async () => {\n                    if (!newLinkUrl.trim()) return;\n                    const newLink = { title: newLinkTitle.trim() || newLinkUrl, url: newLinkUrl.trim() };\n                    const newLinks = [...links, newLink];\n                    setLinks(newLinks);\n                    setNewLinkTitle(\"\");\n                    setNewLinkUrl(\"\");\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ links: newLinks }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error adding link:\", error);\n                    }\n                  }}\n                >\n                  Agregar\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Checklist Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Checklist</h3>\n            <div className=\"space-y-2 mb-3\">\n              {checklist.map((item) => (\n                <div key={item.id} className=\"flex items-center gap-2\">\n                  <input\n                    type=\"checkbox\"\n                    checked={item.completed}\n                    className=\"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-600\"\n                    onChange={async (e) => {\n                      const newChecklist = checklist.map(i =>\n                        i.id === item.id ? { ...i, completed: e.target.checked } : i\n                      );\n                      setChecklist(newChecklist);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ checklist: newChecklist }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error updating checklist:\", error);\n                      }\n                    }}\n                  />\n                  <span className={`flex-1 ${item.completed ? 'line-through text-gray-500' : 'text-gray-700'}`}>\n                    {item.text}\n                  </span>\n                  <button\n                    className=\"text-gray-600 hover:text-red-600\"\n                    onClick={async () => {\n                      const newChecklist = checklist.filter(i => i.id !== item.id);\n                      setChecklist(newChecklist);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ checklist: newChecklist }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error removing checklist item:\", error);\n                      }\n                    }}\n                  >\n                    ×\n                  </button>\n                </div>\n              ))}\n            </div>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Nuevo item\"\n                className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newChecklistItem}\n                onChange={(e) => setNewChecklistItem(e.target.value)}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && newChecklistItem.trim()) {\n                    const newItem = { id: Date.now().toString(), text: newChecklistItem.trim(), completed: false };\n                    const newChecklist = [...checklist, newItem];\n                    setChecklist(newChecklist);\n                    setNewChecklistItem(\"\");\n                    fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ checklist: newChecklist }),\n                    }).then(() => onTaskUpdate());\n                  }\n                }}\n              />\n              <button\n                className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                onClick={async () => {\n                  if (!newChecklistItem.trim()) return;\n                  const newItem = { id: Date.now().toString(), text: newChecklistItem.trim(), completed: false };\n                  const newChecklist = [...checklist, newItem];\n                  setChecklist(newChecklist);\n                  setNewChecklistItem(\"\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ checklist: newChecklist }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error adding checklist item:\", error);\n                  }\n                }}\n              >\n                Agregar\n              </button>\n            </div>\n          </div>\n\n          {/* Attachments Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Archivos Adjuntos</h3>\n\n            {/* File List */}\n            {attachments.length > 0 && (\n              <div className=\"space-y-2 mb-4\">\n                {attachments.map((file, index) => (\n                  <div\n                    key={index}\n                    className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200\"\n                  >\n                    <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                      <File className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-medium text-gray-700 truncate\">{file.name}</p>\n                        <p className=\"text-xs text-gray-500\">\n                          {(file.size / 1024 / 1024).toFixed(2)} MB • {new Date(file.uploadedAt).toLocaleDateString()}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <a\n                        href={file.url}\n                        download\n                        className=\"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors\"\n                        title=\"Descargar\"\n                      >\n                        <Download size={16} />\n                      </a>\n                      <button\n                        className=\"p-2 text-red-600 hover:bg-red-50 rounded transition-colors\"\n                        title=\"Eliminar\"\n                        onClick={async () => {\n                          const newAttachments = attachments.filter((_, i) => i !== index);\n                          setAttachments(newAttachments);\n                          try {\n                            await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                              method: \"PUT\",\n                              headers: { \"Content-Type\": \"application/json\" },\n                              body: JSON.stringify({ attachments: newAttachments }),\n                            });\n                            onTaskUpdate();\n                          } catch (error) {\n                            console.error(\"Error removing attachment:\", error);\n                          }\n                        }}\n                      >\n                        <Trash2 size={16} />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {/* File Uploader */}\n            <FileUploader\n              projectId={task.projectId}\n              taskId={task.id}\n              onUploadComplete={async (fileData) => {\n                const newAttachments = [...attachments, fileData];\n                setAttachments(newAttachments);\n                try {\n                  await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                    method: \"PUT\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({ attachments: newAttachments }),\n                  });\n                  onTaskUpdate();\n                } catch (error) {\n                  console.error(\"Error saving attachment:\", error);\n                }\n              }}\n            />\n          </div>\n\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Subtasks</h3>\n\n            {/* Recursive subtask renderer */}\n            {(() => {\n              const renderSubtasks = (subtasks: typeof task.children, depth = 0): React.ReactElement[] => {\n                if (!subtasks || subtasks.length === 0) return [];\n\n                return subtasks.map((subtask) => (\n                  <li key={subtask.id} style={{ marginLeft: `${depth * 16}px` }} className=\"text-gray-700 flex items-start gap-2 leading-relaxed\">\n                    <span className=\"mt-1.5 w-1.5 h-1.5 rounded-full bg-gray-400 flex-shrink-0\" />\n                    <div className=\"flex-1\">\n                      <span>{subtask.title}</span>\n                      {subtask.children && subtask.children.length > 0 && (\n                        <ul className=\"space-y-2 mt-2\">\n                          {renderSubtasks(subtask.children, depth + 1)}\n                        </ul>\n                      )}\n                    </div>\n                  </li>\n                ));\n              };\n\n              // Calculate current task depth\n              const calculateDepth = (t: typeof task, allTasks: any[] = []): number => {\n                // This is a simplified depth calculation for the modal\n                // In a real scenario, you'd need to traverse up the parent chain\n                // For now, we'll use a heuristic based on parentId presence\n                let depth = 0;\n                let current = t;\n                // We can't traverse up without fetching parent data, so we'll use a simpler approach\n                // Just count if this task has a parentId (depth 1+)\n                if (current.parentId) depth = 1;\n                // For more accurate depth, we'd need to fetch the full parent chain\n                // For now, we'll allow subtask creation and let the backend handle validation\n                return depth;\n              };\n\n              const currentDepth = calculateDepth(task);\n              const maxDepth = 5;\n              const canAddSubtask = currentDepth < maxDepth;\n\n              return (\n                <>\n                  {task.children && task.children.length > 0 ? (\n                    <ul className=\"space-y-3 mb-4\">\n                      {renderSubtasks(task.children)}\n                    </ul>\n                  ) : (\n                    <p className=\"text-gray-500 italic mb-4\">No subtasks yet.</p>\n                  )}\n\n                  {/* UI to add new subtask */}\n                  <div className=\"flex gap-3 mt-[10px]\">\n                    <input\n                      type=\"text\"\n                      placeholder={canAddSubtask ? \"New subtask title\" : \"Max depth reached (5 levels)\"}\n                      className=\"flex-grow p-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB] transition-shadow\"\n                      value={subtaskTitle}\n                      onChange={(e) => setSubtaskTitle(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter' && canAddSubtask) {\n                          handleAddSubtask();\n                        }\n                      }}\n                      disabled={!canAddSubtask}\n                    />\n                    <button\n                      className=\"btn-primary whitespace-nowrap\"\n                      onClick={handleAddSubtask}\n                      disabled={isAddingSubtask || !subtaskTitle.trim() || !canAddSubtask}\n                    >\n                      {isAddingSubtask ? 'Adding...' : 'Add Subtask'}\n                    </button>\n                  </div>\n                </>\n              );\n            })()}\n          </div>\n\n          {/* Modal Footer with Delete Button */}\n          <div className=\"modal-footer mt-6 pt-4 border-t border-gray-200 flex justify-end\">\n            {canDelete && (\n              <button\n                className=\"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium\"\n                onClick={async () => {\n                  if (confirm(`¿Estás seguro de que quieres eliminar \"${task.title}\"?${task.children && task.children.length > 0 ? ' Esto también eliminará todas sus subtareas.' : ''}`)) {\n                    try {\n                      const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"DELETE\",\n                      });\n\n                      if (response.ok) {\n                        onClose();\n                        onTaskUpdate(); // Refresh the board\n                      } else {\n                        alert(\"Error al eliminar la tarea\");\n                      }\n                    } catch (error) {\n                      console.error(\"Error deleting task:\", error);\n                      alert(\"Error al eliminar la tarea\");\n                    }\n                  }\n                }}\n              >\n                <Trash2 size={16} className=\"inline-block mr-2\" />\n                Eliminar Tarea\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>,\n    document.body\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2567, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/FilterBuilder.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState } from \"react\";\nimport { X, Plus, Trash2 } from \"lucide-react\";\nimport { createPortal } from \"react-dom\";\n\nexport interface FilterCondition {\n    field: \"assignee\" | \"priority\" | \"tags\" | \"dueDate\" | \"column\" | \"hasAttachments\" | \"checklistStatus\";\n    operator: \"equals\" | \"contains\" | \"before\" | \"after\" | \"isEmpty\" | \"isNotEmpty\";\n    value: string | string[] | Date | boolean;\n}\n\nexport interface FilterCriteria {\n    conditions: FilterCondition[];\n    operator: \"AND\" | \"OR\";\n}\n\ninterface FilterBuilderProps {\n    projectId: string;\n    availableUsers: { id: string; name: string | null; email: string | null }[];\n    availableColumns: { id: string; name: string }[];\n    onClose: () => void;\n    onSave: (name: string, criteria: FilterCriteria) => void;\n}\n\nconst FIELD_OPTIONS = [\n    { value: \"assignee\", label: \"Asignado a\" },\n    { value: \"priority\", label: \"Prioridad\" },\n    { value: \"tags\", label: \"Etiquetas\" },\n    { value: \"dueDate\", label: \"Fecha de vencimiento\" },\n    { value: \"column\", label: \"Columna\" },\n    { value: \"hasAttachments\", label: \"Tiene archivos\" },\n    { value: \"checklistStatus\", label: \"Estado de checklist\" },\n];\n\nconst PRIORITY_OPTIONS = [\n    { value: \"LOW\", label: \"Baja\" },\n    { value: \"MEDIUM\", label: \"Media\" },\n    { value: \"HIGH\", label: \"Alta\" },\n    { value: \"URGENT\", label: \"Urgente\" },\n];\n\nexport function FilterBuilder({\n    projectId,\n    availableUsers,\n    availableColumns,\n    onClose,\n    onSave,\n}: FilterBuilderProps) {\n    const [mounted, setMounted] = useState(false);\n    const [filterName, setFilterName] = useState(\"\");\n    const [operator, setOperator] = useState<\"AND\" | \"OR\">(\"AND\");\n    const [conditions, setConditions] = useState<FilterCondition[]>([\n        { field: \"assignee\", operator: \"equals\", value: \"\" },\n    ]);\n\n    React.useEffect(() => {\n        setMounted(true);\n    }, []);\n\n    const addCondition = () => {\n        setConditions([\n            ...conditions,\n            { field: \"assignee\", operator: \"equals\", value: \"\" },\n        ]);\n    };\n\n    const removeCondition = (index: number) => {\n        setConditions(conditions.filter((_, i) => i !== index));\n    };\n\n    const updateCondition = (index: number, updates: Partial<FilterCondition>) => {\n        const newConditions = [...conditions];\n        newConditions[index] = { ...newConditions[index], ...updates };\n        setConditions(newConditions);\n    };\n\n    const handleSave = () => {\n        if (!filterName.trim()) {\n            alert(\"Por favor ingresa un nombre para el filtro\");\n            return;\n        }\n\n        if (conditions.length === 0) {\n            alert(\"Agrega al menos una condición\");\n            return;\n        }\n\n        onSave(filterName, { conditions, operator });\n        onClose();\n    };\n\n    const renderValueInput = (condition: FilterCondition, index: number) => {\n        switch (condition.field) {\n            case \"assignee\":\n                return (\n                    <select\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    >\n                        <option value=\"\">Seleccionar usuario...</option>\n                        {availableUsers.map((user) => (\n                            <option key={user.id} value={user.id}>\n                                {user.name || user.email}\n                            </option>\n                        ))}\n                    </select>\n                );\n\n            case \"priority\":\n                return (\n                    <select\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    >\n                        <option value=\"\">Seleccionar prioridad...</option>\n                        {PRIORITY_OPTIONS.map((opt) => (\n                            <option key={opt.value} value={opt.value}>\n                                {opt.label}\n                            </option>\n                        ))}\n                    </select>\n                );\n\n            case \"column\":\n                return (\n                    <select\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    >\n                        <option value=\"\">Seleccionar columna...</option>\n                        {availableColumns.map((col) => (\n                            <option key={col.id} value={col.id}>\n                                {col.name}\n                            </option>\n                        ))}\n                    </select>\n                );\n\n            case \"tags\":\n                return (\n                    <input\n                        type=\"text\"\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        placeholder=\"Nombre de etiqueta...\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    />\n                );\n\n            case \"dueDate\":\n                return (\n                    <input\n                        type=\"date\"\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    />\n                );\n\n            case \"hasAttachments\":\n            case \"checklistStatus\":\n                return (\n                    <select\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value === \"true\" })}\n                    >\n                        <option value=\"true\">Sí</option>\n                        <option value=\"false\">No</option>\n                    </select>\n                );\n\n            default:\n                return null;\n        }\n    };\n\n    if (!mounted) return null;\n\n    return createPortal(\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col\">\n                {/* Header */}\n                <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n                    <h2 className=\"text-xl font-semibold text-gray-900\">Crear Filtro Personalizado</h2>\n                    <button\n                        onClick={onClose}\n                        className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n                    >\n                        <X size={20} className=\"text-gray-500\" />\n                    </button>\n                </div>\n\n                {/* Content */}\n                <div className=\"flex-1 overflow-y-auto p-6 space-y-6\">\n                    {/* Filter Name */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Nombre del Filtro\n                        </label>\n                        <input\n                            type=\"text\"\n                            className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            placeholder=\"Ej: Tareas Urgentes Sin Asignar\"\n                            value={filterName}\n                            onChange={(e) => setFilterName(e.target.value)}\n                        />\n                    </div>\n\n                    {/* Operator */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Operador Lógico\n                        </label>\n                        <div className=\"flex gap-4\">\n                            <label className=\"flex items-center gap-2 cursor-pointer\">\n                                <input\n                                    type=\"radio\"\n                                    name=\"operator\"\n                                    value=\"AND\"\n                                    checked={operator === \"AND\"}\n                                    onChange={() => setOperator(\"AND\")}\n                                    className=\"text-blue-600\"\n                                />\n                                <span className=\"text-sm\">AND (todas las condiciones)</span>\n                            </label>\n                            <label className=\"flex items-center gap-2 cursor-pointer\">\n                                <input\n                                    type=\"radio\"\n                                    name=\"operator\"\n                                    value=\"OR\"\n                                    checked={operator === \"OR\"}\n                                    onChange={() => setOperator(\"OR\")}\n                                    className=\"text-blue-600\"\n                                />\n                                <span className=\"text-sm\">OR (cualquier condición)</span>\n                            </label>\n                        </div>\n                    </div>\n\n                    {/* Conditions */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n                            Condiciones\n                        </label>\n                        <div className=\"space-y-3\">\n                            {conditions.map((condition, index) => (\n                                <div key={index} className=\"flex gap-2 items-start\">\n                                    {/* Field */}\n                                    <select\n                                        className=\"w-40 p-2 border border-gray-300 rounded-lg text-sm\"\n                                        value={condition.field}\n                                        onChange={(e) =>\n                                            updateCondition(index, {\n                                                field: e.target.value as FilterCondition[\"field\"],\n                                                value: \"\",\n                                            })\n                                        }\n                                    >\n                                        {FIELD_OPTIONS.map((opt) => (\n                                            <option key={opt.value} value={opt.value}>\n                                                {opt.label}\n                                            </option>\n                                        ))}\n                                    </select>\n\n                                    {/* Operator */}\n                                    <select\n                                        className=\"w-32 p-2 border border-gray-300 rounded-lg text-sm\"\n                                        value={condition.operator}\n                                        onChange={(e) =>\n                                            updateCondition(index, {\n                                                operator: e.target.value as FilterCondition[\"operator\"],\n                                            })\n                                        }\n                                    >\n                                        <option value=\"equals\">es igual a</option>\n                                        <option value=\"contains\">contiene</option>\n                                        {condition.field === \"dueDate\" && (\n                                            <>\n                                                <option value=\"before\">antes de</option>\n                                                <option value=\"after\">después de</option>\n                                            </>\n                                        )}\n                                        <option value=\"isEmpty\">está vacío</option>\n                                        <option value=\"isNotEmpty\">no está vacío</option>\n                                    </select>\n\n                                    {/* Value */}\n                                    {condition.operator !== \"isEmpty\" && condition.operator !== \"isNotEmpty\" && (\n                                        renderValueInput(condition, index)\n                                    )}\n\n                                    {/* Remove Button */}\n                                    {conditions.length > 1 && (\n                                        <button\n                                            onClick={() => removeCondition(index)}\n                                            className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                                        >\n                                            <Trash2 size={18} />\n                                        </button>\n                                    )}\n                                </div>\n                            ))}\n                        </div>\n\n                        {/* Add Condition Button */}\n                        <button\n                            onClick={addCondition}\n                            className=\"mt-3 flex items-center gap-2 px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\n                        >\n                            <Plus size={16} />\n                            Agregar Condición\n                        </button>\n                    </div>\n                </div>\n\n                {/* Footer */}\n                <div className=\"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50\">\n                    <button\n                        onClick={onClose}\n                        className=\"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg transition-colors\"\n                    >\n                        Cancelar\n                    </button>\n                    <button\n                        onClick={handleSave}\n                        className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"\n                    >\n                        Guardar Filtro\n                    </button>\n                </div>\n            </div>\n        </div>,\n        document.body\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3199, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/FilterBar.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useEffect } from \"react\";\nimport { Filter, ChevronDown, X, Plus, Trash2 } from \"lucide-react\";\nimport { FilterBuilder, FilterCriteria } from \"./FilterBuilder\";\n\nexport type FilterType = \"all\" | \"my-tasks\" | \"unassigned\" | \"overdue\" | \"this-week\" | \"custom\";\n\ninterface FilterOption {\n    id: FilterType | string;\n    label: string;\n    description: string;\n    isCustom?: boolean;\n}\n\ninterface SavedFilter {\n    id: string;\n    name: string;\n    criteria: string;\n    isDefault: boolean;\n}\n\nconst PREDEFINED_FILTERS: FilterOption[] = [\n    { id: \"all\", label: \"Todas las Tareas\", description: \"Mostrar todas las tareas\" },\n    { id: \"my-tasks\", label: \"Mis Tareas\", description: \"Tareas asignadas a mí\" },\n    { id: \"unassigned\", label: \"Sin Asignar\", description: \"Tareas sin usuario asignado\" },\n    { id: \"overdue\", label: \"Vencidas\", description: \"Tareas con fecha vencida\" },\n    { id: \"this-week\", label: \"Esta Semana\", description: \"Vencen en los próximos 7 días\" },\n];\n\ninterface FilterBarProps {\n    projectId: string;\n    currentUserId: string;\n    activeFilter: FilterType | string;\n    onFilterChange: (filter: FilterType | string, criteria?: FilterCriteria) => void;\n    availableUsers?: { id: string; name: string | null; email: string | null }[];\n    availableColumns?: { id: string; name: string }[];\n}\n\nexport function FilterBar({\n    projectId,\n    currentUserId,\n    activeFilter,\n    onFilterChange,\n    availableUsers = [],\n    availableColumns = []\n}: FilterBarProps) {\n    const [isOpen, setIsOpen] = useState(false);\n    const [isBuilderOpen, setIsBuilderOpen] = useState(false);\n    const [savedFilters, setSavedFilters] = useState<SavedFilter[]>([]);\n\n    // Load saved filters\n    useEffect(() => {\n        fetch(`/api/projects/${projectId}/filters`)\n            .then(res => res.json())\n            .then(filters => setSavedFilters(filters))\n            .catch(err => console.error(\"Error loading filters:\", err));\n    }, [projectId]);\n\n    const handleSaveFilter = async (name: string, criteria: FilterCriteria) => {\n        try {\n            const response = await fetch(`/api/projects/${projectId}/filters`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ name, criteria }),\n            });\n\n            if (response.ok) {\n                const newFilter = await response.json();\n                setSavedFilters([...savedFilters, newFilter]);\n                onFilterChange(newFilter.id, criteria);\n            }\n        } catch (error) {\n            console.error(\"Error saving filter:\", error);\n        }\n    };\n\n    const handleDeleteFilter = async (filterId: string) => {\n        if (!confirm(\"¿Eliminar este filtro?\")) return;\n\n        try {\n            const response = await fetch(`/api/projects/${projectId}/filters/${filterId}`, {\n                method: \"DELETE\",\n            });\n\n            if (response.ok) {\n                setSavedFilters(savedFilters.filter(f => f.id !== filterId));\n                if (activeFilter === filterId) {\n                    onFilterChange(\"all\");\n                }\n            }\n        } catch (error) {\n            console.error(\"Error deleting filter:\", error);\n        }\n    };\n\n    const allFilters: FilterOption[] = [\n        ...PREDEFINED_FILTERS,\n        ...savedFilters.map(f => ({\n            id: f.id,\n            label: f.name,\n            description: \"Filtro personalizado\",\n            isCustom: true,\n        })),\n    ];\n\n    const activeFilterLabel = allFilters.find(f => f.id === activeFilter)?.label || \"Filtros\";\n\n    return (\n        <>\n            <div className=\"relative\">\n                {/* Filter Button */}\n                <button\n                    onClick={() => setIsOpen(!isOpen)}\n                    className=\"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n                >\n                    <Filter size={16} className=\"text-gray-600\" />\n                    <span className=\"text-sm font-medium text-gray-700\">{activeFilterLabel}</span>\n                    <ChevronDown size={16} className={`text-gray-600 transition-transform ${isOpen ? \"rotate-180\" : \"\"}`} />\n                </button>\n\n                {/* Active Filter Indicator */}\n                {activeFilter !== \"all\" && (\n                    <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white\" />\n                )}\n\n                {/* Dropdown Menu */}\n                {isOpen && (\n                    <>\n                        {/* Backdrop */}\n                        <div\n                            className=\"fixed inset-0 z-10\"\n                            onClick={() => setIsOpen(false)}\n                        />\n\n                        {/* Menu */}\n                        <div className=\"absolute top-full left-0 mt-2 w-72 bg-white border border-gray-200 rounded-lg shadow-lg z-20\">\n                            <div className=\"p-2\">\n                                <div className=\"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3 py-2\">\n                                    Filtros Predefinidos\n                                </div>\n                                {PREDEFINED_FILTERS.map((filter) => (\n                                    <button\n                                        key={filter.id}\n                                        onClick={() => {\n                                            onFilterChange(filter.id as FilterType);\n                                            setIsOpen(false);\n                                        }}\n                                        className={`\n                      w-full text-left px-3 py-2 rounded-md transition-colors\n                      ${activeFilter === filter.id\n                                                ? \"bg-blue-50 text-blue-700\"\n                                                : \"hover:bg-gray-50 text-gray-700\"\n                                            }\n                    `}\n                                    >\n                                        <div className=\"font-medium text-sm\">{filter.label}</div>\n                                        <div className=\"text-xs text-gray-500 mt-0.5\">{filter.description}</div>\n                                    </button>\n                                ))}\n                            </div>\n\n                            {/* Custom Filters */}\n                            {savedFilters.length > 0 && (\n                                <div className=\"border-t border-gray-200 p-2\">\n                                    <div className=\"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3 py-2\">\n                                        Filtros Personalizados\n                                    </div>\n                                    {savedFilters.map((filter) => (\n                                        <div\n                                            key={filter.id}\n                                            className={`\n                        flex items-center justify-between px-3 py-2 rounded-md transition-colors\n                        ${activeFilter === filter.id\n                                                    ? \"bg-blue-50\"\n                                                    : \"hover:bg-gray-50\"\n                                                }\n                      `}\n                                        >\n                                            <button\n                                                onClick={() => {\n                                                    onFilterChange(filter.id, JSON.parse(filter.criteria));\n                                                    setIsOpen(false);\n                                                }}\n                                                className=\"flex-1 text-left\"\n                                            >\n                                                <div className=\"font-medium text-sm text-gray-700\">{filter.name}</div>\n                                            </button>\n                                            <button\n                                                onClick={(e) => {\n                                                    e.stopPropagation();\n                                                    handleDeleteFilter(filter.id);\n                                                }}\n                                                className=\"p-1 text-red-600 hover:bg-red-50 rounded transition-colors\"\n                                            >\n                                                <Trash2 size={14} />\n                                            </button>\n                                        </div>\n                                    ))}\n                                </div>\n                            )}\n\n                            {/* Create Filter Button */}\n                            <div className=\"border-t border-gray-200 p-2\">\n                                <button\n                                    onClick={() => {\n                                        setIsOpen(false);\n                                        setIsBuilderOpen(true);\n                                    }}\n                                    className=\"w-full flex items-center gap-2 px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-md transition-colors font-medium\"\n                                >\n                                    <Plus size={16} />\n                                    Crear Filtro Personalizado\n                                </button>\n                            </div>\n\n                            {/* Clear Filter */}\n                            {activeFilter !== \"all\" && (\n                                <div className=\"border-t border-gray-200 p-2\">\n                                    <button\n                                        onClick={() => {\n                                            onFilterChange(\"all\");\n                                            setIsOpen(false);\n                                        }}\n                                        className=\"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded-md transition-colors\"\n                                    >\n                                        <X size={14} />\n                                        Limpiar Filtro\n                                    </button>\n                                </div>\n                            )}\n                        </div>\n                    </>\n                )}\n            </div>\n\n            {/* Filter Builder Modal */}\n            {isBuilderOpen && (\n                <FilterBuilder\n                    projectId={projectId}\n                    availableUsers={availableUsers}\n                    availableColumns={availableColumns}\n                    onClose={() => setIsBuilderOpen(false)}\n                    onSave={handleSaveFilter}\n                />\n            )}\n        </>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3582, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,6LAAC;QACC,MAAM;QACN,WAAW,IAAA,4HAAE,EACX,kYACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 3617, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/select.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Trigger>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n    <SelectPrimitive.Trigger\n        ref={ref}\n        className={cn(\n            \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n            className\n        )}\n        {...props}\n    >\n        {children}\n        <SelectPrimitive.Icon asChild>\n            <ChevronDown className=\"h-4 w-4 opacity-50\" />\n        </SelectPrimitive.Icon>\n    </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n    <SelectPrimitive.ScrollUpButton\n        ref={ref}\n        className={cn(\n            \"flex cursor-default items-center justify-center py-1\",\n            className\n        )}\n        {...props}\n    >\n        <ChevronUp className=\"h-4 w-4\" />\n    </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n    <SelectPrimitive.ScrollDownButton\n        ref={ref}\n        className={cn(\n            \"flex cursor-default items-center justify-center py-1\",\n            className\n        )}\n        {...props}\n    >\n        <ChevronDown className=\"h-4 w-4\" />\n    </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n    SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Content>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n    <SelectPrimitive.Portal>\n        <SelectPrimitive.Content\n            ref={ref}\n            className={cn(\n                \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n                position === \"popper\" &&\n                \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n                className\n            )}\n            position={position}\n            {...props}\n        >\n            <SelectScrollUpButton />\n            <SelectPrimitive.Viewport\n                className={cn(\n                    \"p-1\",\n                    position === \"popper\" &&\n                    \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n                )}\n            >\n                {children}\n            </SelectPrimitive.Viewport>\n            <SelectScrollDownButton />\n        </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Label>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n    <SelectPrimitive.Label\n        ref={ref}\n        className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n        {...props}\n    />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Item>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n    <SelectPrimitive.Item\n        ref={ref}\n        className={cn(\n            \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n            className\n        )}\n        {...props}\n    >\n        <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n            <SelectPrimitive.ItemIndicator>\n                <Check className=\"h-4 w-4\" />\n            </SelectPrimitive.ItemIndicator>\n        </span>\n\n        <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n    </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Separator>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n    <SelectPrimitive.Separator\n        ref={ref}\n        className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n        {...props}\n    />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n    Select,\n    SelectGroup,\n    SelectValue,\n    SelectTrigger,\n    SelectContent,\n    SelectLabel,\n    SelectItem,\n    SelectSeparator,\n    SelectScrollUpButton,\n    SelectScrollDownButton,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAEA;;;;;;AAEA;AAAA;AAAA;AAEA;AANA;;;;;;AAQA,MAAM,SAAS,gBAAgB,IAAI;AAEnC,MAAM,cAAc,gBAAgB,KAAK;AAEzC,MAAM,cAAc,gBAAgB,KAAK;AAEzC,MAAM,8BAAgB,2KAAgB,MAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBAClC,6LAAC,gBAAgB,OAAO;QACpB,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,mTACA;QAEH,GAAG,KAAK;;YAER;0BACD,6LAAC,gBAAgB,IAAI;gBAAC,OAAO;0BACzB,cAAA,6LAAC,sOAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;;AAInC,cAAc,WAAW,GAAG,gBAAgB,OAAO,CAAC,WAAW;AAE/D,MAAM,qCAAuB,2KAAgB,CAG3C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC,gBAAgB,cAAc;QAC3B,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,wDACA;QAEH,GAAG,KAAK;kBAET,cAAA,6LAAC,gOAAS;YAAC,WAAU;;;;;;;;;;;MAZvB;AAeN,qBAAqB,WAAW,GAAG,gBAAgB,cAAc,CAAC,WAAW;AAE7E,MAAM,uCAAyB,2KAAgB,CAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC,gBAAgB,gBAAgB;QAC7B,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,wDACA;QAEH,GAAG,KAAK;kBAET,cAAA,6LAAC,sOAAW;YAAC,WAAU;;;;;;;;;;;MAZzB;AAeN,uBAAuB,WAAW,GAC9B,gBAAgB,gBAAgB,CAAC,WAAW;AAEhD,MAAM,8BAAgB,2KAAgB,OAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACvD,6LAAC,gBAAgB,MAAM;kBACnB,cAAA,6LAAC,gBAAgB,OAAO;YACpB,KAAK;YACL,WAAW,IAAA,4HAAE,EACT,ucACA,aAAa,YACb,mIACA;YAEJ,UAAU;YACT,GAAG,KAAK;;8BAET,6LAAC;;;;;8BACD,6LAAC,gBAAgB,QAAQ;oBACrB,WAAW,IAAA,4HAAE,EACT,OACA,aAAa,YACb;8BAGH;;;;;;8BAEL,6LAAC;;;;;;;;;;;;;;;;;AAIb,cAAc,WAAW,GAAG,gBAAgB,OAAO,CAAC,WAAW;AAE/D,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC,gBAAgB,KAAK;QAClB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,0CAA0C;QACvD,GAAG,KAAK;;;;;;;AAGjB,YAAY,WAAW,GAAG,gBAAgB,KAAK,CAAC,WAAW;AAE3D,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBAClC,6LAAC,gBAAgB,IAAI;QACjB,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,6NACA;QAEH,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACZ,cAAA,6LAAC,gBAAgB,aAAa;8BAC1B,cAAA,6LAAC,gNAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAIzB,6LAAC,gBAAgB,QAAQ;0BAAE;;;;;;;;;;;;;AAGnC,WAAW,WAAW,GAAG,gBAAgB,IAAI,CAAC,WAAW;AAEzD,MAAM,gCAAkB,2KAAgB,QAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC,gBAAgB,SAAS;QACtB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;;;;;;AAGjB,gBAAgB,WAAW,GAAG,gBAAgB,SAAS,CAAC,WAAW"}},
    {"offset": {"line": 3844, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/project/ProjectSettings.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n    Select,\n    SelectContent,\n    SelectItem,\n    SelectTrigger,\n    SelectValue,\n} from \"@/components/ui/select\";\nimport {\n    Table,\n    TableBody,\n    TableCell,\n    TableHead,\n    TableHeader,\n    TableRow,\n} from \"@/components/ui/table\";\nimport { usePermissions } from \"@/hooks/usePermissions\";\nimport { PERMISSIONS, ROLES } from \"@/lib/permissions\";\nimport { Trash2, UserPlus, Shield } from \"lucide-react\";\n\ninterface ProjectSettingsProps {\n    projectId: string;\n}\n\ninterface ProjectUser {\n    user: {\n        id: string;\n        name: string | null;\n        email: string | null;\n        image: string | null;\n    };\n    role: string;\n    source: 'project' | 'workspace' | 'owner';\n}\n\nexport function ProjectSettings({ projectId }: ProjectSettingsProps) {\n    const { data: session } = useSession();\n    const { can } = usePermissions(projectId);\n    const [users, setUsers] = useState<ProjectUser[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [inviteEmail, setInviteEmail] = useState(\"\");\n    const [inviteRole, setInviteRole] = useState<string>(ROLES.ARTIST);\n    const [isInviting, setIsInviting] = useState(false);\n\n    useEffect(() => {\n        fetchUsers();\n    }, [projectId]);\n\n    const fetchUsers = async () => {\n        try {\n            const res = await fetch(`/api/projects/${projectId}/users`);\n            if (res.ok) {\n                const data = await res.json();\n                setUsers(data);\n            }\n        } catch (error) {\n            console.error(\"Error fetching users:\", error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleInviteUser = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!inviteEmail) return;\n\n        setIsInviting(true);\n        try {\n            const res = await fetch(`/api/projects/${projectId}/users`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ email: inviteEmail, role: inviteRole }),\n            });\n\n            if (res.ok) {\n                setInviteEmail(\"\");\n                fetchUsers();\n            } else {\n                const error = await res.json();\n                alert(error.message || \"Failed to add user\");\n            }\n        } catch (error) {\n            console.error(\"Error adding user:\", error);\n        } finally {\n            setIsInviting(false);\n        }\n    };\n\n    const handleRoleChange = async (userId: string, newRole: string) => {\n        try {\n            const res = await fetch(`/api/projects/${projectId}/users/${userId}`, {\n                method: \"PUT\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ role: newRole }),\n            });\n\n            if (res.ok) {\n                fetchUsers();\n            } else {\n                alert(\"Failed to update role\");\n            }\n        } catch (error) {\n            console.error(\"Error updating role:\", error);\n        }\n    };\n\n    const handleRemoveUser = async (userId: string) => {\n        if (!confirm(\"Are you sure you want to remove this user from the project?\")) return;\n\n        try {\n            const res = await fetch(`/api/projects/${projectId}/users/${userId}`, {\n                method: \"DELETE\",\n            });\n\n            if (res.ok) {\n                fetchUsers();\n            } else {\n                const error = await res.json();\n                alert(error.message || \"Failed to remove user\");\n            }\n        } catch (error) {\n            console.error(\"Error removing user:\", error);\n        }\n    };\n\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) {\n        return <div className=\"p-4\">You do not have permission to view project settings.</div>;\n    }\n\n    if (loading) return <div>Loading users...</div>;\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n                <h2 className=\"text-xl font-bold flex items-center gap-2\">\n                    <Shield className=\"w-5 h-5\" /> Project Access & Roles\n                </h2>\n            </div>\n\n            {/* Invite User Form */}\n            <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200\">\n                <h3 className=\"text-sm font-medium mb-3 text-slate-700\">Add User to Project</h3>\n                <form onSubmit={handleInviteUser} className=\"flex gap-3 items-end\">\n                    <div className=\"flex-1 space-y-1\">\n                        <label className=\"text-xs text-slate-500\">Email Address</label>\n                        <Input\n                            type=\"email\"\n                            placeholder=\"user@example.com\"\n                            value={inviteEmail}\n                            onChange={(e) => setInviteEmail(e.target.value)}\n                            required\n                        />\n                    </div>\n                    <div className=\"w-40 space-y-1\">\n                        <label className=\"text-xs text-slate-500\">Role</label>\n                        <Select value={inviteRole} onValueChange={setInviteRole}>\n                            <SelectTrigger>\n                                <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                                <SelectItem value={ROLES.PROJECT_MANAGER}>Project Manager</SelectItem>\n                                <SelectItem value={ROLES.ARTIST}>Artist</SelectItem>\n                                <SelectItem value={ROLES.VIEWER}>Viewer</SelectItem>\n                            </SelectContent>\n                        </Select>\n                    </div>\n                    <Button type=\"submit\" disabled={isInviting}>\n                        {isInviting ? \"Adding...\" : <><UserPlus className=\"w-4 h-4 mr-2\" /> Add User</>}\n                    </Button>\n                </form>\n            </div>\n\n            {/* Users Table */}\n            <div className=\"border rounded-lg overflow-hidden\">\n                <Table>\n                    <TableHeader>\n                        <TableRow>\n                            <TableHead>User</TableHead>\n                            <TableHead>Email</TableHead>\n                            <TableHead>Access Source</TableHead>\n                            <TableHead>Role</TableHead>\n                            <TableHead className=\"text-right\">Actions</TableHead>\n                        </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                        {users.map((u) => (\n                            <TableRow key={u.user.id}>\n                                <TableCell className=\"font-medium\">\n                                    <div className=\"flex items-center gap-2\">\n                                        {u.user.image && (\n                                            <img src={u.user.image} alt=\"\" className=\"w-6 h-6 rounded-full\" />\n                                        )}\n                                        {u.user.name || \"Unknown\"}\n                                    </div>\n                                </TableCell>\n                                <TableCell>{u.user.email}</TableCell>\n                                <TableCell>\n                                    <span className={`text-xs px-2 py-1 rounded-full ${u.source === 'owner' ? 'bg-purple-100 text-purple-700' :\n                                            u.source === 'workspace' ? 'bg-blue-100 text-blue-700' :\n                                                'bg-green-100 text-green-700'\n                                        }`}>\n                                        {u.source === 'owner' ? 'Owner' :\n                                            u.source === 'workspace' ? 'Workspace' : 'Project'}\n                                    </span>\n                                </TableCell>\n                                <TableCell>\n                                    {u.source === 'owner' ? (\n                                        <span className=\"font-semibold text-slate-700\">Admin</span>\n                                    ) : (\n                                        <Select\n                                            value={u.role}\n                                            onValueChange={(val) => handleRoleChange(u.user.id, val)}\n                                            disabled={u.user.id === session?.user?.id} // Prevent changing own role\n                                        >\n                                            <SelectTrigger className=\"w-32 h-8\">\n                                                <SelectValue />\n                                            </SelectTrigger>\n                                            <SelectContent>\n                                                <SelectItem value={ROLES.ADMIN}>Admin</SelectItem>\n                                                <SelectItem value={ROLES.PROJECT_MANAGER}>Manager</SelectItem>\n                                                <SelectItem value={ROLES.ARTIST}>Artist</SelectItem>\n                                                <SelectItem value={ROLES.VIEWER}>Viewer</SelectItem>\n                                            </SelectContent>\n                                        </Select>\n                                    )}\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                    {u.source === 'project' && u.user.id !== session?.user?.id && (\n                                        <Button\n                                            variant=\"ghost\"\n                                            size=\"icon\"\n                                            className=\"text-red-500 hover:text-red-700 hover:bg-red-50\"\n                                            onClick={() => handleRemoveUser(u.user.id)}\n                                        >\n                                            <Trash2 className=\"w-4 h-4\" />\n                                        </Button>\n                                    )}\n                                </TableCell>\n                            </TableRow>\n                        ))}\n                    </TableBody>\n                </Table>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4406, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/KanbanBoard.tsx"],"sourcesContent":["\"use client\";\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport {\n  DndContext,\n  DragEndEvent,\n  DragOverlay,\n  DragStartEvent,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  Active,\n  closestCorners,\n} from \"@dnd-kit/core\";\nimport { arrayMove, SortableContext } from \"@dnd-kit/sortable\";\nimport { createPortal } from \"react-dom\";\nimport useSWR from \"swr\";\nimport { useSession } from \"next-auth/react\";\nimport { Column } from \"./Column\";\nimport { Task } from \"./Task\";\nimport { Button } from \"../ui/button\";\nimport { TaskDetailModal } from \"./TaskDetailModal\";\nimport { FilterBar, FilterType } from \"./FilterBar\";\nimport { FilterCriteria } from \"./FilterBuilder\";\nimport { usePermissions } from \"@/hooks/usePermissions\";\nimport { PERMISSIONS } from \"@/lib/permissions\";\nimport { ProjectSettings } from \"../project/ProjectSettings\";\nimport { Settings, X } from \"lucide-react\";\n\ninterface KanbanBoardProps {\n  projectId: string;\n}\n\ntype FetchedTask = {\n  id: string;\n  title: string;\n  description?: string;\n  order: number;\n  columnId: string;\n  projectId: string;\n  parentId?: string | null;\n  children?: FetchedTask[];\n  priority?: string | null;\n  tags?: string | null;\n  links?: string | null;\n  checklist?: string | null;\n  attachments?: string | null;\n  assignees?: { id: string; name: string | null; email: string | null; image: string | null }[];\n  endDate?: string | null;\n};\n\ntype FetchedColumn = {\n  id: string;\n  name: string;\n  order: number;\n  projectId: string;\n  tasks: FetchedTask[];\n};\n\nconst fetcher = (url: string) => fetch(url).then((res) => res.json());\n\nexport function KanbanBoard({ projectId }: KanbanBoardProps) {\n  const { data: session } = useSession();\n  const { can } = usePermissions(projectId);\n  const { data: fetchedColumns, error, mutate } = useSWR<FetchedColumn[]>(\n    `/api/projects/${projectId}/columns`,\n    fetcher\n  );\n\n  const [columns, setColumns] = useState<FetchedColumn[]>([]);\n  const [tasks, setTasks] = useState<FetchedTask[]>([]);\n  const [activeItem, setActiveItem] = useState<Active | null>(null);\n  const [selectedTaskId, setSelectedTaskId] = useState<string | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [activeFilter, setActiveFilter] = useState<FilterType | string>(\"all\");\n  const [customFilterCriteria, setCustomFilterCriteria] = useState<FilterCriteria | null>(null);\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n\n  const selectedTask = useMemo(() =>\n    tasks.find((task) => task.id === selectedTaskId) || null,\n    [tasks, selectedTaskId]\n  );\n\n  // Filter tasks based on active filter\n  const filteredTasks = useMemo(() => {\n    const currentUserId = session?.user?.id;\n\n    // Handle custom filters\n    if (customFilterCriteria && activeFilter !== \"all\" && activeFilter !== \"my-tasks\" &&\n      activeFilter !== \"unassigned\" && activeFilter !== \"overdue\" && activeFilter !== \"this-week\") {\n      return tasks.filter(task => {\n        const { conditions, operator } = customFilterCriteria;\n\n        const results = conditions.map(condition => {\n          switch (condition.field) {\n            case \"assignee\":\n              if (condition.operator === \"equals\") {\n                return task.assignees?.some(a => a.id === condition.value);\n              }\n              if (condition.operator === \"isEmpty\") {\n                return !task.assignees || task.assignees.length === 0;\n              }\n              if (condition.operator === \"isNotEmpty\") {\n                return task.assignees && task.assignees.length > 0;\n              }\n              return false;\n\n            case \"priority\":\n              if (condition.operator === \"equals\") {\n                return task.priority === condition.value;\n              }\n              return false;\n\n            case \"tags\":\n              if (condition.operator === \"contains\") {\n                const tags = task.tags ? JSON.parse(task.tags) : [];\n                return tags.some((tag: any) => tag.name === condition.value);\n              }\n              return false;\n\n            case \"column\":\n              if (condition.operator === \"equals\") {\n                return task.columnId === condition.value;\n              }\n              return false;\n\n            case \"dueDate\":\n              if (!task.endDate) return condition.operator === \"isEmpty\";\n              const dueDate = new Date(task.endDate);\n              const compareDate = new Date(condition.value as string);\n\n              if (condition.operator === \"before\") {\n                return dueDate < compareDate;\n              }\n              if (condition.operator === \"after\") {\n                return dueDate > compareDate;\n              }\n              if (condition.operator === \"isNotEmpty\") {\n                return !!task.endDate;\n              }\n              return false;\n\n            case \"hasAttachments\":\n              const hasAttachments = task.attachments && JSON.parse(task.attachments as any).length > 0;\n              return condition.value ? hasAttachments : !hasAttachments;\n\n            case \"checklistStatus\":\n              if (!task.checklist) return false;\n              const checklist = JSON.parse(task.checklist);\n              const allCompleted = checklist.every((item: any) => item.completed);\n              return condition.value ? allCompleted : !allCompleted;\n\n            default:\n              return false;\n          }\n        });\n\n        return operator === \"AND\" ? results.every(r => r) : results.some(r => r);\n      });\n    }\n\n    // Handle predefined filters\n    switch (activeFilter) {\n      case \"my-tasks\":\n        return tasks.filter(task =>\n          task.assignees?.some(assignee => assignee.id === currentUserId)\n        );\n\n      case \"unassigned\":\n        return tasks.filter(task =>\n          !task.assignees || task.assignees.length === 0\n        );\n\n      case \"overdue\":\n        return tasks.filter(task => {\n          if (!task.endDate) return false;\n          const dueDate = new Date(task.endDate);\n          return dueDate < new Date();\n        });\n\n      case \"this-week\":\n        return tasks.filter(task => {\n          if (!task.endDate) return false;\n          const dueDate = new Date(task.endDate);\n          const weekFromNow = new Date();\n          weekFromNow.setDate(weekFromNow.getDate() + 7);\n          return dueDate >= new Date() && dueDate <= weekFromNow;\n        });\n\n      case \"all\":\n      default:\n        return tasks;\n    }\n  }, [tasks, activeFilter, customFilterCriteria, session?.user?.id]);\n\n  React.useEffect(() => {\n    if (fetchedColumns && Array.isArray(fetchedColumns)) {\n      setColumns(fetchedColumns);\n      const allTasks = fetchedColumns.flatMap((col) =>\n        col.tasks.map((task) => ({ ...task, columnId: col.id }))\n      );\n      setTasks(allTasks);\n    }\n  }, [fetchedColumns]);\n\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 3,\n      },\n    })\n  );\n\n  const columnsId = useMemo(() => columns.map((col) => col.id), [columns]);\n\n  const findColumn = useCallback(\n    (id: string) => {\n      return columns.find((col) => col.id === id);\n    },\n    [columns]\n  );\n\n  const findTask = useCallback(\n    (id: string) => {\n      return tasks.find((task) => task.id === id);\n    },\n    [tasks]\n  );\n\n  const onDragStart = (event: DragStartEvent) => {\n    setActiveItem(event.active);\n  };\n\n  const onDragEnd = async (event: DragEndEvent) => {\n    const { active, over } = event;\n    setActiveItem(null);\n\n    if (!over) {\n      mutate(); // If dropped outside, re-mutate to revert\n      return;\n    }\n\n    const activeId = active.id.toString();\n    const overId = over.id.toString();\n\n    if (activeId === overId) return;\n\n    const isActiveATask = active.data.current?.type === \"Task\";\n    const isOverATask = over.data.current?.type === \"Task\";\n    const isActiveAColumn = active.data.current?.type === \"Column\";\n    const isOverAColumn = over.data.current?.type === \"Column\";\n\n    // Handle Column Reordering\n    if (isActiveAColumn && isOverAColumn) {\n      const activeColumnIndex = columns.findIndex((col) => col.id === activeId);\n      const overColumnIndex = columns.findIndex((col) => col.id === overId);\n\n      const newColumns = arrayMove(columns, activeColumnIndex, overColumnIndex);\n      setColumns(newColumns);\n\n      // Update order in backend\n      await Promise.all(\n        newColumns.map(async (col, index) => {\n          if (col.order !== index) {\n            await fetch(\n              `/api/projects/${projectId}/columns/${col.id}`,\n              {\n                method: \"PUT\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ order: index }),\n              }\n            );\n          }\n        })\n      );\n      mutate(); // Re-mutate to refetch and ensure state consistency\n      return;\n    }\n\n    // Handle Task Movement within or between Columns\n    if (isActiveATask) {\n      const activeTask = tasks.find((task) => task.id === activeId);\n      if (!activeTask) return;\n\n      let newColumnId = activeTask.columnId;\n      let newOrder = activeTask.order;\n\n      // Determine the destination column ID\n      if (isOverAColumn) {\n        newColumnId = overId;\n      } else if (isOverATask) {\n        const overTask = tasks.find((task) => task.id === overId);\n        if (overTask) {\n          newColumnId = overTask.columnId;\n        }\n      }\n\n      // Calculate new order for the task\n      const tasksInNewColumn = tasks.filter((t) => t.columnId === newColumnId && t.id !== activeId);\n      if (isOverATask) {\n        const overTaskIndex = tasksInNewColumn.findIndex(t => t.id === overId);\n        newOrder = overTaskIndex === -1 ? tasksInNewColumn.length : overTaskIndex;\n      } else { // Dropped over a column or at the end\n        newOrder = tasksInNewColumn.length;\n      }\n\n      // Optimistic update for tasks array\n      setTasks((prevTasks) => {\n        // Find the active task before modifying prevTasks\n        const activeTaskInPrev = prevTasks.find((task) => task.id === activeId);\n        if (!activeTaskInPrev) return prevTasks; // Should not happen if activeTask is valid\n\n        // Check if this task has children (is a parent task)\n        const hasChildren = activeTaskInPrev.children && activeTaskInPrev.children.length > 0;\n        const isColumnChanging = activeTaskInPrev.columnId !== newColumnId;\n\n        // Create the moved task with its new properties\n        const movedTask = { ...activeTaskInPrev, columnId: newColumnId, order: newOrder };\n\n        // Filter out the active task from its original position\n        let tasksWithoutActive = prevTasks.filter((t) => t.id !== activeId);\n\n        // If moving to a different column and has children, also move ALL descendants recursively\n        if (isColumnChanging && hasChildren) {\n          // Recursive function to get all descendant IDs\n          const getAllDescendantIds = (parentTaskId: string, allTasks: typeof prevTasks): string[] => {\n            const children = allTasks.filter(t => t.parentId === parentTaskId);\n            if (children.length === 0) return [];\n\n            const childIds = children.map(c => c.id);\n            const grandchildIds = childIds.flatMap(id => getAllDescendantIds(id, allTasks));\n\n            return [...childIds, ...grandchildIds];\n          };\n\n          const descendantIds = getAllDescendantIds(activeId, prevTasks);\n\n          // Update all descendants to the new column\n          tasksWithoutActive = tasksWithoutActive.map((t) => {\n            if (descendantIds.includes(t.id)) {\n              return { ...t, columnId: newColumnId };\n            }\n            return t;\n          });\n        }\n\n        if (activeTaskInPrev.columnId === newColumnId) {\n          // Moving within the same column\n          const columnTasks = tasksWithoutActive\n            .filter(t => t.columnId === newColumnId)\n            .concat(movedTask)\n            .sort((a, b) => a.order - b.order)\n            .map((t, index) => ({ ...t, order: index }));\n\n          const otherTasks = prevTasks.filter(t => t.columnId !== newColumnId);\n          return [...otherTasks, ...columnTasks];\n        } else {\n          // Moving between different columns\n          const tasksInSourceColumn = tasksWithoutActive\n            .filter(t => t.columnId === activeTaskInPrev.columnId)\n            .sort((a, b) => a.order - b.order) // Ensure stable sort for re-indexing\n            .map((t, index) => ({ ...t, order: index }));\n\n          const tasksInDestinationColumn = tasksWithoutActive\n            .filter(t => t.columnId === newColumnId)\n            .concat(movedTask) // Add the moved task to the destination column's tasks\n            .sort((a, b) => a.order - b.order) // Ensure stable sort for re-indexing\n            .map((t, index) => ({ ...t, order: index }));\n\n          // Tasks that were not in the source or destination column\n          const otherTasksUnmodified = prevTasks.filter(\n            t => t.columnId !== activeTaskInPrev.columnId && t.columnId !== newColumnId\n          );\n\n          // Combine all tasks back into a single array\n          return [...otherTasksUnmodified, ...tasksInSourceColumn, ...tasksInDestinationColumn];\n        }\n      });\n\n      // Update backend\n      await fetch(`/api/projects/${projectId}/tasks/${activeId}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ columnId: newColumnId, order: newOrder }),\n      });\n      mutate(); // Re-mutate to refetch and ensure state consistency\n      return;\n    }\n    mutate(); // If nothing moved or dropped outside, re-mutate to ensure consistency\n  };\n\n  // Function to add a new column\n  const handleAddColumn = async () => {\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) return;\n    const newColumnName = prompt(\"Enter new column name:\");\n    if (newColumnName) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ name: newColumnName }),\n        });\n        if (response.ok) {\n          mutate(); // Re-fetch data to include the new column\n        } else {\n          console.error(\"Failed to add column\");\n        }\n      } catch (error) {\n        console.error(\"Error adding column:\", error);\n      }\n    }\n  };\n\n  // Function to create a new task within a column\n  const handleCreateTask = async (columnId: string) => {\n    if (!can(PERMISSIONS.CREATE_TASK)) return;\n    const newTaskTitle = prompt(\"Enter new task title:\");\n    if (newTaskTitle) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/tasks`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ title: newTaskTitle, columnId }),\n        });\n        if (response.ok) {\n          mutate(); // Re-fetch data to include the new task\n        } else {\n          console.error(\"Failed to add task\");\n        }\n      } catch (error) {\n        console.error(\"Error adding task:\", error);\n      }\n    }\n  };\n\n  const handleEditColumnName = async (columnId: string, currentName: string) => {\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) return;\n    const newName = prompt(\"Edit column name:\", currentName);\n    if (newName && newName !== currentName) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns/${columnId}`, {\n          method: \"PUT\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ name: newName }),\n        });\n        if (response.ok) {\n          mutate();\n        } else {\n          console.error(\"Failed to edit column name\");\n        }\n      } catch (error) {\n        console.error(\"Error editing column name:\", error);\n      }\n    }\n  };\n\n  const handleDeleteColumn = async (columnId: string) => {\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) return;\n    if (confirm(\"Are you sure you want to delete this column and all its tasks?\")) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns/${columnId}`, {\n          method: \"DELETE\",\n        });\n        if (response.ok) {\n          mutate();\n        } else {\n          console.error(\"Failed to delete column\");\n        }\n      } catch (error) {\n        console.error(\"Error deleting column:\", error);\n      }\n    }\n  };\n\n  const handleTaskClick = (taskId: string) => {\n    console.log(\"Task clicked:\", taskId); // Debugging\n    setSelectedTaskId(taskId);\n    setIsModalOpen(true);\n    console.log(\"isModalOpen set to true\"); // Debugging\n  };\n\n  const handleCloseModal = () => {\n    setIsModalOpen(false);\n    setSelectedTaskId(null);\n    console.log(\"Modal closed\"); // Debugging\n  };\n\n  if (error) return <div>Failed to load kanban board.</div>;\n  if (!fetchedColumns) return <div>Loading...</div>; // Use fetchedColumns for initial loading check\n\n  const activeTaskContent = activeItem?.data.current?.type === \"Task\"\n    ? tasks.find(t => t.id === activeItem.id)\n    : null;\n\n  return (\n    <div>\n      <div className=\"flex flex-col h-screen\">\n        {/* Filter Bar */}\n        <div className=\"p-4 bg-white border-b border-gray-200\">\n          <FilterBar\n            projectId={projectId}\n            currentUserId={session?.user?.id || \"\"}\n            activeFilter={activeFilter}\n            onFilterChange={(filter, criteria) => {\n              setActiveFilter(filter);\n              setCustomFilterCriteria(criteria || null);\n            }}\n            availableUsers={tasks\n              .flatMap(t => t.assignees || [])\n              .filter((user, index, self) =>\n                self.findIndex(u => u.id === user.id) === index\n              )}\n            availableColumns={columns.map(col => ({ id: col.id, name: col.name }))}\n          />\n        </div>\n\n        {/* Kanban Board */}\n        <div className=\"flex-1 overflow-hidden\">\n          <div className=\"header\">\n            <div className=\"header-title\">{\"< Project\"}</div>\n            <div className=\"flex gap-2\">\n              {can(PERMISSIONS.MANAGE_PROJECT) && (\n                <>\n                  <Button onClick={() => setIsSettingsOpen(true)} variant=\"outline\" size=\"sm\">\n                    <Settings className=\"w-4 h-4 mr-2\" />\n                    Settings\n                  </Button>\n                  <Button onClick={handleAddColumn} className=\"btn-primary\">Add Column</Button>\n                </>\n              )}\n            </div>\n          </div>\n\n          <DndContext\n            sensors={sensors}\n            collisionDetection={closestCorners}\n            onDragStart={onDragStart}\n            onDragEnd={onDragEnd}\n          >\n            <div className=\"h-full overflow-x-auto overflow-y-hidden px-8 pt-8 pb-10 bg-neutral-50\">\n              <SortableContext items={columnsId}>\n                <div className=\"flex gap-4 h-full min-h-screen\">\n                  {columns.map((col) => {\n                    // Filter tasks for this column\n                    const columnTasks = filteredTasks.filter(task => task.columnId === col.id).sort((a, b) => a.order - b.order);\n\n                    return (\n                      <Column\n                        key={col.id}\n                        id={col.id}\n                        title={col.name}\n                        tasks={columnTasks}\n                        onEditName={handleEditColumnName}\n                        onDelete={handleDeleteColumn}\n                        onCreateTask={handleCreateTask}\n                        onTaskClick={handleTaskClick}\n                      />\n                    );\n                  })}\n                </div>\n              </SortableContext>\n            </div>\n            {createPortal(\n              <DragOverlay>\n                {activeItem && activeItem.data.current?.type === \"Task\" && activeTaskContent ? (\n                  <Task\n                    id={activeTaskContent.id}\n                    title={activeTaskContent.title} // Pass title here\n                    isActive={false}\n                    className=\"dragging\"\n                    subtasksCount={activeTaskContent.children?.length || 0}\n                    parentId={activeTaskContent.parentId}\n                  />\n                ) : null}\n                {activeItem && activeItem.data.current?.type === \"Column\" ? (\n                  <div className=\"column dragging\">\n                    <h2 className=\"column-title\">{findColumn(activeItem.id.toString())?.name}</h2>\n                    {/* Optionally render tasks in the dragged column */}\n                  </div>\n                ) : null}\n              </DragOverlay>,\n              document.body\n            )}\n          </DndContext>\n        </div>\n      </div>\n      {/* Project Settings Modal */}\n      {isSettingsOpen && createPortal(\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto relative\">\n            <button\n              onClick={() => setIsSettingsOpen(false)}\n              className=\"absolute top-4 right-4 text-gray-500 hover:text-gray-700\"\n            >\n              <X size={24} />\n            </button>\n            <div className=\"p-6\">\n              <ProjectSettings projectId={projectId} />\n            </div>\n          </div>\n        </div>,\n        document.body\n      )}\n\n      {selectedTask && isModalOpen && (\n        <TaskDetailModal\n          key={selectedTask.id}\n          task={selectedTask}\n          onClose={handleCloseModal}\n          onTaskUpdate={mutate}\n          availableUsers={tasks\n            .flatMap(t => t.assignees || [])\n            .filter((user, index, self) =>\n              self.findIndex(u => u.id === user.id) === index\n            )}\n        />\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}