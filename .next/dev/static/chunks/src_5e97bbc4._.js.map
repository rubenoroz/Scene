{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/Task.tsx"],"sourcesContent":["\nimport { useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\nimport { CheckSquare, Link2, AlertCircle } from \"lucide-react\";\n\nconst PASTEL_COLORS = [\n  \"#E0F7FA\", // Cyan\n  \"#F1F8E9\", // Light Green\n  \"#FFF8E1\", // Amber\n  \"#F3E5F5\", // Purple\n  \"#E3F2FD\", // Blue\n  \"#FBE9E7\", // Deep Orange\n  \"#FFF3E0\", // Orange\n  \"#E8F5E9\", // Green\n  \"#FCE4EC\", // Pink\n  \"#E1F5FE\", // Light Blue\n];\n\nconst PRIORITY_COLORS = {\n  LOW: \"#D1FAE5\",\n  MEDIUM: \"#FEF3C7\",\n  HIGH: \"#FED7AA\",\n  URGENT: \"#FECACA\",\n};\n\nconst PRIORITY_LABELS = {\n  LOW: \"Baja\",\n  MEDIUM: \"Media\",\n  HIGH: \"Alta\",\n  URGENT: \"Urgente\",\n};\n\nfunction getTaskColor(id: string): string {\n  let hash = 0;\n  for (let i = 0; i < id.length; i++) {\n    hash = id.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  const index = Math.abs(hash) % PASTEL_COLORS.length;\n  return PASTEL_COLORS[index];\n}\n\nexport function Task({\n  id,\n  title,\n  isActive,\n  className,\n  onClick,\n  subtasksCount = 0,\n  isSubtask = false,\n  parentId,\n  level = 0,\n  priority,\n  assignees = [],\n  links = [],\n  checklist = [],\n}: {\n  id: string;\n  title: string;\n  isActive: boolean;\n  className?: string;\n  onClick?: (taskId: string) => void;\n  subtasksCount?: number;\n  isSubtask?: boolean;\n  parentId?: string | null;\n  level?: number;\n  priority?: string;\n  assignees?: { id: string; name: string | null; email: string | null; image: string | null }[];\n  links?: { title: string; url: string }[];\n  checklist?: { id: string; text: string; completed: boolean }[];\n}) {\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({\n    id,\n    data: {\n      type: \"Task\",\n    },\n  });\n\n  const colorSeed = parentId || id;\n  const backgroundColor = getTaskColor(colorSeed);\n\n  const style = {\n    transition,\n    transform: CSS.Transform.toString(transform),\n    marginLeft: level > 0 ? `${level * 20}px` : '0',\n    backgroundColor: isActive ? undefined : backgroundColor,\n  };\n\n  const completedChecklistItems = checklist.filter(item => item.completed).length;\n  const totalChecklistItems = checklist.length;\n\n  return (\n    <div\n      ref={setNodeRef}\n      style={style}\n      {...attributes}\n      {...listeners}\n      onClick={onClick ? () => onClick(id) : undefined}\n      className={`card ${isActive ? \"active\" : \"\"} ${isDragging ? \"dragging\" : \"\"} ${className || \"\"} `}\n    >\n      {/* Priority Badge */}\n      {priority && priority !== \"MEDIUM\" && (\n        <div\n          className=\"inline-block px-2 py-0.5 rounded text-xs font-medium mb-2\"\n          style={{\n            backgroundColor: PRIORITY_COLORS[priority as keyof typeof PRIORITY_COLORS],\n            color: '#1E293B'\n          }}\n        >\n          {PRIORITY_LABELS[priority as keyof typeof PRIORITY_LABELS]}\n        </div>\n      )}\n\n      <h3\n        style={{ color: 'black !important' }}\n        className=\"truncate overflow-hidden text-ellipsis\"\n        title={title}\n      >\n        {title}\n      </h3>\n\n      {/* Metadata Row */}\n      <div className=\"flex items-center gap-2 mt-2 flex-wrap\">\n        {/* Subtasks Count */}\n        {subtasksCount > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <CheckSquare size={14} />\n            <span>{subtasksCount}</span>\n          </div>\n        )}\n\n        {/* Checklist Progress */}\n        {totalChecklistItems > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <CheckSquare size={14} />\n            <span>{completedChecklistItems}/{totalChecklistItems}</span>\n          </div>\n        )}\n\n        {/* Links Indicator */}\n        {links.length > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <Link2 size={14} />\n            <span>{links.length}</span>\n          </div>\n        )}\n\n        {/* Assignee Avatars */}\n        {assignees.length > 0 && (\n          <div className=\"flex -space-x-2 ml-auto\">\n            {assignees.slice(0, 3).map((assignee) => (\n              assignee.image ? (\n                <img\n                  key={assignee.id}\n                  src={assignee.image}\n                  alt={assignee.name || assignee.email || \"User\"}\n                  className=\"w-6 h-6 rounded-full border-2 border-white\"\n                  title={assignee.name || assignee.email || \"\"}\n                />\n              ) : (\n                <div\n                  key={assignee.id}\n                  className=\"w-6 h-6 rounded-full bg-blue-200 border-2 border-white flex items-center justify-center text-xs font-medium text-neutral-900\"\n                  title={assignee.name || assignee.email || \"\"}\n                >\n                  {(assignee.name || assignee.email || \"?\")[0].toUpperCase()}\n                </div>\n              )\n            ))}\n            {assignees.length > 3 && (\n              <div className=\"w-6 h-6 rounded-full bg-gray-300 border-2 border-white flex items-center justify-center text-xs font-medium text-gray-700\">\n                +{assignees.length - 3}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/Column.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useDroppable } from \"@dnd-kit/core\";\nimport { SortableContext, useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\nimport { Task } from \"./Task\";\nimport { Plus, X, GripVertical } from \"lucide-react\";\n\ninterface ColumnProps {\n  id: string;\n  title: string;\n  tasks: any[]; // Consider defining a more specific type for tasks if possible\n  onEditName: (columnId: string, newName: string) => void;\n  onDelete: (columnId: string) => void;\n  onCreateTask: (columnId: string) => void;\n  onTaskClick: (taskId: string) => void;\n}\n\nexport function Column({ id, title, tasks, onEditName, onDelete, onCreateTask, onTaskClick }: ColumnProps) {\n  const { setNodeRef: setDroppableNodeRef } = useDroppable({\n    id,\n    data: {\n      type: \"Column\",\n    },\n  });\n\n  const {\n    setNodeRef: setSortableNodeRef,\n    attributes,\n    listeners,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({ id: id, data: { type: \"Column\" } });\n\n  const style = {\n    transition,\n    transform: CSS.Transform.toString(transform),\n  };\n\n  const [isEditingTitle, setIsEditingTitle] = useState(false);\n  const [newTitle, setNewTitle] = useState(title);\n\n  const handleTitleDoubleClick = () => {\n    setIsEditingTitle(true);\n  };\n\n  const handleTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setNewTitle(e.target.value);\n  };\n\n  const handleTitleBlur = () => {\n    if (newTitle.trim() !== title) {\n      onEditName(id, newTitle.trim());\n    }\n    setIsEditingTitle(false);\n  };\n\n  const handleTitleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === \"Enter\") {\n      handleTitleBlur();\n    }\n    if (e.key === \"Escape\") {\n      setNewTitle(title);\n      setIsEditingTitle(false);\n    }\n  };\n\n  const handleAddTask = () => {\n    onCreateTask(id); // Call the prop with the column's ID\n  };\n\n  return (\n    <section\n      ref={(node) => {\n        setDroppableNodeRef(node);\n        setSortableNodeRef(node);\n      }}\n      style={style}\n      {...attributes}\n      className={`column flex-shrink-0 ${isDragging ? \"dragging\" : \"\"}`}\n    >\n      <div className=\"flex justify-between items-center mb-1\">\n        {isEditingTitle ? (\n          <input\n            type=\"text\"\n            value={newTitle}\n            onChange={handleTitleChange}\n            onBlur={handleTitleBlur}\n            onKeyDown={handleTitleKeyDown}\n            className=\"column-title-edit\" // Add specific styling for editing input\n            autoFocus\n          />\n        ) : (\n          <h2 className=\"column-title\" onDoubleClick={handleTitleDoubleClick}>\n            {title}\n          </h2>\n        )}\n        <div className=\"flex gap-2\">\n          {/* Add Task Button */}\n          <button onClick={handleAddTask} className=\"rounded-full w-8 h-8 flex items-center justify-center bg-[#2563EB] hover:bg-[#3B82F6]\" style={{ borderWidth: '1px', borderColor: 'white', borderStyle: 'solid' }}>\n            <Plus size={16} stroke=\"white\" fill=\"white\" />\n          </button>\n          {/* Delete Column Button */}\n          <button onClick={() => onDelete(id)} className=\"rounded-full w-8 h-8 flex items-center justify-center bg-[#EF4444] hover:bg-[#DC2626]\" style={{ borderWidth: '1px', borderColor: 'white', borderStyle: 'solid' }}>\n            <X size={16} stroke=\"white\" fill=\"white\" />\n          </button>\n          {/* Draggable handle for column */}\n          <button {...listeners} className=\"rounded-full w-8 h-8 flex items-center justify-center bg-[#FACC15] hover:bg-[#EAB308] cursor-grab\" style={{ borderWidth: '1px', borderColor: 'white', borderStyle: 'solid' }}>\n            <GripVertical size={16} stroke=\"white\" fill=\"white\" />\n          </button>\n        </div>\n      </div>\n      <div className=\"flex flex-col gap-[12px]\">\n        <SortableContext items={tasks.map((t) => t.id)}>\n          {tasks.map((task) => {\n            // Calculate the depth level of this task\n            const calculateLevel = (t: typeof task, allTasks: typeof tasks): number => {\n              if (!t.parentId) return 0;\n              const parent = allTasks.find(p => p.id === t.parentId);\n              if (!parent) return 0;\n              return 1 + calculateLevel(parent, allTasks);\n            };\n\n            const level = calculateLevel(task, tasks);\n\n            return (\n              <Task\n                key={task.id}\n                id={task.id}\n                title={task.title}\n                isActive={task.isActive}\n                onClick={onTaskClick}\n                subtasksCount={task.children?.length || 0}\n                isSubtask={!!task.parentId}\n                parentId={task.parentId}\n                level={level}\n                priority={task.priority || undefined}\n                assignees={task.assignees || []}\n                links={task.links ? JSON.parse(task.links) : []}\n                checklist={task.checklist ? JSON.parse(task.checklist) : []}\n              />\n            );\n          })}\n        </SortableContext>\n      </div>\n    </section>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 486, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 504, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n        shiny:\n          \"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground shadow-md hover:shadow-lg transition-shadow\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-lg px-3\",\n        lg: \"h-11 rounded-lg px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,uRACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;YACN,OACE;QACJ;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,2KAAgB,MAC7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAC9B,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 572, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/TaskDetailModal.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { X, File, Download, Trash2 } from \"lucide-react\";\nimport { createPortal } from \"react-dom\";\nimport { useRouter } from \"next/navigation\";\nimport { FileUploader } from \"./FileUploader\";\n\n// Recursive type for subtasks\ntype Subtask = {\n  id: string;\n  title: string;\n  description?: string;\n  children?: Subtask[];\n};\n\ninterface TaskDetailModalProps {\n  task: {\n    id: string;\n    title: string;\n    description?: string;\n    projectId: string;\n    columnId: string;\n    parentId?: string | null;\n    children?: Subtask[];\n    startDate?: string | null;\n    endDate?: string | null;\n    toleranceDate?: string | null;\n    priority?: string | null;\n    tags?: string | null;\n    links?: string | null;\n    checklist?: string | null;\n    attachments?: string | null;\n    images?: string | null;\n    assignees?: { id: string; name: string | null; email: string | null; image: string | null }[];\n  } | null;\n  onClose: () => void;\n  onTaskUpdate: () => void;\n}\n\nexport function TaskDetailModal({ task, onClose, onTaskUpdate }: TaskDetailModalProps) {\n  const [mounted, setMounted] = useState(false);\n  const modalRef = useRef<HTMLDivElement>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const [subtaskTitle, setSubtaskTitle] = useState(\"\");\n  const [isAddingSubtask, setIsAddingSubtask] = useState(false);\n  const router = useRouter();\n\n  // Rich fields state\n  const [priority, setPriority] = useState<string>(task?.priority || \"MEDIUM\");\n  const [tags, setTags] = useState<{ name: string, color: string }[]>(\n    task?.tags ? JSON.parse(task.tags) : []\n  );\n  const [links, setLinks] = useState<{ title: string, url: string }[]>(\n    task?.links ? JSON.parse(task.links) : []\n  );\n  const [checklist, setChecklist] = useState<{ id: string, text: string, completed: boolean }[]>(\n    task?.checklist ? JSON.parse(task.checklist) : []\n  );\n  const [attachments, setAttachments] = useState<{ url: string, name: string, size: number, type: string, uploadedAt: string }[]>(\n    task?.attachments ? JSON.parse(task.attachments) : []\n  );\n  const [newTagName, setNewTagName] = useState(\"\");\n  const [newLinkTitle, setNewLinkTitle] = useState(\"\");\n  const [newLinkUrl, setNewLinkUrl] = useState(\"\");\n  const [newChecklistItem, setNewChecklistItem] = useState(\"\");\n\n  // User assignment state\n  const [availableUsers, setAvailableUsers] = useState<{ id: string; name: string | null; email: string | null; image: string | null }[]>([]);\n  const [selectedAssignees, setSelectedAssignees] = useState<string[]>(\n    task?.assignees?.map(a => a.id) || []\n  );\n\n  // Sync selectedAssignees when task.assignees changes\n  useEffect(() => {\n    if (task?.assignees) {\n      setSelectedAssignees(task.assignees.map(a => a.id));\n    }\n  }, [task?.assignees]);\n\n  useEffect(() => {\n    setMounted(true);\n    // Set initial centered position\n    if (typeof window !== 'undefined') {\n      setPosition({\n        x: (window.innerWidth - 560) / 2,\n        y: (window.innerHeight - 600) / 2  // Center vertically (assuming ~600px modal height)\n      });\n    }\n    return () => setMounted(false);\n  }, []);\n\n  // The handleMouseDown, handleMouseMove, handleMouseUp, and their useEffect\n  // have been updated to reflect the new dragging logic using dragStart\n  const handleMouseDown = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    setIsDragging(true);\n\n    // Calculate offset based on current state position\n    setDragStart({\n      x: e.clientX - position.x,\n      y: e.clientY - position.y\n    });\n  }, [position]);\n\n  const handleMouseMove = useCallback((e: MouseEvent) => {\n    if (isDragging) {\n      setPosition({\n        x: e.clientX - dragStart.x,\n        y: e.clientY - dragStart.y,\n      });\n    }\n  }, [isDragging, dragStart]);\n\n  const handleMouseUp = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  useEffect(() => {\n    if (isDragging) {\n      window.addEventListener('mousemove', handleMouseMove);\n      window.addEventListener('mouseup', handleMouseUp);\n    } else {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('mouseup', handleMouseUp);\n    }\n    return () => {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isDragging, handleMouseMove, handleMouseUp]);\n\n  // Fetch available users for assignment\n  useEffect(() => {\n    if (task?.projectId) {\n      fetch(`/api/projects/${task.projectId}/users`)\n        .then(res => res.json())\n        .then(users => setAvailableUsers(users))\n        .catch(err => console.error(\"Error fetching users:\", err));\n    }\n  }, [task?.projectId]);\n\n  const handleAddSubtask = async () => {\n    if (!subtaskTitle.trim() || !task) return;\n\n    setIsAddingSubtask(true);\n    try {\n      const response = await fetch(`/api/projects/${task.projectId}/tasks`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          title: subtaskTitle,\n          columnId: task.columnId,\n          parentId: task.id,\n        }),\n      });\n\n      if (response.ok) {\n        setSubtaskTitle(\"\");\n        onTaskUpdate(); // Refresh data via parent callback\n      } else {\n        console.error(\"Failed to create subtask\");\n      }\n    } catch (error) {\n      console.error(\"Error creating subtask:\", error);\n    } finally {\n      setIsAddingSubtask(false);\n    }\n  };\n\n  if (!task || !mounted) return null;\n\n  return createPortal(\n    <div\n      className=\"fixed inset-0 bg-gray-600 bg-opacity-75 z-50\"\n      onClick={onClose}\n    >\n      <div\n        ref={modalRef}\n        className=\"task-detail-modal\"\n        style={{\n          position: 'fixed',\n          left: position.x,\n          top: position.y,\n          cursor: isDragging ? 'grabbing' : 'grab',\n          minWidth: '320px',\n          maxWidth: '560px',\n        }}\n        onMouseDown={handleMouseDown}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className=\"modal-header flex justify-between items-center pb-4 border-b border-gray-200 mb-6 cursor-move -mt-[10px]\">\n          <h2 className=\"text-2xl font-bold text-[#0F172A]\">{task.title}</h2>\n          <button\n            onClick={onClose}\n            className=\"modal-close-btn\"\n          >\n            <X size={16} stroke=\"white\" fill=\"white\" />\n          </button>\n        </div>\n        <div className=\"modal-body overflow-y-auto max-h-[60vh] space-y-6 mt-[5px]\">\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2\">Description</h3>\n            <p className=\"text-gray-700 leading-loose\">{task.description || \"No description provided.\"}</p>\n          </div>\n\n          {/* Date Fields Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Fechas</h3>\n            <div className=\"grid grid-cols-1 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de inicio</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={task.startDate ? new Date(task.startDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ startDate: newDate }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error updating start date:\", error);\n                    }\n                  }}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de finalización</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={task.endDate ? new Date(task.endDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ endDate: newDate }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error updating end date:\", error);\n                    }\n                  }}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de tolerancia</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={task.toleranceDate ? new Date(task.toleranceDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ toleranceDate: newDate }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error updating tolerance date:\", error);\n                    }\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Priority Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Prioridad</h3>\n            <select\n              className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n              value={priority}\n              onChange={async (e) => {\n                const newPriority = e.target.value;\n                setPriority(newPriority);\n                try {\n                  await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                    method: \"PUT\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({ priority: newPriority }),\n                  });\n                  onTaskUpdate();\n                } catch (error) {\n                  console.error(\"Error updating priority:\", error);\n                }\n              }}\n            >\n              <option value=\"LOW\">Baja</option>\n              <option value=\"MEDIUM\">Media</option>\n              <option value=\"HIGH\">Alta</option>\n              <option value=\"URGENT\">Urgente</option>\n            </select>\n          </div>\n\n          {/* User Assignment Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Asignado a</h3>\n            <div className=\"flex flex-wrap gap-2 mb-3\">\n              {selectedAssignees.map((assigneeId) => {\n                const assignee = availableUsers.find(u => u.id === assigneeId) ||\n                  task?.assignees?.find(a => a.id === assigneeId);\n                if (!assignee) return null;\n\n                return (\n                  <div\n                    key={assignee.id}\n                    className=\"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-full\"\n                  >\n                    {assignee.image ? (\n                      <img\n                        src={assignee.image}\n                        alt={assignee.name || assignee.email || \"User\"}\n                        className=\"w-6 h-6 rounded-full\"\n                      />\n                    ) : (\n                      <div className=\"w-6 h-6 rounded-full bg-blue-200 flex items-center justify-center text-xs font-medium text-neutral-900\">\n                        {(assignee.name || assignee.email || \"?\")[0].toUpperCase()}\n                      </div>\n                    )}\n                    <span className=\"text-sm text-gray-700\">{assignee.name || assignee.email}</span>\n                    <button\n                      className=\"text-gray-600 hover:text-red-600\"\n                      onClick={async () => {\n                        const newAssignees = selectedAssignees.filter(id => id !== assignee.id);\n                        setSelectedAssignees(newAssignees);\n                        try {\n                          await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                            method: \"PUT\",\n                            headers: { \"Content-Type\": \"application/json\" },\n                            body: JSON.stringify({ assignees: newAssignees }),\n                          });\n                          onTaskUpdate();\n                        } catch (error) {\n                          console.error(\"Error removing assignee:\", error);\n                        }\n                      }}\n                    >\n                      ×\n                    </button>\n                  </div>\n                );\n              })}\n            </div>\n            <select\n              className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n              value=\"\"\n              onChange={async (e) => {\n                const userId = e.target.value;\n                console.log(\"Selected user ID:\", userId);\n                console.log(\"Current selectedAssignees:\", selectedAssignees);\n\n                if (!userId || selectedAssignees.includes(userId)) return;\n\n                const newAssignees = [...selectedAssignees, userId];\n                console.log(\"New assignees array:\", newAssignees);\n\n                try {\n                  const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                    method: \"PUT\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({ assignees: newAssignees }),\n                  });\n\n                  if (response.ok) {\n                    const updatedTask = await response.json();\n                    console.log(\"Updated task from API:\", updatedTask);\n                    console.log(\"Assignees in response:\", updatedTask.assignees);\n\n                    // Update local state with the response\n                    if (updatedTask.assignees) {\n                      const newIds = updatedTask.assignees.map((a: any) => a.id);\n                      console.log(\"Setting selectedAssignees to:\", newIds);\n                      setSelectedAssignees(newIds);\n                    }\n\n                    // Refresh the board to update the task in the parent component\n                    await onTaskUpdate();\n\n                    // Force a re-fetch of the task to update the modal\n                    // The parent will update and the modal will receive new props\n                  } else {\n                    console.error(\"Response not OK:\", response.status);\n                  }\n                } catch (error) {\n                  console.error(\"Error adding assignee:\", error);\n                }\n              }}\n            >\n              <option value=\"\">Agregar usuario...</option>\n              {availableUsers\n                .filter(user => !selectedAssignees.includes(user.id))\n                .map(user => (\n                  <option key={user.id} value={user.id}>\n                    {user.name || user.email}\n                  </option>\n                ))}\n            </select>\n          </div>\n\n          {/* Tags Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Etiquetas</h3>\n            <div className=\"flex flex-wrap gap-2 mb-3\">\n              {tags.map((tag, index) => (\n                <span\n                  key={index}\n                  className=\"px-3 py-1 rounded-full text-sm font-medium\"\n                  style={{ backgroundColor: tag.color || '#E0E7FF', color: '#1E293B' }}\n                >\n                  {tag.name}\n                  <button\n                    className=\"ml-2 text-gray-600 hover:text-red-600\"\n                    onClick={async () => {\n                      const newTags = tags.filter((_, i) => i !== index);\n                      setTags(newTags);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ tags: newTags }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error removing tag:\", error);\n                      }\n                    }}\n                  >\n                    ×\n                  </button>\n                </span>\n              ))}\n            </div>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Nueva etiqueta\"\n                className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newTagName}\n                onChange={(e) => setNewTagName(e.target.value)}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && newTagName.trim()) {\n                    const colors = ['#E0E7FF', '#FEF3C7', '#D1FAE5', '#FCE7F3', '#E0F2FE'];\n                    const newTag = { name: newTagName.trim(), color: colors[tags.length % colors.length] };\n                    const newTags = [...tags, newTag];\n                    setTags(newTags);\n                    setNewTagName(\"\");\n                    fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ tags: newTags }),\n                    }).then(() => onTaskUpdate());\n                  }\n                }}\n              />\n              <button\n                className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                onClick={async () => {\n                  if (!newTagName.trim()) return;\n                  const colors = ['#E0E7FF', '#FEF3C7', '#D1FAE5', '#FCE7F3', '#E0F2FE'];\n                  const newTag = { name: newTagName.trim(), color: colors[tags.length % colors.length] };\n                  const newTags = [...tags, newTag];\n                  setTags(newTags);\n                  setNewTagName(\"\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ tags: newTags }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error adding tag:\", error);\n                  }\n                }}\n              >\n                Agregar\n              </button>\n            </div>\n          </div>\n\n          {/* Links Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Enlaces</h3>\n            <div className=\"space-y-2 mb-3\">\n              {links.map((link, index) => (\n                <div key={index} className=\"flex items-center justify-between p-2 bg-gray-50 rounded-lg\">\n                  <a\n                    href={link.url}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-blue-600 hover:underline flex-1 truncate\"\n                  >\n                    {link.title || link.url}\n                  </a>\n                  <button\n                    className=\"ml-2 text-gray-600 hover:text-red-600\"\n                    onClick={async () => {\n                      const newLinks = links.filter((_, i) => i !== index);\n                      setLinks(newLinks);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ links: newLinks }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error removing link:\", error);\n                      }\n                    }}\n                  >\n                    ×\n                  </button>\n                </div>\n              ))}\n            </div>\n            <div className=\"space-y-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Título del enlace\"\n                className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newLinkTitle}\n                onChange={(e) => setNewLinkTitle(e.target.value)}\n              />\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"url\"\n                  placeholder=\"https://ejemplo.com\"\n                  className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                  value={newLinkUrl}\n                  onChange={(e) => setNewLinkUrl(e.target.value)}\n                />\n                <button\n                  className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                  onClick={async () => {\n                    if (!newLinkUrl.trim()) return;\n                    const newLink = { title: newLinkTitle.trim() || newLinkUrl, url: newLinkUrl.trim() };\n                    const newLinks = [...links, newLink];\n                    setLinks(newLinks);\n                    setNewLinkTitle(\"\");\n                    setNewLinkUrl(\"\");\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ links: newLinks }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error adding link:\", error);\n                    }\n                  }}\n                >\n                  Agregar\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Checklist Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Checklist</h3>\n            <div className=\"space-y-2 mb-3\">\n              {checklist.map((item) => (\n                <div key={item.id} className=\"flex items-center gap-2\">\n                  <input\n                    type=\"checkbox\"\n                    checked={item.completed}\n                    className=\"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-600\"\n                    onChange={async (e) => {\n                      const newChecklist = checklist.map(i =>\n                        i.id === item.id ? { ...i, completed: e.target.checked } : i\n                      );\n                      setChecklist(newChecklist);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ checklist: newChecklist }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error updating checklist:\", error);\n                      }\n                    }}\n                  />\n                  <span className={`flex-1 ${item.completed ? 'line-through text-gray-500' : 'text-gray-700'}`}>\n                    {item.text}\n                  </span>\n                  <button\n                    className=\"text-gray-600 hover:text-red-600\"\n                    onClick={async () => {\n                      const newChecklist = checklist.filter(i => i.id !== item.id);\n                      setChecklist(newChecklist);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ checklist: newChecklist }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error removing checklist item:\", error);\n                      }\n                    }}\n                  >\n                    ×\n                  </button>\n                </div>\n              ))}\n            </div>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Nuevo item\"\n                className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newChecklistItem}\n                onChange={(e) => setNewChecklistItem(e.target.value)}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && newChecklistItem.trim()) {\n                    const newItem = { id: Date.now().toString(), text: newChecklistItem.trim(), completed: false };\n                    const newChecklist = [...checklist, newItem];\n                    setChecklist(newChecklist);\n                    setNewChecklistItem(\"\");\n                    fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ checklist: newChecklist }),\n                    }).then(() => onTaskUpdate());\n                  }\n                }}\n              />\n              <button\n                className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                onClick={async () => {\n                  if (!newChecklistItem.trim()) return;\n                  const newItem = { id: Date.now().toString(), text: newChecklistItem.trim(), completed: false };\n                  const newChecklist = [...checklist, newItem];\n                  setChecklist(newChecklist);\n                  setNewChecklistItem(\"\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ checklist: newChecklist }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error adding checklist item:\", error);\n                  }\n                }}\n              >\n                Agregar\n              </button>\n            </div>\n          </div>\n\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Subtasks</h3>\n\n            {/* Recursive subtask renderer */}\n            {(() => {\n              const renderSubtasks = (subtasks: typeof task.children, depth = 0): React.ReactElement[] => {\n                if (!subtasks || subtasks.length === 0) return [];\n\n                return subtasks.map((subtask) => (\n                  <li key={subtask.id} style={{ marginLeft: `${depth * 16}px` }} className=\"text-gray-700 flex items-start gap-2 leading-relaxed\">\n                    <span className=\"mt-1.5 w-1.5 h-1.5 rounded-full bg-gray-400 flex-shrink-0\" />\n                    <div className=\"flex-1\">\n                      <span>{subtask.title}</span>\n                      {subtask.children && subtask.children.length > 0 && (\n                        <ul className=\"space-y-2 mt-2\">\n                          {renderSubtasks(subtask.children, depth + 1)}\n                        </ul>\n                      )}\n                    </div>\n                  </li>\n                ));\n              };\n\n              // Calculate current task depth\n              const calculateDepth = (t: typeof task, allTasks: any[] = []): number => {\n                // This is a simplified depth calculation for the modal\n                // In a real scenario, you'd need to traverse up the parent chain\n                // For now, we'll use a heuristic based on parentId presence\n                let depth = 0;\n                let current = t;\n                // We can't traverse up without fetching parent data, so we'll use a simpler approach\n                // Just count if this task has a parentId (depth 1+)\n                if (current.parentId) depth = 1;\n                // For more accurate depth, we'd need to fetch the full parent chain\n                // For now, we'll allow subtask creation and let the backend handle validation\n                return depth;\n              };\n\n              const currentDepth = calculateDepth(task);\n              const maxDepth = 5;\n              const canAddSubtask = currentDepth < maxDepth;\n\n              return (\n                <>\n                  {task.children && task.children.length > 0 ? (\n                    <ul className=\"space-y-3 mb-4\">\n                      {renderSubtasks(task.children)}\n                    </ul>\n                  ) : (\n                    <p className=\"text-gray-500 italic mb-4\">No subtasks yet.</p>\n                  )}\n\n                  {/* UI to add new subtask */}\n                  <div className=\"flex gap-3 mt-[10px]\">\n                    <input\n                      type=\"text\"\n                      placeholder={canAddSubtask ? \"New subtask title\" : \"Max depth reached (5 levels)\"}\n                      className=\"flex-grow p-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB] transition-shadow\"\n                      value={subtaskTitle}\n                      onChange={(e) => setSubtaskTitle(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter' && canAddSubtask) {\n                          handleAddSubtask();\n                        }\n                      }}\n                      disabled={!canAddSubtask}\n                    />\n                    <button\n                      className=\"btn-primary whitespace-nowrap\"\n                      onClick={handleAddSubtask}\n                      disabled={isAddingSubtask || !subtaskTitle.trim() || !canAddSubtask}\n                    >\n                      {isAddingSubtask ? 'Adding...' : 'Add Subtask'}\n                    </button>\n                  </div>\n                </>\n              );\n            })()}\n          </div>\n\n          {/* Modal Footer with Delete Button */}\n          <div className=\"modal-footer mt-6 pt-4 border-t border-gray-200 flex justify-end\">\n            <button\n              className=\"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium\"\n              onClick={async () => {\n                if (confirm(`¿Estás seguro de que quieres eliminar \"${task.title}\"?${task.children && task.children.length > 0 ? ' Esto también eliminará todas sus subtareas.' : ''}`)) {\n                  try {\n                    const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"DELETE\",\n                    });\n\n                    if (response.ok) {\n                      onClose();\n                      onTaskUpdate(); // Refresh the board\n                    } else {\n                      alert(\"Error al eliminar la tarea\");\n                    }\n                  } catch (error) {\n                    console.error(\"Error deleting task:\", error);\n                    alert(\"Error al eliminar la tarea\");\n                  }\n                }\n              }}\n            >\n              Eliminar Tarea\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>,\n    document.body\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1886, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/KanbanBoard.tsx"],"sourcesContent":["\"use client\";\nimport React, { useCallback, useMemo, useState } from \"react\";\nimport {\n  DndContext,\n  DragEndEvent,\n  DragOverlay,\n  DragStartEvent,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  Active,\n  closestCorners,\n} from \"@dnd-kit/core\";\nimport { arrayMove, SortableContext } from \"@dnd-kit/sortable\";\nimport { createPortal } from \"react-dom\";\nimport useSWR from \"swr\";\nimport { Column } from \"./Column\";\nimport { Task } from \"./Task\";\nimport { Button } from \"../ui/button\";\nimport { TaskDetailModal } from \"./TaskDetailModal\";\n\ninterface KanbanBoardProps {\n  projectId: string;\n}\n\n// Define types for fetched data\ninterface FetchedTask {\n  id: string;\n  title: string;\n  description?: string; // description for Task\n  columnId: string;\n  projectId: string;\n  parentId?: string | null; // Added parentId\n  order: number;\n  isActive?: boolean;\n  children?: {\n    id: string;\n    title: string;\n    description?: string;\n  }[];\n}\n\ninterface FetchedColumn {\n  id: string;\n  name: string;\n  order: number;\n  tasks: FetchedTask[];\n}\n\nconst fetcher = (url: string) => fetch(url).then((res) => res.json());\n\nexport function KanbanBoard({ projectId }: KanbanBoardProps) {\n  const { data: fetchedColumns, error, mutate } = useSWR<FetchedColumn[]>(\n    `/api/projects/${projectId}/columns`,\n    fetcher\n  );\n\n  const [columns, setColumns] = useState<FetchedColumn[]>([]);\n  const [tasks, setTasks] = useState<FetchedTask[]>([]);\n  const [activeItem, setActiveItem] = useState<Active | null>(null); // Can be a task or a column\n  const [selectedTaskId, setSelectedTaskId] = useState<string | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false); // State for modal visibility\n\n  const selectedTask = useMemo(() =>\n    tasks.find((task) => task.id === selectedTaskId) || null,\n    [tasks, selectedTaskId]\n  );\n\n  React.useEffect(() => {\n    if (fetchedColumns && Array.isArray(fetchedColumns)) {\n      setColumns(fetchedColumns);\n      const allTasks = fetchedColumns.flatMap((col) =>\n        col.tasks.map((task) => ({ ...task, columnId: col.id }))\n      );\n      setTasks(allTasks);\n    }\n  }, [fetchedColumns]);\n\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 3,\n      },\n    })\n  );\n\n  const columnsId = useMemo(() => columns.map((col) => col.id), [columns]);\n\n  const findColumn = useCallback(\n    (id: string) => {\n      return columns.find((col) => col.id === id);\n    },\n    [columns]\n  );\n\n  const findTask = useCallback(\n    (id: string) => {\n      return tasks.find((task) => task.id === id);\n    },\n    [tasks]\n  );\n\n  const onDragStart = (event: DragStartEvent) => {\n    setActiveItem(event.active);\n  };\n\n  const onDragEnd = async (event: DragEndEvent) => {\n    const { active, over } = event;\n    setActiveItem(null);\n\n    if (!over) {\n      mutate(); // If dropped outside, re-mutate to revert\n      return;\n    }\n\n    const activeId = active.id.toString();\n    const overId = over.id.toString();\n\n    if (activeId === overId) return;\n\n    const isActiveATask = active.data.current?.type === \"Task\";\n    const isOverATask = over.data.current?.type === \"Task\";\n    const isActiveAColumn = active.data.current?.type === \"Column\";\n    const isOverAColumn = over.data.current?.type === \"Column\";\n\n    // Handle Column Reordering\n    if (isActiveAColumn && isOverAColumn) {\n      const activeColumnIndex = columns.findIndex((col) => col.id === activeId);\n      const overColumnIndex = columns.findIndex((col) => col.id === overId);\n\n      const newColumns = arrayMove(columns, activeColumnIndex, overColumnIndex);\n      setColumns(newColumns);\n\n      // Update order in backend\n      await Promise.all(\n        newColumns.map(async (col, index) => {\n          if (col.order !== index) {\n            await fetch(\n              `/api/projects/${projectId}/columns/${col.id}`,\n              {\n                method: \"PUT\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ order: index }),\n              }\n            );\n          }\n        })\n      );\n      mutate(); // Re-mutate to refetch and ensure state consistency\n      return;\n    }\n\n    // Handle Task Movement within or between Columns\n    if (isActiveATask) {\n      const activeTask = tasks.find((task) => task.id === activeId);\n      if (!activeTask) return;\n\n      let newColumnId = activeTask.columnId;\n      let newOrder = activeTask.order;\n\n      // Determine the destination column ID\n      if (isOverAColumn) {\n        newColumnId = overId;\n      } else if (isOverATask) {\n        const overTask = tasks.find((task) => task.id === overId);\n        if (overTask) {\n          newColumnId = overTask.columnId;\n        }\n      }\n\n      // Calculate new order for the task\n      const tasksInNewColumn = tasks.filter((t) => t.columnId === newColumnId && t.id !== activeId);\n      if (isOverATask) {\n        const overTaskIndex = tasksInNewColumn.findIndex(t => t.id === overId);\n        newOrder = overTaskIndex === -1 ? tasksInNewColumn.length : overTaskIndex;\n      } else { // Dropped over a column or at the end\n        newOrder = tasksInNewColumn.length;\n      }\n\n      // Optimistic update for tasks array\n      setTasks((prevTasks) => {\n        // Find the active task before modifying prevTasks\n        const activeTaskInPrev = prevTasks.find((task) => task.id === activeId);\n        if (!activeTaskInPrev) return prevTasks; // Should not happen if activeTask is valid\n\n        // Check if this task has children (is a parent task)\n        const hasChildren = activeTaskInPrev.children && activeTaskInPrev.children.length > 0;\n        const isColumnChanging = activeTaskInPrev.columnId !== newColumnId;\n\n        // Create the moved task with its new properties\n        const movedTask = { ...activeTaskInPrev, columnId: newColumnId, order: newOrder };\n\n        // Filter out the active task from its original position\n        let tasksWithoutActive = prevTasks.filter((t) => t.id !== activeId);\n\n        // If moving to a different column and has children, also move ALL descendants recursively\n        if (isColumnChanging && hasChildren) {\n          // Recursive function to get all descendant IDs\n          const getAllDescendantIds = (parentTaskId: string, allTasks: typeof prevTasks): string[] => {\n            const children = allTasks.filter(t => t.parentId === parentTaskId);\n            if (children.length === 0) return [];\n\n            const childIds = children.map(c => c.id);\n            const grandchildIds = childIds.flatMap(id => getAllDescendantIds(id, allTasks));\n\n            return [...childIds, ...grandchildIds];\n          };\n\n          const descendantIds = getAllDescendantIds(activeId, prevTasks);\n\n          // Update all descendants to the new column\n          tasksWithoutActive = tasksWithoutActive.map((t) => {\n            if (descendantIds.includes(t.id)) {\n              return { ...t, columnId: newColumnId };\n            }\n            return t;\n          });\n        }\n\n        if (activeTaskInPrev.columnId === newColumnId) {\n          // Moving within the same column\n          const columnTasks = tasksWithoutActive\n            .filter(t => t.columnId === newColumnId)\n            .concat(movedTask)\n            .sort((a, b) => a.order - b.order)\n            .map((t, index) => ({ ...t, order: index }));\n\n          const otherTasks = prevTasks.filter(t => t.columnId !== newColumnId);\n          return [...otherTasks, ...columnTasks];\n        } else {\n          // Moving between different columns\n          const tasksInSourceColumn = tasksWithoutActive\n            .filter(t => t.columnId === activeTaskInPrev.columnId)\n            .sort((a, b) => a.order - b.order) // Ensure stable sort for re-indexing\n            .map((t, index) => ({ ...t, order: index }));\n\n          const tasksInDestinationColumn = tasksWithoutActive\n            .filter(t => t.columnId === newColumnId)\n            .concat(movedTask) // Add the moved task to the destination column's tasks\n            .sort((a, b) => a.order - b.order) // Ensure stable sort for re-indexing\n            .map((t, index) => ({ ...t, order: index }));\n\n          // Tasks that were not in the source or destination column\n          const otherTasksUnmodified = prevTasks.filter(\n            t => t.columnId !== activeTaskInPrev.columnId && t.columnId !== newColumnId\n          );\n\n          // Combine all tasks back into a single array\n          return [...otherTasksUnmodified, ...tasksInSourceColumn, ...tasksInDestinationColumn];\n        }\n      });\n\n      // Update backend\n      await fetch(`/api/projects/${projectId}/tasks/${activeId}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ columnId: newColumnId, order: newOrder }),\n      });\n      mutate(); // Re-mutate to refetch and ensure state consistency\n      return;\n    }\n    mutate(); // If nothing moved or dropped outside, re-mutate to ensure consistency\n  };\n\n  // Function to add a new column\n  const handleAddColumn = async () => {\n    const newColumnName = prompt(\"Enter new column name:\");\n    if (newColumnName) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ name: newColumnName }),\n        });\n        if (response.ok) {\n          mutate(); // Re-fetch data to include the new column\n        } else {\n          console.error(\"Failed to add column\");\n        }\n      } catch (error) {\n        console.error(\"Error adding column:\", error);\n      }\n    }\n  };\n\n  // Function to create a new task within a column\n  const handleCreateTask = async (columnId: string) => {\n    const newTaskTitle = prompt(\"Enter new task title:\");\n    if (newTaskTitle) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/tasks`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ title: newTaskTitle, columnId }),\n        });\n        if (response.ok) {\n          mutate(); // Re-fetch data to include the new task\n        } else {\n          console.error(\"Failed to add task\");\n        }\n      } catch (error) {\n        console.error(\"Error adding task:\", error);\n      }\n    }\n  };\n\n  const handleEditColumnName = async (columnId: string, currentName: string) => {\n    const newName = prompt(\"Edit column name:\", currentName);\n    if (newName && newName !== currentName) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns/${columnId}`, {\n          method: \"PUT\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ name: newName }),\n        });\n        if (response.ok) {\n          mutate();\n        } else {\n          console.error(\"Failed to edit column name\");\n        }\n      } catch (error) {\n        console.error(\"Error editing column name:\", error);\n      }\n    }\n  };\n\n  const handleDeleteColumn = async (columnId: string) => {\n    if (confirm(\"Are you sure you want to delete this column and all its tasks?\")) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns/${columnId}`, {\n          method: \"DELETE\",\n        });\n        if (response.ok) {\n          mutate();\n        } else {\n          console.error(\"Failed to delete column\");\n        }\n      } catch (error) {\n        console.error(\"Error deleting column:\", error);\n      }\n    }\n  };\n\n  const handleTaskClick = (taskId: string) => {\n    console.log(\"Task clicked:\", taskId); // Debugging\n    setSelectedTaskId(taskId);\n    setIsModalOpen(true);\n    console.log(\"isModalOpen set to true\"); // Debugging\n  };\n\n  const handleCloseModal = () => {\n    setIsModalOpen(false);\n    setSelectedTaskId(null);\n    console.log(\"Modal closed\"); // Debugging\n  };\n\n  if (error) return <div>Failed to load kanban board.</div>;\n  if (!fetchedColumns) return <div>Loading...</div>; // Use fetchedColumns for initial loading check\n\n  const activeTaskContent = activeItem?.data.current?.type === \"Task\"\n    ? tasks.find(t => t.id === activeItem.id)\n    : null;\n\n  return (\n    <div>\n      <div className=\"header\">\n        <div className=\"header-title\">{\"< Project\"}</div>\n        <Button onClick={handleAddColumn} className=\"btn-primary\">Add Column</Button>\n      </div>\n\n      <div className=\"kanban overflow-x-auto whitespace-nowrap min-h-screen\">\n        <DndContext\n          sensors={sensors}\n          onDragStart={onDragStart}\n          onDragEnd={onDragEnd}\n        >\n          <SortableContext items={columnsId}>\n            {columns.map((column) => (\n              <Column\n                key={column.id}\n                id={column.id}\n                title={column.name}\n                tasks={tasks.filter((task) => task.columnId === column.id).sort((a, b) => a.order - b.order)} // Filter out subtasks\n                onEditName={handleEditColumnName}\n                onDelete={handleDeleteColumn}\n                onCreateTask={handleCreateTask}\n                onTaskClick={handleTaskClick} // Pass the click handler\n              />\n            ))}\n          </SortableContext>\n          {createPortal(\n            <DragOverlay>\n              {activeItem && activeItem.data.current?.type === \"Task\" && activeTaskContent ? (\n                <Task\n                  id={activeTaskContent.id}\n                  title={activeTaskContent.title} // Pass title here\n                  isActive={false}\n                  className=\"dragging\"\n                  subtasksCount={activeTaskContent.children?.length || 0}\n                  parentId={activeTaskContent.parentId}\n                />\n              ) : null}\n              {activeItem && activeItem.data.current?.type === \"Column\" ? (\n                <div className=\"column dragging\">\n                  <h2 className=\"column-title\">{findColumn(activeItem.id.toString())?.name}</h2>\n                  {/* Optionally render tasks in the dragged column */}\n                </div>\n              ) : null}\n            </DragOverlay>,\n            document.body\n          )}\n        </DndContext>\n      </div>\n      {isModalOpen && selectedTask && (\n        <TaskDetailModal\n          key={selectedTask.id}\n          task={selectedTask}\n          onClose={handleCloseModal}\n          onTaskUpdate={mutate}\n        />\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}