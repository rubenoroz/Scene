{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/Task.tsx"],"sourcesContent":["import { useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\nimport { CheckSquare, Link2, ChevronDown, ChevronRight, Eye, EyeOff } from \"lucide-react\";\n\nconst PRIORITY_COLORS = {\n  LOW: \"#D1FAE5\",\n  MEDIUM: \"#FEF3C7\",\n  HIGH: \"#FED7AA\",\n  URGENT: \"#FECACA\",\n};\n\nconst PRIORITY_LABELS = {\n  LOW: \"Baja\",\n  MEDIUM: \"Media\",\n  HIGH: \"Alta\",\n  URGENT: \"Urgente\",\n};\n\nexport function Task({\n  id,\n  title,\n  onClick,\n  subtasksCount = 0,\n  level = 0,\n  priority,\n  assignees = [],\n  links = [],\n  checklist = [],\n  cardColor, // New prop\n  progress, // New prop\n  onProgressChange, // New prop\n  isCollapsed = false, // New prop\n  onToggleCollapse, // New prop\n  isHidden = false, // New prop\n  onToggleHide, // New prop\n}: {\n  id: string;\n  title: string;\n  onClick?: (taskId: string) => void;\n  subtasksCount?: number;\n  level?: number;\n  priority?: string;\n  assignees?: { id: string; name: string | null; email: string | null; image: string | null }[];\n  links?: { title: string; url: string }[];\n  checklist?: { id: string; text: string; completed: boolean }[];\n  cardColor?: string; // New prop\n  progress?: number; // New prop\n  onProgressChange?: (taskId: string, newProgress: number) => void; // New prop\n  isCollapsed?: boolean; // New prop\n  onToggleCollapse?: (taskId: string) => void; // New prop\n  isHidden?: boolean; // New prop\n  onToggleHide?: (taskId: string) => void; // New prop\n}) {\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({\n    id,\n    data: {\n      type: \"Task\",\n    },\n  });\n\n  const style = {\n    transition: isDragging ? transition : 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n    transform: CSS.Transform.toString(transform),\n    marginLeft: level > 0 ? `${level * 20}px` : '0',\n    backgroundColor: cardColor || '#FFFFFF',\n    opacity: isDragging ? 0.5 : 1,\n  };\n\n  const completedChecklistItems = checklist.filter(item => item.completed).length;\n  const totalChecklistItems = checklist.length;\n\n  return (\n    <div\n      ref={setNodeRef}\n      style={style}\n      {...attributes}\n      {...listeners}\n      onClick={onClick ? () => onClick(id) : undefined}\n      className={`card p-4 rounded-lg shadow-sm transition-all duration-300 ease-out hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] group ${isDragging ? \"dragging shadow-2xl scale-105\" : \"\"}`}\n    >\n      {/* Priority Badge */}\n      {priority && (\n        <div\n          className=\"inline-block px-2 py-0.5 rounded text-xs font-medium mb-2 transition-all duration-200 hover:scale-105\"\n          style={{\n            backgroundColor: PRIORITY_COLORS[priority as keyof typeof PRIORITY_COLORS],\n            color: '#1E293B'\n          }}\n        >\n          {PRIORITY_LABELS[priority as keyof typeof PRIORITY_LABELS]}\n        </div>\n      )}\n\n      {/* Chevron button for tasks with subtasks */}\n      <div className=\"flex items-center gap-2\">\n        {subtasksCount > 0 && onToggleCollapse && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              onToggleCollapse(id);\n            }}\n            className=\"p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0\"\n            title={isCollapsed ? \"Expandir subtareas\" : \"Colapsar subtareas\"}\n          >\n            {isCollapsed ? (\n              <ChevronRight size={16} className=\"text-gray-600\" />\n            ) : (\n              <ChevronDown size={16} className=\"text-gray-600\" />\n            )}\n          </button>\n        )}\n\n        {/* Hide Button */}\n        {onToggleHide && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              onToggleHide(id);\n            }}\n            className={`p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0 ${isHidden ? 'text-blue-600 opacity-100' : 'text-gray-400 hover:text-gray-600 opacity-0 group-hover:opacity-100'}`}\n            title={isHidden ? \"Mostrar tarea\" : \"Ocultar tarea temporalmente\"}\n          >\n            {isHidden ? <EyeOff size={16} /> : <Eye size={16} />}\n          </button>\n        )}\n\n        <h3\n          className=\"text-sm font-medium text-gray-800 truncate flex-1\"\n          title={title}\n        >\n          {title}\n        </h3>\n      </div>\n\n      {/* Metadata Row */}\n      <div className=\"flex items-center gap-2 mt-2 flex-wrap\">\n        {/* Subtasks Count */}\n        {subtasksCount > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <CheckSquare size={14} />\n            <span>{subtasksCount}</span>\n          </div>\n        )}\n\n        {/* Checklist Progress */}\n        {totalChecklistItems > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <CheckSquare size={14} />\n            <span>{completedChecklistItems}/{totalChecklistItems}</span>\n          </div>\n        )}\n\n        {/* Links Indicator */}\n        {links.length > 0 && (\n          <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n            <Link2 size={14} />\n            <span>{links.length}</span>\n          </div>\n        )}\n\n        {/* Assignee Avatars */}\n        {assignees.length > 0 && (\n          <div className=\"flex -space-x-2 ml-auto\">\n            {assignees.slice(0, 3).map((assignee) => (\n              assignee.image ? (\n                <img\n                  key={assignee.id}\n                  src={assignee.image}\n                  alt={assignee.name || assignee.email || \"User\"}\n                  className=\"w-6 h-6 rounded-full border-2 border-white\"\n                  title={assignee.name || assignee.email || \"\"}\n                />\n              ) : (\n                <div\n                  key={assignee.id}\n                  className=\"w-6 h-6 rounded-full bg-blue-200 border-2 border-white flex items-center justify-center text-xs font-medium text-neutral-900\"\n                  title={assignee.name || assignee.email || \"\"}\n                >\n                  {(assignee.name || assignee.email || \"?\")[0].toUpperCase()}\n                </div>\n              )\n            ))}\n            {assignees.length > 3 && (\n              <div className=\"w-6 h-6 rounded-full bg-gray-300 border-2 border-white flex items-center justify-center text-xs font-medium text-gray-700\">\n                +{assignees.length - 3}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Progress Bar and Complete Button */}\n      <div className=\"mt-3 flex items-center gap-2\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"flex-1\">\n          <div className=\"flex justify-between text-xs text-gray-500 mb-1\">\n            <span>Progreso</span>\n            <span>{progress || 0}%</span>\n          </div>\n          <div\n            className=\"w-full bg-gray-200 rounded-full h-1.5 cursor-pointer relative group transition-all duration-200 hover:h-2\"\n            onClick={(e) => {\n              e.stopPropagation();\n              const rect = e.currentTarget.getBoundingClientRect();\n              const x = e.clientX - rect.left;\n              const width = rect.width;\n              const newProgress = Math.round((x / width) * 100);\n              // Clamp between 0 and 100\n              const clampedProgress = Math.min(100, Math.max(0, newProgress));\n              if (onProgressChange) onProgressChange(id, clampedProgress);\n            }}\n          >\n            <div\n              className=\"bg-blue-500 h-1.5 rounded-full transition-all duration-500 ease-out group-hover:h-2\"\n              style={{ width: `${progress || 0}%` }}\n            ></div>\n            {/* Hover effect to show potential progress */}\n            <div className=\"absolute inset-0 bg-blue-500 opacity-0 group-hover:opacity-10 rounded-full transition-all duration-300\"></div>\n          </div>\n        </div>\n        <button\n          onClick={(e) => {\n            e.stopPropagation();\n            if (onProgressChange) onProgressChange(id, 100);\n          }}\n          className={`p-1 rounded-full transition-all duration-200 hover:scale-110 active:scale-95 ${progress === 100\n            ? \"text-green-600 bg-green-100 hover:bg-green-200 shadow-sm\"\n            : \"text-gray-400 hover:text-green-600 hover:bg-gray-100\"\n            }`}\n          title=\"Marcar como completada\"\n        >\n          <CheckSquare size={16} className=\"transition-transform duration-200\" />\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 384, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/lib/colors.ts"],"sourcesContent":["export const pastelColorPairs = [\n  { column: \"#FBCFE8\", card: \"#FFF1F2\" }, // Pink\n  { column: \"#C7D2FE\", card: \"#EEF2FF\" }, // Indigo\n  { column: \"#BFDBFE\", card: \"#EFF6FF\" }, // Blue\n  { column: \"#A7F3D0\", card: \"#F0FDFA\" }, // Emerald\n  { column: \"#FEF08A\", card: \"#FEFCE8\" }, // Yellow\n  { column: \"#FED7AA\", card: \"#FFF7ED\" }, // Orange\n  { column: \"#E9D5FF\", card: \"#FAFAF5\" }, // Purple\n];"],"names":[],"mappings":";;;;AAAO,MAAM,mBAAmB;IAC9B;QAAE,QAAQ;QAAW,MAAM;IAAU;IACrC;QAAE,QAAQ;QAAW,MAAM;IAAU;IACrC;QAAE,QAAQ;QAAW,MAAM;IAAU;IACrC;QAAE,QAAQ;QAAW,MAAM;IAAU;IACrC;QAAE,QAAQ;QAAW,MAAM;IAAU;IACrC;QAAE,QAAQ;QAAW,MAAM;IAAU;IACrC;QAAE,QAAQ;QAAW,MAAM;IAAU;CACtC"}},
    {"offset": {"line": 425, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 443, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/dropdown-menu.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n    React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n    React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n        inset?: boolean\n    }\n>(({ className, inset, children, ...props }, ref) => (\n    <DropdownMenuPrimitive.SubTrigger\n        ref={ref}\n        className={cn(\n            \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent\",\n            inset && \"pl-8\",\n            className\n        )}\n        {...props}\n    >\n        {children}\n        <ChevronRight className=\"ml-auto h-4 w-4\" />\n    </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n    DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n    React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n    React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n    <DropdownMenuPrimitive.SubContent\n        ref={ref}\n        className={cn(\n            \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n            className\n        )}\n        {...props}\n    />\n))\nDropdownMenuSubContent.displayName =\n    DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n    React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n    React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n    <DropdownMenuPrimitive.Portal>\n        <DropdownMenuPrimitive.Content\n            ref={ref}\n            sideOffset={sideOffset}\n            className={cn(\n                \"z-50 min-w-[8rem] overflow-hidden rounded-md border border-slate-200 bg-white p-1 text-slate-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n                className\n            )}\n            {...props}\n        />\n    </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\n// Enhanced menu item with visible hover state\nconst DropdownMenuItem = React.forwardRef<\n    React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n    React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n        inset?: boolean\n    }\n>(({ className, inset, ...props }, ref) => (\n    <DropdownMenuPrimitive.Item\n        ref={ref}\n        className={cn(\n            \"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-slate-100 focus:bg-slate-100 focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n            inset && \"pl-8\",\n            className\n        )}\n        {...props}\n    />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n    React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n    React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n    <DropdownMenuPrimitive.CheckboxItem\n        ref={ref}\n        className={cn(\n            \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n            className\n        )}\n        checked={checked}\n        {...props}\n    >\n        <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n            <DropdownMenuPrimitive.ItemIndicator>\n                <Check className=\"h-4 w-4\" />\n            </DropdownMenuPrimitive.ItemIndicator>\n        </span>\n        {children}\n    </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n    DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n    React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n    React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n    <DropdownMenuPrimitive.RadioItem\n        ref={ref}\n        className={cn(\n            \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n            className\n        )}\n        {...props}\n    >\n        <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n            <DropdownMenuPrimitive.ItemIndicator>\n                <Circle className=\"h-2 w-2 fill-current\" />\n            </DropdownMenuPrimitive.ItemIndicator>\n        </span>\n        {children}\n    </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n    React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n    React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n        inset?: boolean\n    }\n>(({ className, inset, ...props }, ref) => (\n    <DropdownMenuPrimitive.Label\n        ref={ref}\n        className={cn(\n            \"px-2 py-1.5 text-sm font-semibold\",\n            inset && \"pl-8\",\n            className\n        )}\n        {...props}\n    />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n    React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n    React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n    <DropdownMenuPrimitive.Separator\n        ref={ref}\n        className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n        {...props}\n    />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n    className,\n    ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n    return (\n        <span\n            className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n            {...props}\n        />\n    )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n    DropdownMenu,\n    DropdownMenuTrigger,\n    DropdownMenuContent,\n    DropdownMenuItem,\n    DropdownMenuCheckboxItem,\n    DropdownMenuRadioItem,\n    DropdownMenuLabel,\n    DropdownMenuSeparator,\n    DropdownMenuShortcut,\n    DropdownMenuGroup,\n    DropdownMenuPortal,\n    DropdownMenuSub,\n    DropdownMenuSubContent,\n    DropdownMenuSubTrigger,\n    DropdownMenuRadioGroup,\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 685, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/Column.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useDroppable } from \"@dnd-kit/core\";\nimport { SortableContext, useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\nimport { Task } from \"./Task\";\nimport { Plus, X, GripVertical, Palette } from \"lucide-react\";\nimport { pastelColorPairs } from \"@/lib/colors\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\ninterface ColumnProps {\n  id: string;\n  title: string;\n  color?: string;\n  cardColor?: string;\n  tasks: any[];\n  onEditName: (columnId: string, newName: string) => void;\n  onDelete: (columnId: string) => void;\n  onCreateTask: (columnId: string) => void;\n  onTaskClick: (taskId: string) => void;\n  onColorChange: (columnId: string, newColumnColor: string, newCardColor: string) => void;\n  onProgressChange: (taskId: string, newProgress: number) => void;\n  collapsedTasks: Set<string>;\n  onToggleCollapse: (taskId: string) => void;\n  hiddenTasks: Set<string>; // New prop\n  onToggleHide: (taskId: string) => void; // New prop\n}\n\nexport function Column({ id, title, color, cardColor, tasks, onEditName, onDelete, onCreateTask, onTaskClick, onColorChange, onProgressChange,\n  collapsedTasks,\n  onToggleCollapse,\n  hiddenTasks,\n  onToggleHide,\n}: ColumnProps) {\n  const { setNodeRef: setDroppableNodeRef } = useDroppable({\n    id,\n    data: {\n      type: \"Column\",\n    },\n  });\n\n  const {\n    setNodeRef: setSortableNodeRef,\n    attributes,\n    listeners,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({ id: id, data: { type: \"Column\" } });\n\n  const dynamicStyle = {\n    transition: isDragging ? transition : 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n    transform: CSS.Transform.toString(transform),\n    backgroundColor: color || \"#FFFFFF\",\n    opacity: isDragging ? 0.6 : 1,\n  };\n\n  const [isEditingTitle, setIsEditingTitle] = useState(false);\n  const [newTitle, setNewTitle] = useState(title);\n\n  const handleTitleDoubleClick = () => {\n    setIsEditingTitle(true);\n  };\n\n  const handleTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setNewTitle(e.target.value);\n  };\n\n  const handleTitleBlur = () => {\n    if (newTitle.trim() !== \"\" && newTitle.trim() !== title) {\n      onEditName(id, newTitle.trim());\n    }\n    setIsEditingTitle(false);\n  };\n\n  const handleTitleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === \"Enter\") handleTitleBlur();\n    if (e.key === \"Escape\") {\n      setNewTitle(title);\n      setIsEditingTitle(false);\n    }\n  };\n\n  return (\n    <section\n      ref={(node) => {\n        setDroppableNodeRef(node);\n        setSortableNodeRef(node);\n      }}\n      style={dynamicStyle}\n      {...attributes}\n      className={`column flex-shrink-0 h-full p-4 rounded-lg shadow-sm transition-all duration-300 hover:shadow-md ${isDragging ? \"dragging shadow-2xl scale-105\" : \"\"}`}\n    >\n      <div className=\"flex justify-between items-center mb-4\">\n        <div className=\"flex items-center gap-2\">\n          <button {...listeners} className=\"cursor-grab text-gray-500 hover:text-gray-700 transition-all duration-200 hover:scale-110 active:cursor-grabbing\">\n            <GripVertical size={20} />\n          </button>\n          {isEditingTitle ? (\n            <input\n              type=\"text\"\n              value={newTitle}\n              onChange={handleTitleChange}\n              onBlur={handleTitleBlur}\n              onKeyDown={handleTitleKeyDown}\n              className=\"column-title-edit\"\n              autoFocus\n            />\n          ) : (\n            <h2 className=\"column-title\" onDoubleClick={handleTitleDoubleClick}>\n              {title}\n            </h2>\n          )}\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <button className=\"rounded-full w-8 h-8 flex items-center justify-center bg-white/50 hover:bg-white/80 transition-all duration-200 hover:scale-110 active:scale-95\">\n                <Palette size={16} />\n              </button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              <div className=\"grid grid-cols-3 gap-2 p-2\">\n                {pastelColorPairs.map((pair) => (\n                  <DropdownMenuItem\n                    key={pair.column}\n                    onSelect={() => onColorChange(id, pair.column, pair.card)}\n                    className=\"w-8 h-8 rounded-full cursor-pointer\"\n                    style={{ backgroundColor: pair.column }}\n                  />\n                ))}\n              </div>\n            </DropdownMenuContent>\n          </DropdownMenu>\n\n          <button onClick={() => onCreateTask(id)} className=\"rounded-full w-8 h-8 flex items-center justify-center bg-white/50 hover:bg-white/80 transition-all duration-200 hover:scale-110 active:scale-95\">\n            <Plus size={16} />\n          </button>\n          <button onClick={() => onDelete(id)} className=\"rounded-full w-8 h-8 flex items-center justify-center bg-white/50 hover:bg-white/80 transition-all duration-200 hover:scale-110 active:scale-95\">\n            <X size={16} />\n          </button>\n        </div>\n      </div>\n      <div className=\"flex flex-col gap-3 flex-1 overflow-y-auto min-h-[100px]\">\n        <SortableContext items={tasks.map((t) => t.id)}>\n          {tasks.map((task) => {\n            const calculateLevel = (t: any, allTasks: any[]): number => {\n              if (!t.parentId) return 0;\n              const parent = allTasks.find(p => p.id === t.parentId);\n              if (!parent) return 0;\n              return 1 + calculateLevel(parent, allTasks);\n            };\n            const level = calculateLevel(task, tasks);\n\n            return (\n              <Task\n                key={task.id}\n                id={task.id}\n                title={task.title}\n                onClick={() => onTaskClick(task.id)}\n                subtasksCount={task.children?.length || 0}\n                level={level}\n                priority={task.priority}\n                assignees={task.assignees}\n                links={task.links ? JSON.parse(task.links) : []}\n                checklist={task.checklist ? JSON.parse(task.checklist) : []}\n                cardColor={cardColor}\n                progress={task.progress} // Pass progress\n                onProgressChange={onProgressChange}\n                isCollapsed={collapsedTasks.has(task.id)}\n                onToggleCollapse={onToggleCollapse}\n                isHidden={hiddenTasks.has(task.id)}\n                onToggleHide={onToggleHide}\n              />\n            );\n          })}\n        </SortableContext>\n      </div>\n    </section>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 975, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n        shiny:\n          \"bg-gradient-to-r from-primary to-primary/80 text-primary-foreground shadow-md hover:shadow-lg transition-shadow\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-lg px-3\",\n        lg: \"h-11 rounded-lg px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,uRACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;YACN,OACE;QACJ;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,2KAAgB,MAC7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAC9B,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 1043, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/FileUploader.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useCallback } from \"react\";\nimport { Upload, X, File, Image as ImageIcon } from \"lucide-react\";\n\ninterface FileUploaderProps {\n    projectId: string;\n    taskId: string;\n    onUploadComplete: (fileData: {\n        url: string;\n        name: string;\n        size: number;\n        type: string;\n        uploadedAt: string;\n    }) => void;\n}\n\nexport function FileUploader({ projectId, taskId, onUploadComplete }: FileUploaderProps) {\n    const [isDragging, setIsDragging] = useState(false);\n    const [isUploading, setIsUploading] = useState(false);\n    const [uploadProgress, setUploadProgress] = useState(0);\n    const [error, setError] = useState<string | null>(null);\n\n    const handleDragOver = useCallback((e: React.DragEvent) => {\n        e.preventDefault();\n        setIsDragging(true);\n    }, []);\n\n    const handleDragLeave = useCallback((e: React.DragEvent) => {\n        e.preventDefault();\n        setIsDragging(false);\n    }, []);\n\n    const uploadFile = async (file: File) => {\n        setIsUploading(true);\n        setError(null);\n        setUploadProgress(0);\n\n        try {\n            const formData = new FormData();\n            formData.append(\"file\", file);\n            formData.append(\"projectId\", projectId);\n            formData.append(\"taskId\", taskId);\n\n            // Simulate progress (since we can't track real progress easily with fetch)\n            const progressInterval = setInterval(() => {\n                setUploadProgress((prev) => Math.min(prev + 10, 90));\n            }, 200);\n\n            const response = await fetch(\"/api/upload\", {\n                method: \"POST\",\n                body: formData,\n            });\n\n            clearInterval(progressInterval);\n            setUploadProgress(100);\n\n            if (!response.ok) {\n                const errorData = await response.json();\n                throw new Error(errorData.message || \"Upload failed\");\n            }\n\n            const fileData = await response.json();\n            onUploadComplete(fileData);\n\n            // Reset after success\n            setTimeout(() => {\n                setIsUploading(false);\n                setUploadProgress(0);\n            }, 500);\n        } catch (err) {\n            console.error(\"Upload error:\", err);\n            setError(err instanceof Error ? err.message : \"Upload failed\");\n            setIsUploading(false);\n            setUploadProgress(0);\n        }\n    };\n\n    const handleDrop = useCallback(\n        async (e: React.DragEvent) => {\n            e.preventDefault();\n            setIsDragging(false);\n\n            const files = Array.from(e.dataTransfer.files);\n            if (files.length > 0) {\n                await uploadFile(files[0]);\n            }\n        },\n        [projectId, taskId]\n    );\n\n    const handleFileSelect = useCallback(\n        async (e: React.ChangeEvent<HTMLInputElement>) => {\n            const files = e.target.files;\n            if (files && files.length > 0) {\n                await uploadFile(files[0]);\n            }\n            // Reset input\n            e.target.value = \"\";\n        },\n        [projectId, taskId]\n    );\n\n    return (\n        <div className=\"w-full\">\n            <div\n                onDragOver={handleDragOver}\n                onDragLeave={handleDragLeave}\n                onDrop={handleDrop}\n                className={`\n          border-2 border-dashed rounded-lg p-6 text-center transition-colors\n          ${isDragging ? \"border-blue-500 bg-blue-50\" : \"border-gray-300 bg-gray-50\"}\n          ${isUploading ? \"opacity-50 pointer-events-none\" : \"cursor-pointer hover:border-blue-400\"}\n        `}\n            >\n                <input\n                    type=\"file\"\n                    id=\"file-upload\"\n                    className=\"hidden\"\n                    onChange={handleFileSelect}\n                    disabled={isUploading}\n                />\n\n                {isUploading ? (\n                    <div className=\"space-y-3\">\n                        <Upload className=\"w-8 h-8 mx-auto text-blue-500 animate-bounce\" />\n                        <p className=\"text-sm text-gray-600\">Subiendo archivo...</p>\n                        <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                            <div\n                                className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\n                                style={{ width: `${uploadProgress}%` }}\n                            />\n                        </div>\n                        <p className=\"text-xs text-gray-500\">{uploadProgress}%</p>\n                    </div>\n                ) : (\n                    <label htmlFor=\"file-upload\" className=\"cursor-pointer\">\n                        <Upload className=\"w-8 h-8 mx-auto text-gray-400 mb-2\" />\n                        <p className=\"text-sm text-gray-600 mb-1\">\n                            Arrastra un archivo aquí o haz clic para seleccionar\n                        </p>\n                        <p className=\"text-xs text-gray-400\">\n                            Máximo 50MB • Imágenes, videos, PDFs, documentos\n                        </p>\n                    </label>\n                )}\n            </div>\n\n            {error && (\n                <div className=\"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2\">\n                    <X className=\"w-4 h-4 text-red-500 mt-0.5 flex-shrink-0\" />\n                    <p className=\"text-sm text-red-600\">{error}</p>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1293, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\n// Optimized for serverless environments (Vercel + Supabase)\nconst prismaClientSingleton = () => {\n  return new PrismaClient({\n    log: process.env.NODE_ENV === 'development' ? ['error', 'warn'] : ['error'],\n    datasources: {\n      db: {\n        url: process.env.DATABASE_URL,\n      },\n    },\n  });\n};\n\ndeclare global {\n  var prisma: undefined | ReturnType<typeof prismaClientSingleton>;\n}\n\nconst prisma = globalThis.prisma ?? prismaClientSingleton();\n\nexport default prisma;\n\nif (process.env.NODE_ENV !== \"production\") globalThis.prisma = prisma;"],"names":[],"mappings":";;;;AAKS;AALT;;AAEA,4DAA4D;AAC5D,MAAM,wBAAwB;IAC5B,OAAO,IAAI,yKAAY,CAAC;QACtB,KAAK,uCAAyC;YAAC;YAAS;SAAO,GAAG;QAClE,aAAa;YACX,IAAI;gBACF,KAAK,2KAAO,CAAC,GAAG,CAAC,YAAY;YAC/B;QACF;IACF;AACF;AAMA,MAAM,SAAS,WAAW,MAAM,IAAI;uCAErB;AAEf,wCAA2C,WAAW,MAAM,GAAG"}},
    {"offset": {"line": 1324, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/lib/permissions.ts"],"sourcesContent":["export const ROLES = {\n    ADMIN: 'ADMIN',\n    PROJECT_MANAGER: 'PROJECT_MANAGER',\n    ARTIST: 'ARTIST',\n    VIEWER: 'VIEWER',\n} as const;\n\nexport type Role = keyof typeof ROLES;\n\nexport const PERMISSIONS = {\n    // Workspace\n    MANAGE_WORKSPACE: ['ADMIN'],\n    CREATE_PROJECT: ['ADMIN', 'PROJECT_MANAGER'],\n    DELETE_PROJECT: ['ADMIN'],\n\n    // Project\n    MANAGE_PROJECT: ['ADMIN', 'PROJECT_MANAGER'],\n    VIEW_PROJECT: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST', 'VIEWER'],\n    MANAGE_ROLES: ['ADMIN', 'PROJECT_MANAGER'],\n\n    // Tasks\n    CREATE_TASK: ['ADMIN', 'PROJECT_MANAGER'],\n    EDIT_ANY_TASK: ['ADMIN', 'PROJECT_MANAGER'],\n    EDIT_OWN_TASK: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'],\n    MOVE_OWN_TASK: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'], // Artists can move their own tasks\n    DELETE_TASK: ['ADMIN', 'PROJECT_MANAGER'],\n    ASSIGN_TASK: ['ADMIN', 'PROJECT_MANAGER'],\n\n    // Comments\n    ADD_COMMENT: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'],\n    DELETE_ANY_COMMENT: ['ADMIN', 'PROJECT_MANAGER'],\n    DELETE_OWN_COMMENT: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'],\n\n    // Files\n    UPLOAD_FILE: ['ADMIN', 'PROJECT_MANAGER', 'ARTIST'],\n    DELETE_FILE: ['ADMIN', 'PROJECT_MANAGER'],\n} as const;\n\nexport function hasPermission(userRole: string, allowedRoles: readonly string[]): boolean {\n    return allowedRoles.includes(userRole);\n}\n\nimport prisma from \"@/lib/prisma\";\n\nexport async function getUserRoleInProject(userId: string, projectId: string): Promise<string> {\n    // 1. Check direct project role\n    const projectUser = await prisma.projectUser.findUnique({\n        where: {\n            projectId_userId: {\n                projectId,\n                userId,\n            },\n        },\n    });\n\n    if (projectUser) return projectUser.role;\n\n    // 2. Check workspace role (if implemented, workspace admins might have access to all projects)\n    // For now, we'll assume project-level roles are primary. \n    // But we should check if the user is a workspace admin.\n\n    const project = await prisma.project.findUnique({\n        where: { id: projectId },\n        select: { workspaceId: true },\n    });\n\n    if (project) {\n        const workspaceUser = await prisma.workspaceUser.findUnique({\n            where: {\n                workspaceId_userId: {\n                    workspaceId: project.workspaceId,\n                    userId,\n                },\n            },\n        });\n\n        if (workspaceUser && workspaceUser.role === ROLES.ADMIN) {\n            return ROLES.ADMIN;\n        }\n    }\n\n    // Default fallback (e.g., if user is owner of project)\n    const projectOwner = await prisma.project.findUnique({\n        where: { id: projectId },\n        select: { ownerId: true },\n    });\n\n    if (projectOwner && projectOwner.ownerId === userId) {\n        return ROLES.ADMIN;\n    }\n\n    return ROLES.VIEWER; // Default role if found but no specific role assigned? Or maybe null?\n    // For safety, let's return a restricted role or handle \"not found\"\n}\n"],"names":[],"mappings":";;;;;;;;;;AA0CA;AA1CO,MAAM,QAAQ;IACjB,OAAO;IACP,iBAAiB;IACjB,QAAQ;IACR,QAAQ;AACZ;AAIO,MAAM,cAAc;IACvB,YAAY;IACZ,kBAAkB;QAAC;KAAQ;IAC3B,gBAAgB;QAAC;QAAS;KAAkB;IAC5C,gBAAgB;QAAC;KAAQ;IAEzB,UAAU;IACV,gBAAgB;QAAC;QAAS;KAAkB;IAC5C,cAAc;QAAC;QAAS;QAAmB;QAAU;KAAS;IAC9D,cAAc;QAAC;QAAS;KAAkB;IAE1C,QAAQ;IACR,aAAa;QAAC;QAAS;KAAkB;IACzC,eAAe;QAAC;QAAS;KAAkB;IAC3C,eAAe;QAAC;QAAS;QAAmB;KAAS;IACrD,eAAe;QAAC;QAAS;QAAmB;KAAS;IACrD,aAAa;QAAC;QAAS;KAAkB;IACzC,aAAa;QAAC;QAAS;KAAkB;IAEzC,WAAW;IACX,aAAa;QAAC;QAAS;QAAmB;KAAS;IACnD,oBAAoB;QAAC;QAAS;KAAkB;IAChD,oBAAoB;QAAC;QAAS;QAAmB;KAAS;IAE1D,QAAQ;IACR,aAAa;QAAC;QAAS;QAAmB;KAAS;IACnD,aAAa;QAAC;QAAS;KAAkB;AAC7C;AAEO,SAAS,cAAc,QAAgB,EAAE,YAA+B;IAC3E,OAAO,aAAa,QAAQ,CAAC;AACjC;;AAIO,eAAe,qBAAqB,MAAc,EAAE,SAAiB;IACxE,+BAA+B;IAC/B,MAAM,cAAc,MAAM,kIAAM,CAAC,WAAW,CAAC,UAAU,CAAC;QACpD,OAAO;YACH,kBAAkB;gBACd;gBACA;YACJ;QACJ;IACJ;IAEA,IAAI,aAAa,OAAO,YAAY,IAAI;IAExC,+FAA+F;IAC/F,0DAA0D;IAC1D,wDAAwD;IAExD,MAAM,UAAU,MAAM,kIAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAC5C,OAAO;YAAE,IAAI;QAAU;QACvB,QAAQ;YAAE,aAAa;QAAK;IAChC;IAEA,IAAI,SAAS;QACT,MAAM,gBAAgB,MAAM,kIAAM,CAAC,aAAa,CAAC,UAAU,CAAC;YACxD,OAAO;gBACH,oBAAoB;oBAChB,aAAa,QAAQ,WAAW;oBAChC;gBACJ;YACJ;QACJ;QAEA,IAAI,iBAAiB,cAAc,IAAI,KAAK,MAAM,KAAK,EAAE;YACrD,OAAO,MAAM,KAAK;QACtB;IACJ;IAEA,uDAAuD;IACvD,MAAM,eAAe,MAAM,kIAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QACjD,OAAO;YAAE,IAAI;QAAU;QACvB,QAAQ;YAAE,SAAS;QAAK;IAC5B;IAEA,IAAI,gBAAgB,aAAa,OAAO,KAAK,QAAQ;QACjD,OAAO,MAAM,KAAK;IACtB;IAEA,OAAO,MAAM,MAAM,EAAE,sEAAsE;AAC3F,mEAAmE;AACvE"}},
    {"offset": {"line": 1482, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/hooks/usePermissions.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport { hasPermission, ROLES } from \"@/lib/permissions\";\n\nexport function usePermissions(projectId: string) {\n    const { data: session } = useSession();\n    const [userRole, setUserRole] = useState<string | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n\n    useEffect(() => {\n        if (!projectId || !session?.user) return;\n\n        setIsLoading(true);\n        fetch(`/api/projects/${projectId}/role`)\n            .then((res) => res.json())\n            .then((data) => {\n                setUserRole(data.role);\n                setIsLoading(false);\n            })\n            .catch((err) => {\n                console.error(\"Error fetching user role:\", err);\n                setIsLoading(false);\n            });\n    }, [projectId, session]);\n\n    const can = (permission: readonly string[]) => {\n        if (!userRole) return false;\n        return hasPermission(userRole, permission);\n    };\n\n    const isOwner = (userId: string) => {\n        return session?.user?.id === userId;\n    };\n\n    return {\n        userRole,\n        can,\n        isLoading,\n        isAdmin: userRole === ROLES.ADMIN,\n        isProjectManager: userRole === ROLES.PROJECT_MANAGER,\n        isArtist: userRole === ROLES.ARTIST,\n        isViewer: userRole === ROLES.VIEWER\n    };\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;AAEO,SAAS,eAAe,SAAiB;;IAC5C,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,IAAA,+JAAU;IACpC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAgB;IACxD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,IAAA,0KAAS;oCAAC;YACN,IAAI,CAAC,aAAa,CAAC,SAAS,MAAM;YAElC,aAAa;YACb,MAAM,CAAC,cAAc,EAAE,UAAU,KAAK,CAAC,EAClC,IAAI;4CAAC,CAAC,MAAQ,IAAI,IAAI;2CACtB,IAAI;4CAAC,CAAC;oBACH,YAAY,KAAK,IAAI;oBACrB,aAAa;gBACjB;2CACC,KAAK;4CAAC,CAAC;oBACJ,QAAQ,KAAK,CAAC,6BAA6B;oBAC3C,aAAa;gBACjB;;QACR;mCAAG;QAAC;QAAW;KAAQ;IAEvB,MAAM,MAAM,CAAC;QACT,IAAI,CAAC,UAAU,OAAO;QACtB,OAAO,IAAA,6IAAa,EAAC,UAAU;IACnC;IAEA,MAAM,UAAU,CAAC;QACb,OAAO,SAAS,MAAM,OAAO;IACjC;IAEA,OAAO;QACH;QACA;QACA;QACA,SAAS,aAAa,qIAAK,CAAC,KAAK;QACjC,kBAAkB,aAAa,qIAAK,CAAC,eAAe;QACpD,UAAU,aAAa,qIAAK,CAAC,MAAM;QACnC,UAAU,aAAa,qIAAK,CAAC,MAAM;IACvC;AACJ;GAvCgB;;QACc,+JAAU"}},
    {"offset": {"line": 1549, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/TaskDetailModal.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { X, File, Download, Trash2, Eye, EyeOff } from \"lucide-react\";\nimport { createPortal } from \"react-dom\";\nimport { useRouter } from \"next/navigation\";\nimport { FileUploader } from \"./FileUploader\";\nimport { usePermissions } from \"@/hooks/usePermissions\";\nimport { PERMISSIONS } from \"@/lib/permissions\";\nimport { useSession } from \"next-auth/react\";\n\n// Recursive type for subtasks\ntype Subtask = {\n  id: string;\n  title: string;\n  description?: string;\n  children?: Subtask[];\n  isHiddenInGantt?: boolean;\n  progress?: number; // Add progress\n};\n\ninterface TaskDetailModalProps {\n  task: {\n    id: string;\n    title: string;\n    description?: string;\n    projectId: string;\n    columnId: string;\n    parentId?: string | null;\n    children?: Subtask[];\n    startDate?: string | null;\n    endDate?: string | null;\n    toleranceDate?: string | null;\n    priority?: string | null;\n    tags?: string | null;\n    links?: string | null;\n    checklist?: string | null;\n    attachments?: string | null;\n    images?: string | null;\n    assignees?: { id: string; name: string | null; email: string | null; image: string | null }[];\n    color?: string; // optional custom color\n    isHiddenInGantt?: boolean;\n    progress?: number; // Add progress\n    isArchived?: boolean;\n  } | null;\n  onClose: () => void;\n  onTaskUpdate: () => void;\n  availableUsers: { id: string; name: string | null; email: string | null; image: string | null }[];\n}\n\nexport function TaskDetailModal({ task, onClose, onTaskUpdate, availableUsers }: TaskDetailModalProps) {\n  // ... existing state ...\n  const [selectedAssignees, setSelectedAssignees] = useState<string[]>(\n    task?.assignees?.map(a => a.id) || []\n  );\n  // Color state for custom task color\n  const [taskColor, setTaskColor] = useState<string>(task?.color || '#ffffff');\n  const [isHidden, setIsHidden] = useState(task?.isHiddenInGantt || false);\n\n  const handleToggleGanttVisibility = async () => {\n    if (!task) return;\n    const newHiddenState = !isHidden;\n    setIsHidden(newHiddenState); // Optimistic update\n\n    try {\n      const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ isHiddenInGantt: newHiddenState }),\n      });\n      if (response.ok) {\n        onTaskUpdate();\n      } else {\n        setIsHidden(!newHiddenState); // Revert on failure\n        alert(\"Failed to update Gantt visibility.\");\n      }\n    } catch (error) {\n      setIsHidden(!newHiddenState); // Revert on error\n      console.error(\"Error updating Gantt visibility:\", error);\n    }\n  };\n\n  const handleAddAssignee = async (userId: string) => {\n    if (!userId || selectedAssignees.includes(userId)) return;\n    const newAssignees = [...selectedAssignees, userId];\n    setSelectedAssignees(newAssignees);\n    try {\n      await fetch(`/api/projects/${task?.projectId}/tasks/${task?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ assignees: newAssignees }),\n      });\n      onTaskUpdate();\n    } catch (error) {\n      console.error(\"Error adding assignee:\", error);\n    }\n  };\n\n  // Handle color change\n  const handleColorChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newColor = e.target.value;\n    setTaskColor(newColor);\n    try {\n      await fetch(`/api/projects/${task?.projectId}/tasks/${task?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ color: newColor }),\n      });\n      onTaskUpdate();\n    } catch (error) {\n      console.error(\"Error updating task color:\", error);\n    }\n  };\n\n  const handleRemoveAssignee = async (userId: string) => {\n    const newAssignees = selectedAssignees.filter(id => id !== userId);\n    setSelectedAssignees(newAssignees);\n    try {\n      await fetch(`/api/projects/${task?.projectId}/tasks/${task?.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ assignees: newAssignees }),\n      });\n      onTaskUpdate();\n    } catch (error) {\n      console.error(\"Error removing assignee:\", error);\n    }\n  };\n\n  const handleToggleSubtaskGanttVisibility = async (subtaskId: string, currentHiddenState: boolean) => {\n    if (!task) return;\n    const newHiddenState = !currentHiddenState;\n\n    try {\n      const response = await fetch(`/api/projects/${task.projectId}/tasks/${subtaskId}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ isHiddenInGantt: newHiddenState }),\n      });\n      if (response.ok) {\n        onTaskUpdate(); // Refresh data\n      } else {\n        alert(\"Failed to update subtask Gantt visibility.\");\n      }\n    } catch (error) {\n      console.error(\"Error updating subtask Gantt visibility:\", error);\n      alert(\"An error occurred while updating subtask Gantt visibility.\");\n    }\n  };\n\n\n  // ... rest of the component ...\n  const [mounted, setMounted] = useState(false);\n  const modalRef = useRef<HTMLDivElement>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const [subtaskTitle, setSubtaskTitle] = useState(\"\");\n  const [isAddingSubtask, setIsAddingSubtask] = useState(false);\n  const router = useRouter();\n  const { data: session } = useSession();\n\n  // Permissions\n  const { can } = usePermissions(task?.projectId || \"\");\n  const isOwnTask = task?.assignees?.some(a => a.id === session?.user?.id) || false;\n\n  const canEdit = can(PERMISSIONS.EDIT_ANY_TASK) || (isOwnTask && can(PERMISSIONS.EDIT_OWN_TASK));\n  const canDelete = can(PERMISSIONS.DELETE_TASK);\n  const canAssign = can(PERMISSIONS.ASSIGN_TASK);\n\n  // Rich fields state\n  const [priority, setPriority] = useState<string>(task?.priority || \"MEDIUM\");\n  const [startDate, setStartDate] = useState<string | null>(task?.startDate || null);\n  const [endDate, setEndDate] = useState<string | null>(task?.endDate || null);\n  const [toleranceDate, setToleranceDate] = useState<string | null>(task?.toleranceDate || null);\n  const [tags, setTags] = useState<{ name: string, color: string }[]>(\n    task?.tags ? JSON.parse(task.tags) : []\n  );\n  const [links, setLinks] = useState<{ title: string, url: string }[]>(\n    task?.links ? JSON.parse(task.links) : []\n  );\n  // Color state UI\n  const [colorInput, setColorInput] = useState<string>(task?.color || '#ffffff');\n  const [checklist, setChecklist] = useState<{ id: string, text: string, completed: boolean }[]>(\n    task?.checklist ? JSON.parse(task.checklist) : []\n  );\n  const [attachments, setAttachments] = useState<{ url: string, name: string, size: number, type: string, uploadedAt: string }[]>(\n    task?.attachments ? JSON.parse(task.attachments) : []\n  );\n  const [newTagName, setNewTagName] = useState(\"\");\n  const [newLinkTitle, setNewLinkTitle] = useState(\"\");\n  const [newLinkUrl, setNewLinkUrl] = useState(\"\");\n  const [newChecklistItem, setNewChecklistItem] = useState(\"\");\n\n  // User assignment state\n  // availableUsers is now passed as a prop\n  // selectedAssignees is initialized at the top\n  // Color picker UI will be rendered below\n\n\n  // Sync selectedAssignees when task.assignees changes\n  useEffect(() => {\n    if (task?.assignees) {\n      setSelectedAssignees(task.assignees.map(a => a.id));\n    }\n  }, [task?.assignees]);\n\n  useEffect(() => {\n    setMounted(true);\n    // Set initial centered position\n    if (typeof window !== 'undefined') {\n      setPosition({\n        x: (window.innerWidth - 560) / 2,\n        y: (window.innerHeight - 600) / 2  // Center vertically (assuming ~600px modal height)\n      });\n    }\n    return () => setMounted(false);\n  }, []);\n\n  // The handleMouseDown, handleMouseMove, handleMouseUp, and their useEffect\n  // have been updated to reflect the new dragging logic using dragStart\n  const handleMouseDown = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    setIsDragging(true);\n\n    // Calculate offset based on current state position\n    setDragStart({\n      x: e.clientX - position.x,\n      y: e.clientY - position.y\n    });\n  }, [position]);\n\n  const handleMouseMove = useCallback((e: MouseEvent) => {\n    if (isDragging) {\n      setPosition({\n        x: e.clientX - dragStart.x,\n        y: e.clientY - dragStart.y,\n      });\n    }\n  }, [isDragging, dragStart]);\n\n  const handleMouseUp = useCallback(() => {\n    setIsDragging(false);\n  }, []);\n\n  useEffect(() => {\n    if (isDragging) {\n      window.addEventListener('mousemove', handleMouseMove);\n      window.addEventListener('mouseup', handleMouseUp);\n    } else {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('mouseup', handleMouseUp);\n    }\n    return () => {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isDragging, handleMouseMove, handleMouseUp]);\n\n  // Fetch available users for assignment\n\n\n  const handleDuplicateTask = async () => {\n    if (!task) return;\n\n    if (!confirm(\"¿Duplicar esta tarea y todas sus subtareas?\")) return;\n\n    try {\n      const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}/duplicate`, {\n        method: \"POST\",\n      });\n\n      if (response.ok) {\n        onTaskUpdate();\n        onClose();\n      } else {\n        alert(\"Error al duplicar la tarea\");\n      }\n    } catch (error) {\n      console.error(\"Error duplicating task:\", error);\n      alert(\"Error al duplicar la tarea\");\n    }\n  };\n\n  const handleArchiveTask = async () => {\n    if (!task) return;\n\n    const action = task.isArchived ? \"restaurar\" : \"archivar\";\n    if (!confirm(`¿${action.charAt(0).toUpperCase() + action.slice(1)} esta tarea?`)) return;\n\n    try {\n      const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ isArchived: !task.isArchived }),\n      });\n\n      if (response.ok) {\n        onTaskUpdate();\n        onClose();\n      } else {\n        alert(`Error al ${action} la tarea`);\n      }\n    } catch (error) {\n      console.error(`Error ${action}ing task:`, error);\n      alert(`Error al ${action} la tarea`);\n    }\n  };\n\n  const handleAddSubtask = async () => {\n    if (!subtaskTitle.trim() || !task) return;\n\n    setIsAddingSubtask(true);\n    try {\n      const response = await fetch(`/api/projects/${task.projectId}/tasks`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          title: subtaskTitle,\n          columnId: task.columnId,\n          parentId: task.id,\n          // Inherit dates from parent task\n          startDate: task.startDate,\n          endDate: task.endDate,\n          toleranceDate: task.toleranceDate,\n        }),\n      });\n\n      if (response.ok) {\n        setSubtaskTitle(\"\");\n        onTaskUpdate(); // Refresh data via parent callback\n      } else {\n        console.error(\"Failed to create subtask\");\n      }\n    } catch (error) {\n      console.error(\"Error creating subtask:\", error);\n    } finally {\n      setIsAddingSubtask(false);\n    }\n  };\n\n  if (!task || !mounted) return null;\n\n  return createPortal(\n    <div\n      className=\"fixed inset-0 bg-black/35 backdrop-blur-sm z-50\"\n      onClick={onClose}\n    >\n      <div\n        ref={modalRef}\n        className=\"task-detail-modal\"\n        style={{\n          position: 'fixed',\n          left: position.x,\n          top: position.y,\n          cursor: isDragging ? 'grabbing' : 'grab',\n          minWidth: '320px',\n          maxWidth: '560px',\n        }}\n        onMouseDown={handleMouseDown}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className=\"modal-header flex justify-between items-center pb-4 border-b border-gray-200 mb-6 cursor-move -mt-[10px]\">\n          <h2 className=\"text-2xl font-bold text-[#0F172A]\">{task.title}</h2>\n          <div className=\"flex items-center gap-2\">\n            {/* Duplicate button - only for admins/managers */}\n            {can(PERMISSIONS.MANAGE_PROJECT) && (\n              <>\n                <button\n                  onClick={handleDuplicateTask}\n                  className=\"px-3 py-1.5 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors\"\n                  title=\"Duplicar tarea\"\n                >\n                  Duplicar\n                </button>\n                <button\n                  onClick={handleArchiveTask}\n                  className={`px-3 py-1.5 text-sm rounded-lg transition-colors ${task.isArchived\n                    ? \"bg-green-100 text-green-700 hover:bg-green-200\"\n                    : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\n                    }`}\n                  title={task.isArchived ? \"Restaurar tarea\" : \"Archivar tarea\"}\n                >\n                  {task.isArchived ? \"Restaurar\" : \"Archivar\"}\n                </button>\n              </>\n            )}\n            <button\n              onClick={onClose}\n              className=\"modal-close-btn\"\n            >\n              <X size={16} stroke=\"white\" fill=\"white\" />\n            </button>\n          </div>\n        </div>\n        <div className=\"modal-body overflow-y-auto max-h-[60vh] space-y-6 mt-[5px]\">\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2\">Descripción</h3>\n            <textarea\n              className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 min-h-[100px] text-gray-700 leading-relaxed resize-y\"\n              placeholder=\"Agrega una descripción para esta tarea...\"\n              defaultValue={task.description || \"\"}\n              onBlur={async (e) => {\n                const newDescription = e.target.value;\n                if (newDescription !== task.description) {\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ description: newDescription }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error updating description:\", error);\n                  }\n                }\n              }}\n              disabled={!canEdit}\n            />\n          </div>\n\n          {/* Date Fields Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Fechas</h3>\n            <div className=\"grid grid-cols-1 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de inicio</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={startDate ? new Date(startDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    const previousDate = startDate;\n\n                    // Optimistic update\n                    setStartDate(newDate);\n\n                    try {\n                      const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ startDate: newDate }),\n                      });\n                      if (response.ok) {\n                        onTaskUpdate();\n                      } else {\n                        // Revert on failure\n                        setStartDate(previousDate);\n                      }\n                    } catch (error) {\n                      // Revert on error\n                      setStartDate(previousDate);\n                      console.error(\"Error updating start date:\", error);\n                    }\n                  }}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de finalización</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={endDate ? new Date(endDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    const previousDate = endDate;\n\n                    // Optimistic update\n                    setEndDate(newDate);\n\n                    try {\n                      const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ endDate: newDate }),\n                      });\n                      if (response.ok) {\n                        onTaskUpdate();\n                      } else {\n                        // Revert on failure\n                        setEndDate(previousDate);\n                      }\n                    } catch (error) {\n                      // Revert on error\n                      setEndDate(previousDate);\n                      console.error(\"Error updating end date:\", error);\n                    }\n                  }}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de tolerancia</label>\n                <input\n                  type=\"date\"\n                  className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB]\"\n                  value={task.toleranceDate ? new Date(task.toleranceDate).toISOString().split('T')[0] : ''}\n                  onChange={async (e) => {\n                    const newDate = e.target.value || null;\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ toleranceDate: newDate }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error updating tolerance date:\", error);\n                    }\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Priority Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Prioridad</h3>\n            <div className=\"flex flex-wrap gap-2\">\n              <button\n                onClick={async () => {\n                  setPriority(\"LOW\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ priority: \"LOW\" }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error updating priority:\", error);\n                  }\n                }}\n                className={`px-4 py-2 rounded-lg font-medium transition-all ${priority === \"LOW\"\n                  ? \"bg-blue-500 text-white shadow-md scale-105\"\n                  : \"bg-blue-100 text-blue-700 hover:bg-blue-200\"\n                  }`}\n                disabled={!canEdit}\n              >\n                Baja\n              </button>\n              <button\n                onClick={async () => {\n                  setPriority(\"MEDIUM\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ priority: \"MEDIUM\" }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error updating priority:\", error);\n                  }\n                }}\n                className={`px-4 py-2 rounded-lg font-medium transition-all ${priority === \"MEDIUM\"\n                  ? \"bg-yellow-500 text-white shadow-md scale-105\"\n                  : \"bg-yellow-100 text-yellow-700 hover:bg-yellow-200\"\n                  }`}\n                disabled={!canEdit}\n              >\n                Media\n              </button>\n              <button\n                onClick={async () => {\n                  setPriority(\"HIGH\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ priority: \"HIGH\" }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error updating priority:\", error);\n                  }\n                }}\n                className={`px-4 py-2 rounded-lg font-medium transition-all ${priority === \"HIGH\"\n                  ? \"bg-red-500 text-white shadow-md scale-105\"\n                  : \"bg-red-100 text-red-700 hover:bg-red-200\"\n                  }`}\n                disabled={!canEdit}\n              >\n                Alta\n              </button>\n              <button\n                onClick={async () => {\n                  setPriority(\"URGENT\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ priority: \"URGENT\" }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error updating priority:\", error);\n                  }\n                }}\n                className={`px-4 py-2 rounded-lg font-medium transition-all ${priority === \"URGENT\"\n                  ? \"bg-red-700 text-white shadow-md scale-105\"\n                  : \"bg-red-200 text-red-800 hover:bg-red-300\"\n                  }`}\n                disabled={!canEdit}\n              >\n                Urgente\n              </button>\n            </div>\n          </div>\n\n          {/* Gantt Visibility Section */}\n          <div className=\"pt-5\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Visibilidad en Gantt</h3>\n            <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n              <label htmlFor=\"gantt-toggle\" className=\"text-sm font-medium text-gray-700\">\n                {isHidden ? \"Oculta en el diagrama de Gantt\" : \"Visible en el diagrama de Gantt\"}\n              </label>\n              <button\n                id=\"gantt-toggle\"\n                onClick={handleToggleGanttVisibility}\n                className={`relative inline - flex items - center h - 6 rounded - full w - 11 transition - colors ${isHidden ? 'bg-gray-300' : 'bg-blue-500'\n                  } `}\n                disabled={!canEdit}\n              >\n                <span\n                  className={`inline - block w - 4 h - 4 transform bg - white rounded - full transition - transform ${isHidden ? 'translate-x-1' : 'translate-x-6'\n                    } `}\n                />\n              </button>\n            </div>\n          </div>\n\n          {/* User Assignment Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Asignado a</h3>\n            <div className=\"flex flex-wrap gap-2 mb-3\">\n              {selectedAssignees.map((assigneeId) => {\n                const assignee = availableUsers.find(u => u.id === assigneeId) ||\n                  task?.assignees?.find(a => a.id === assigneeId);\n                if (!assignee) return null;\n\n                return (\n                  <div\n                    key={assignee.id}\n                    className=\"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-full\"\n                  >\n                    {assignee.image ? (\n                      <img\n                        src={assignee.image}\n                        alt={assignee.name || assignee.email || \"User\"}\n                        className=\"w-6 h-6 rounded-full\"\n                      />\n                    ) : (\n                      <div className=\"w-6 h-6 rounded-full bg-blue-200 flex items-center justify-center text-xs font-medium text-neutral-900\">\n                        {(assignee.name || assignee.email || \"?\")[0].toUpperCase()}\n                      </div>\n                    )}\n                    <span className=\"text-sm text-gray-700\">{assignee.name || assignee.email}</span>\n                    {canAssign && (\n                      <button\n                        className=\"text-gray-600 hover:text-red-600 ml-1\"\n                        onClick={async () => {\n                          const newAssignees = selectedAssignees.filter(id => id !== assignee.id);\n                          setSelectedAssignees(newAssignees);\n                          try {\n                            await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                              method: \"PUT\",\n                              headers: { \"Content-Type\": \"application/json\" },\n                              body: JSON.stringify({ assignees: newAssignees }),\n                            });\n                            onTaskUpdate();\n                          } catch (error) {\n                            console.error(\"Error removing assignee:\", error);\n                          }\n                        }}\n                      >\n                        ×\n                      </button>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n            <select\n              className=\"w-full p-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-600\"\n              onChange={(e) => {\n                if (e.target.value) {\n                  handleAddAssignee(e.target.value);\n                  e.target.value = \"\";\n                }\n              }}\n              disabled={!canAssign}\n            >\n              <option value=\"\">Agregar usuario...</option>\n              {availableUsers\n                .filter(user => !selectedAssignees.includes(user.id))\n                .map(user => (\n                  <option key={user.id} value={user.id}>\n                    {user.name || user.email}\n                  </option>\n                ))}\n            </select>\n          </div>\n\n          {/* Tags Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Etiquetas</h3>\n            <p className=\"text-xs text-gray-500 mb-3\">Separa múltiples etiquetas con comas o presiona Enter para agregar</p>\n            <div className=\"flex flex-wrap gap-2 mb-3\">\n              {tags.map((tag, index) => (\n                <span\n                  key={index}\n                  className=\"px-3 py-1 rounded-full text-sm font-medium\"\n                  style={{ backgroundColor: tag.color || '#E0E7FF', color: '#1E293B' }}\n                >\n                  {tag.name}\n                  {canEdit && (\n                    <button\n                      className=\"ml-2 text-gray-600 hover:text-red-600\"\n                      onClick={async () => {\n                        const newTags = tags.filter((_, i) => i !== index);\n                        setTags(newTags);\n                        try {\n                          await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                            method: \"PUT\",\n                            headers: { \"Content-Type\": \"application/json\" },\n                            body: JSON.stringify({ tags: newTags }),\n                          });\n                          onTaskUpdate();\n                        } catch (error) {\n                          console.error(\"Error removing tag:\", error);\n                        }\n                      }}\n                    >\n                      ×\n                    </button>\n                  )}\n                </span>\n              ))}\n            </div>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Ej: diseño, urgente, revisión (separadas por comas)\"\n                className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newTagName}\n                onChange={(e) => setNewTagName(e.target.value)}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && newTagName.trim()) {\n                    const colors = ['#E0E7FF', '#FEF3C7', '#D1FAE5', '#FCE7F3', '#E0F2FE'];\n                    // Split by comma and create multiple tags\n                    const tagNames = newTagName.split(',').map(t => t.trim()).filter(t => t);\n                    const newTags = [...tags, ...tagNames.map((name, idx) => ({\n                      name,\n                      color: colors[(tags.length + idx) % colors.length]\n                    }))];\n                    setTags(newTags);\n                    setNewTagName(\"\");\n                    fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ tags: newTags }),\n                    }).then(() => onTaskUpdate());\n                  }\n                }}\n                disabled={!canEdit}\n              />\n              <button\n                className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                onClick={async () => {\n                  if (!newTagName.trim()) return;\n                  const colors = ['#E0E7FF', '#FEF3C7', '#D1FAE5', '#FCE7F3', '#E0F2FE'];\n                  // Split by comma and create multiple tags\n                  const tagNames = newTagName.split(',').map(t => t.trim()).filter(t => t);\n                  const newTags = [...tags, ...tagNames.map((name, idx) => ({\n                    name,\n                    color: colors[(tags.length + idx) % colors.length]\n                  }))];\n                  setTags(newTags);\n                  setNewTagName(\"\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ tags: newTags }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error adding tag:\", error);\n                  }\n                }}\n                disabled={!canEdit}\n              >\n                Agregar\n              </button>\n            </div>\n          </div>\n\n          {/* Links Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Enlaces</h3>\n            <div className=\"space-y-2 mb-3\">\n              {links.map((link, index) => (\n                <div key={index} className=\"flex items-center justify-between p-2 bg-gray-50 rounded-lg\">\n                  <a\n                    href={link.url}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-blue-600 hover:underline flex-1 truncate\"\n                  >\n                    {link.title || link.url}\n                  </a>\n                  <button\n                    className=\"ml-2 text-gray-600 hover:text-red-600\"\n                    onClick={async () => {\n                      const newLinks = links.filter((_, i) => i !== index);\n                      setLinks(newLinks);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ links: newLinks }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error removing link:\", error);\n                      }\n                    }}\n                  >\n                    ×\n                  </button>\n                </div>\n              ))}\n            </div>\n            <div className=\"space-y-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Título del enlace\"\n                className=\"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newLinkTitle}\n                onChange={(e) => setNewLinkTitle(e.target.value)}\n              />\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"url\"\n                  placeholder=\"https://ejemplo.com\"\n                  className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                  value={newLinkUrl}\n                  onChange={(e) => setNewLinkUrl(e.target.value)}\n                />\n                <button\n                  className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                  onClick={async () => {\n                    if (!newLinkUrl.trim()) return;\n                    const newLink = { title: newLinkTitle.trim() || newLinkUrl, url: newLinkUrl.trim() };\n                    const newLinks = [...links, newLink];\n                    setLinks(newLinks);\n                    setNewLinkTitle(\"\");\n                    setNewLinkUrl(\"\");\n                    try {\n                      await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"PUT\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ links: newLinks }),\n                      });\n                      onTaskUpdate();\n                    } catch (error) {\n                      console.error(\"Error adding link:\", error);\n                    }\n                  }}\n                >\n                  Agregar\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Checklist Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Checklist</h3>\n            <p className=\"text-xs text-gray-500 mb-3\">Agrega items a tu lista de tareas y marca como completados</p>\n            <div className=\"space-y-2 mb-3\">\n              {checklist.map((item) => (\n                <div key={item.id} className=\"flex items-center gap-2\">\n                  <input\n                    type=\"checkbox\"\n                    checked={item.completed}\n                    className=\"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-600\"\n                    onChange={async (e) => {\n                      const newChecklist = checklist.map(i =>\n                        i.id === item.id ? { ...i, completed: e.target.checked } : i\n                      );\n                      setChecklist(newChecklist);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ checklist: newChecklist }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error updating checklist:\", error);\n                      }\n                    }}\n                  />\n                  <span className={`flex - 1 ${item.completed ? 'line-through text-gray-500' : 'text-gray-700'} `}>\n                    {item.text}\n                  </span>\n                  <button\n                    className=\"text-gray-600 hover:text-red-600\"\n                    onClick={async () => {\n                      const newChecklist = checklist.filter(i => i.id !== item.id);\n                      setChecklist(newChecklist);\n                      try {\n                        await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                          method: \"PUT\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ checklist: newChecklist }),\n                        });\n                        onTaskUpdate();\n                      } catch (error) {\n                        console.error(\"Error removing checklist item:\", error);\n                      }\n                    }}\n                  >\n                    ×\n                  </button>\n                </div>\n              ))}\n            </div>\n            <div className=\"flex gap-2\">\n              <input\n                type=\"text\"\n                placeholder=\"Nuevo item\"\n                className=\"flex-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600\"\n                value={newChecklistItem}\n                onChange={(e) => setNewChecklistItem(e.target.value)}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && newChecklistItem.trim()) {\n                    const newItem = { id: Date.now().toString(), text: newChecklistItem.trim(), completed: false };\n                    const newChecklist = [...checklist, newItem];\n                    setChecklist(newChecklist);\n                    setNewChecklistItem(\"\");\n                    fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ checklist: newChecklist }),\n                    }).then(() => onTaskUpdate());\n                  }\n                }}\n              />\n              <button\n                className=\"px-4 py-2 bg-blue-200 text-neutral-900 rounded-lg hover:bg-blue-300 transition-colors font-medium\"\n                onClick={async () => {\n                  if (!newChecklistItem.trim()) return;\n                  const newItem = { id: Date.now().toString(), text: newChecklistItem.trim(), completed: false };\n                  const newChecklist = [...checklist, newItem];\n                  setChecklist(newChecklist);\n                  setNewChecklistItem(\"\");\n                  try {\n                    await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                      method: \"PUT\",\n                      headers: { \"Content-Type\": \"application/json\" },\n                      body: JSON.stringify({ checklist: newChecklist }),\n                    });\n                    onTaskUpdate();\n                  } catch (error) {\n                    console.error(\"Error adding checklist item:\", error);\n                  }\n                }}\n              >\n                Agregar\n              </button>\n            </div>\n          </div>\n\n          {/* Attachments Section */}\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Archivos Adjuntos</h3>\n\n            {/* File List */}\n            {attachments.length > 0 && (\n              <div className=\"space-y-2 mb-4\">\n                {attachments.map((file, index) => (\n                  <div\n                    key={index}\n                    className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200\"\n                  >\n                    <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                      <File className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-medium text-gray-700 truncate\">{file.name}</p>\n                        <p className=\"text-xs text-gray-500\">\n                          {(file.size / 1024 / 1024).toFixed(2)} MB • {new Date(file.uploadedAt).toLocaleDateString()}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <a\n                        href={file.url}\n                        download\n                        className=\"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors\"\n                        title=\"Descargar\"\n                      >\n                        <Download size={16} />\n                      </a>\n                      <button\n                        className=\"p-2 text-red-600 hover:bg-red-50 rounded transition-colors\"\n                        title=\"Eliminar\"\n                        onClick={async () => {\n                          const newAttachments = attachments.filter((_, i) => i !== index);\n                          setAttachments(newAttachments);\n                          try {\n                            await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                              method: \"PUT\",\n                              headers: { \"Content-Type\": \"application/json\" },\n                              body: JSON.stringify({ attachments: newAttachments }),\n                            });\n                            onTaskUpdate();\n                          } catch (error) {\n                            console.error(\"Error removing attachment:\", error);\n                          }\n                        }}\n                      >\n                        <Trash2 size={16} />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {/* File Uploader */}\n            <FileUploader\n              projectId={task.projectId}\n              taskId={task.id}\n              onUploadComplete={async (fileData) => {\n                const newAttachments = [...attachments, fileData];\n                setAttachments(newAttachments);\n                try {\n                  await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                    method: \"PUT\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({ attachments: newAttachments }),\n                  });\n                  onTaskUpdate();\n                } catch (error) {\n                  console.error(\"Error saving attachment:\", error);\n                }\n              }}\n            />\n          </div>\n\n          <div className=\"pt-[5px]\">\n            <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3\">Subtasks</h3>\n\n            {/* Recursive subtask renderer */}\n            {(() => {\n              const renderSubtasks = (subtasks: typeof task.children, depth = 0): React.ReactElement[] => {\n                if (!subtasks || subtasks.length === 0) return [];\n\n                return subtasks.map((subtask) => (\n                  <li key={subtask.id} style={{ marginLeft: `${depth * 16} px` }} className=\"text-gray-700 flex items-start gap-2 leading-relaxed\">\n                    <span className=\"mt-1.5 w-1.5 h-1.5 rounded-full bg-gray-400 flex-shrink-0\" />\n                    <div className=\"flex-1\">\n                      <div className=\"flex justify-between items-center\">\n                        <span>{subtask.title}</span>\n                        <div className=\"flex items-center gap-2\">\n                          {/* Progress Input for Subtask */}\n                          {(!subtask.children || subtask.children.length === 0) && (\n                            <div className=\"flex items-center gap-1\" onClick={(e) => e.stopPropagation()}>\n                              <input\n                                type=\"number\"\n                                min=\"0\"\n                                max=\"100\"\n                                value={subtask.progress || 0}\n                                onChange={async (e) => {\n                                  const newProgress = parseInt(e.target.value);\n                                  if (!isNaN(newProgress) && newProgress >= 0 && newProgress <= 100) {\n                                    try {\n                                      await fetch(`/api/projects/${task.projectId}/tasks/${subtask.id}`, {\n                                        method: \"PUT\",\n                                        headers: { \"Content-Type\": \"application/json\" },\n                                        body: JSON.stringify({ progress: newProgress }),\n                                      });\n                                      onTaskUpdate();\n                                    } catch (error) {\n                                      console.error(\"Error updating subtask progress:\", error);\n                                    }\n                                  }\n                                }}\n                                className=\"w-12 p-1 border border-gray-300 rounded text-xs text-center\"\n                                disabled={!canEdit}\n                              />\n                              <span className=\"text-xs text-gray-500\">%</span>\n                            </div>\n                          )}\n                          {canEdit && ( // Only show toggle if user can edit tasks\n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation(); // Prevent modal from closing\n                                handleToggleSubtaskGanttVisibility(subtask.id, subtask.isHiddenInGantt || false);\n                              }}\n                              className=\"ml-2 text-gray-500 hover:text-blue-600\"\n                              title={subtask.isHiddenInGantt ? \"Mostrar en Gantt\" : \"Ocultar en Gantt\"}\n                            >\n                              {subtask.isHiddenInGantt ? <EyeOff size={16} /> : <Eye size={16} />}\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                      {/* Progress Bar for Subtask */}\n                      <div className=\"w-full bg-gray-200 rounded-full h-1.5 mt-1\">\n                        <div\n                          className=\"bg-blue-500 h-1.5 rounded-full\"\n                          style={{ width: `${subtask.progress || 0}% ` }}\n                        ></div>\n                      </div>\n                    </div>\n                    {subtask.children && subtask.children.length > 0 && (\n                      <ul className=\"space-y-2 mt-2 w-full\">\n                        {renderSubtasks(subtask.children, depth + 1)}\n                      </ul>\n                    )}\n                  </li>\n                ));\n              };\n\n              // Calculate current task depth\n              const calculateDepth = (t: typeof task, allTasks: any[] = []): number => {\n                // This is a simplified depth calculation for the modal\n                // In a real scenario, you'd need to traverse up the parent chain\n                // For now, we'll use a heuristic based on parentId presence\n                let depth = 0;\n                let current = t;\n                // We can't traverse up without fetching parent data, so we'll use a simpler approach\n                // Just count if this task has a parentId (depth 1+)\n                if (current.parentId) depth = 1;\n                // For more accurate depth, we'd need to fetch the full parent chain\n                // For now, we'll allow subtask creation and let the backend handle validation\n                return depth;\n              };\n\n              const currentDepth = calculateDepth(task);\n              const maxDepth = 5;\n              const canAddSubtask = currentDepth < maxDepth;\n\n              return (\n                <>\n                  {task.children && task.children.length > 0 ? (\n                    <ul className=\"space-y-3 mb-4\">\n                      {renderSubtasks(task.children)}\n                    </ul>\n                  ) : (\n                    <p className=\"text-gray-500 italic mb-4\">No subtasks yet.</p>\n                  )}\n\n                  {/* UI to add new subtask */}\n                  <div className=\"flex gap-3 mt-[10px]\">\n                    <input\n                      type=\"text\"\n                      placeholder={canAddSubtask ? \"New subtask title\" : \"Max depth reached (5 levels)\"}\n                      className=\"flex-grow p-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2563EB] transition-shadow\"\n                      value={subtaskTitle}\n                      onChange={(e) => setSubtaskTitle(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter' && canAddSubtask) {\n                          handleAddSubtask();\n                        }\n                      }}\n                      disabled={!canAddSubtask}\n                    />\n                    <button\n                      className=\"btn-primary whitespace-nowrap\"\n                      onClick={handleAddSubtask}\n                      disabled={isAddingSubtask || !subtaskTitle.trim() || !canAddSubtask}\n                    >\n                      {isAddingSubtask ? 'Adding...' : 'Add Subtask'}\n                    </button>\n                  </div>\n                </>\n              );\n            })()}\n          </div>\n\n          {/* Modal Footer with Delete Button */}\n          <div className=\"modal-footer mt-6 pt-4 border-t border-gray-200 flex justify-end\">\n            {canDelete && (\n              <button\n                className=\"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium\"\n                onClick={async () => {\n                  if (confirm(`¿Estás seguro de que quieres eliminar \"${task.title}\" ? ${task.children && task.children.length > 0 ? ' Esto también eliminará todas sus subtareas.' : ''} `)) {\n                    try {\n                      const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                        method: \"DELETE\",\n                      });\n\n                      if (response.ok) {\n                        onClose();\n                        onTaskUpdate(); // Refresh the board\n                      } else {\n                        alert(\"Error al eliminar la tarea\");\n                      }\n                    } catch (error) {\n                      console.error(\"Error deleting task:\", error);\n                      alert(\"Error al eliminar la tarea\");\n                    }\n                  }\n                }}\n              >\n                <Trash2 size={16} className=\"inline-block mr-2\" />\n                Eliminar Tarea\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>,\n    document.body\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3485, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/FilterBuilder.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState } from \"react\";\nimport { X, Plus, Trash2 } from \"lucide-react\";\nimport { createPortal } from \"react-dom\";\n\nexport interface FilterCondition {\n    field: \"assignee\" | \"priority\" | \"tags\" | \"dueDate\" | \"column\" | \"hasAttachments\" | \"checklistStatus\";\n    operator: \"equals\" | \"contains\" | \"before\" | \"after\" | \"isEmpty\" | \"isNotEmpty\";\n    value: string | string[] | Date | boolean;\n}\n\nexport interface FilterCriteria {\n    conditions: FilterCondition[];\n    operator: \"AND\" | \"OR\";\n}\n\ninterface FilterBuilderProps {\n    projectId: string;\n    availableUsers: { id: string; name: string | null; email: string | null }[];\n    availableColumns: { id: string; name: string }[];\n    onClose: () => void;\n    onSave: (name: string, criteria: FilterCriteria) => void;\n}\n\nconst FIELD_OPTIONS = [\n    { value: \"assignee\", label: \"Asignado a\" },\n    { value: \"priority\", label: \"Prioridad\" },\n    { value: \"tags\", label: \"Etiquetas\" },\n    { value: \"dueDate\", label: \"Fecha de vencimiento\" },\n    { value: \"column\", label: \"Columna\" },\n    { value: \"hasAttachments\", label: \"Tiene archivos\" },\n    { value: \"checklistStatus\", label: \"Estado de checklist\" },\n];\n\nconst PRIORITY_OPTIONS = [\n    { value: \"LOW\", label: \"Baja\" },\n    { value: \"MEDIUM\", label: \"Media\" },\n    { value: \"HIGH\", label: \"Alta\" },\n    { value: \"URGENT\", label: \"Urgente\" },\n];\n\nexport function FilterBuilder({\n    projectId,\n    availableUsers,\n    availableColumns,\n    onClose,\n    onSave,\n}: FilterBuilderProps) {\n    const [mounted, setMounted] = useState(false);\n    const [filterName, setFilterName] = useState(\"\");\n    const [operator, setOperator] = useState<\"AND\" | \"OR\">(\"AND\");\n    const [conditions, setConditions] = useState<FilterCondition[]>([\n        { field: \"assignee\", operator: \"equals\", value: \"\" },\n    ]);\n\n    React.useEffect(() => {\n        setMounted(true);\n    }, []);\n\n    const addCondition = () => {\n        setConditions([\n            ...conditions,\n            { field: \"assignee\", operator: \"equals\", value: \"\" },\n        ]);\n    };\n\n    const removeCondition = (index: number) => {\n        setConditions(conditions.filter((_, i) => i !== index));\n    };\n\n    const updateCondition = (index: number, updates: Partial<FilterCondition>) => {\n        const newConditions = [...conditions];\n        newConditions[index] = { ...newConditions[index], ...updates };\n        setConditions(newConditions);\n    };\n\n    const handleSave = () => {\n        if (!filterName.trim()) {\n            alert(\"Por favor ingresa un nombre para el filtro\");\n            return;\n        }\n\n        if (conditions.length === 0) {\n            alert(\"Agrega al menos una condición\");\n            return;\n        }\n\n        onSave(filterName, { conditions, operator });\n        onClose();\n    };\n\n    const renderValueInput = (condition: FilterCondition, index: number) => {\n        switch (condition.field) {\n            case \"assignee\":\n                return (\n                    <select\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    >\n                        <option value=\"\">Seleccionar usuario...</option>\n                        {availableUsers.map((user) => (\n                            <option key={user.id} value={user.id}>\n                                {user.name || user.email}\n                            </option>\n                        ))}\n                    </select>\n                );\n\n            case \"priority\":\n                return (\n                    <select\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    >\n                        <option value=\"\">Seleccionar prioridad...</option>\n                        {PRIORITY_OPTIONS.map((opt) => (\n                            <option key={opt.value} value={opt.value}>\n                                {opt.label}\n                            </option>\n                        ))}\n                    </select>\n                );\n\n            case \"column\":\n                return (\n                    <select\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    >\n                        <option value=\"\">Seleccionar columna...</option>\n                        {availableColumns.map((col) => (\n                            <option key={col.id} value={col.id}>\n                                {col.name}\n                            </option>\n                        ))}\n                    </select>\n                );\n\n            case \"tags\":\n                return (\n                    <input\n                        type=\"text\"\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        placeholder=\"Nombre de etiqueta...\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    />\n                );\n\n            case \"dueDate\":\n                return (\n                    <input\n                        type=\"date\"\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value })}\n                    />\n                );\n\n            case \"hasAttachments\":\n            case \"checklistStatus\":\n                return (\n                    <select\n                        className=\"flex-1 p-2 border border-gray-300 rounded-lg text-sm\"\n                        value={condition.value as string}\n                        onChange={(e) => updateCondition(index, { value: e.target.value === \"true\" })}\n                    >\n                        <option value=\"true\">Sí</option>\n                        <option value=\"false\">No</option>\n                    </select>\n                );\n\n            default:\n                return null;\n        }\n    };\n\n    if (!mounted) return null;\n\n    return createPortal(\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col\">\n                {/* Header */}\n                <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n                    <h2 className=\"text-xl font-semibold text-gray-900\">Crear Filtro Personalizado</h2>\n                    <button\n                        onClick={onClose}\n                        className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n                    >\n                        <X size={20} className=\"text-gray-500\" />\n                    </button>\n                </div>\n\n                {/* Content */}\n                <div className=\"flex-1 overflow-y-auto p-6 space-y-6\">\n                    {/* Filter Name */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Nombre del Filtro\n                        </label>\n                        <input\n                            type=\"text\"\n                            className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            placeholder=\"Ej: Tareas Urgentes Sin Asignar\"\n                            value={filterName}\n                            onChange={(e) => setFilterName(e.target.value)}\n                        />\n                    </div>\n\n                    {/* Operator */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Operador Lógico\n                        </label>\n                        <div className=\"flex gap-4\">\n                            <label className=\"flex items-center gap-2 cursor-pointer\">\n                                <input\n                                    type=\"radio\"\n                                    name=\"operator\"\n                                    value=\"AND\"\n                                    checked={operator === \"AND\"}\n                                    onChange={() => setOperator(\"AND\")}\n                                    className=\"text-blue-600\"\n                                />\n                                <span className=\"text-sm\">AND (todas las condiciones)</span>\n                            </label>\n                            <label className=\"flex items-center gap-2 cursor-pointer\">\n                                <input\n                                    type=\"radio\"\n                                    name=\"operator\"\n                                    value=\"OR\"\n                                    checked={operator === \"OR\"}\n                                    onChange={() => setOperator(\"OR\")}\n                                    className=\"text-blue-600\"\n                                />\n                                <span className=\"text-sm\">OR (cualquier condición)</span>\n                            </label>\n                        </div>\n                    </div>\n\n                    {/* Conditions */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n                            Condiciones\n                        </label>\n                        <div className=\"space-y-3\">\n                            {conditions.map((condition, index) => (\n                                <div key={index} className=\"flex gap-2 items-start\">\n                                    {/* Field */}\n                                    <select\n                                        className=\"w-40 p-2 border border-gray-300 rounded-lg text-sm\"\n                                        value={condition.field}\n                                        onChange={(e) =>\n                                            updateCondition(index, {\n                                                field: e.target.value as FilterCondition[\"field\"],\n                                                value: \"\",\n                                            })\n                                        }\n                                    >\n                                        {FIELD_OPTIONS.map((opt) => (\n                                            <option key={opt.value} value={opt.value}>\n                                                {opt.label}\n                                            </option>\n                                        ))}\n                                    </select>\n\n                                    {/* Operator */}\n                                    <select\n                                        className=\"w-32 p-2 border border-gray-300 rounded-lg text-sm\"\n                                        value={condition.operator}\n                                        onChange={(e) =>\n                                            updateCondition(index, {\n                                                operator: e.target.value as FilterCondition[\"operator\"],\n                                            })\n                                        }\n                                    >\n                                        <option value=\"equals\">es igual a</option>\n                                        <option value=\"contains\">contiene</option>\n                                        {condition.field === \"dueDate\" && (\n                                            <>\n                                                <option value=\"before\">antes de</option>\n                                                <option value=\"after\">después de</option>\n                                            </>\n                                        )}\n                                        <option value=\"isEmpty\">está vacío</option>\n                                        <option value=\"isNotEmpty\">no está vacío</option>\n                                    </select>\n\n                                    {/* Value */}\n                                    {condition.operator !== \"isEmpty\" && condition.operator !== \"isNotEmpty\" && (\n                                        renderValueInput(condition, index)\n                                    )}\n\n                                    {/* Remove Button */}\n                                    {conditions.length > 1 && (\n                                        <button\n                                            onClick={() => removeCondition(index)}\n                                            className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                                        >\n                                            <Trash2 size={18} />\n                                        </button>\n                                    )}\n                                </div>\n                            ))}\n                        </div>\n\n                        {/* Add Condition Button */}\n                        <button\n                            onClick={addCondition}\n                            className=\"mt-3 flex items-center gap-2 px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\n                        >\n                            <Plus size={16} />\n                            Agregar Condición\n                        </button>\n                    </div>\n                </div>\n\n                {/* Footer */}\n                <div className=\"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50\">\n                    <button\n                        onClick={onClose}\n                        className=\"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg transition-colors\"\n                    >\n                        Cancelar\n                    </button>\n                    <button\n                        onClick={handleSave}\n                        className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"\n                    >\n                        Guardar Filtro\n                    </button>\n                </div>\n            </div>\n        </div>,\n        document.body\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4117, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/FilterBar.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useEffect } from \"react\";\nimport { Filter, ChevronDown, X, Plus, Trash2 } from \"lucide-react\";\nimport { FilterBuilder, FilterCriteria } from \"./FilterBuilder\";\n\nexport type FilterType = \"all\" | \"my-tasks\" | \"unassigned\" | \"overdue\" | \"this-week\" | \"custom\";\n\ninterface FilterOption {\n    id: FilterType | string;\n    label: string;\n    description: string;\n    isCustom?: boolean;\n}\n\ninterface SavedFilter {\n    id: string;\n    name: string;\n    criteria: string;\n    isDefault: boolean;\n}\n\nconst PREDEFINED_FILTERS: FilterOption[] = [\n    { id: \"all\", label: \"Todas las Tareas\", description: \"Mostrar todas las tareas\" },\n    { id: \"my-tasks\", label: \"Mis Tareas\", description: \"Tareas asignadas a mí\" },\n    { id: \"unassigned\", label: \"Sin Asignar\", description: \"Tareas sin usuario asignado\" },\n    { id: \"overdue\", label: \"Vencidas\", description: \"Tareas con fecha vencida\" },\n    { id: \"this-week\", label: \"Esta Semana\", description: \"Vencen en los próximos 7 días\" },\n];\n\ninterface FilterBarProps {\n    projectId: string;\n    currentUserId: string;\n    activeFilter: FilterType | string;\n    onFilterChange: (filter: FilterType | string, criteria?: FilterCriteria) => void;\n    availableUsers?: { id: string; name: string | null; email: string | null }[];\n    availableColumns?: { id: string; name: string }[];\n}\n\nexport function FilterBar({\n    projectId,\n    currentUserId,\n    activeFilter,\n    onFilterChange,\n    availableUsers = [],\n    availableColumns = []\n}: FilterBarProps) {\n    const [isOpen, setIsOpen] = useState(false);\n    const [isBuilderOpen, setIsBuilderOpen] = useState(false);\n    const [savedFilters, setSavedFilters] = useState<SavedFilter[]>([]);\n\n    // Load saved filters\n    useEffect(() => {\n        fetch(`/api/projects/${projectId}/filters`)\n            .then(res => res.json())\n            .then(filters => setSavedFilters(filters))\n            .catch(err => console.error(\"Error loading filters:\", err));\n    }, [projectId]);\n\n    const handleSaveFilter = async (name: string, criteria: FilterCriteria) => {\n        try {\n            const response = await fetch(`/api/projects/${projectId}/filters`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ name, criteria }),\n            });\n\n            if (response.ok) {\n                const newFilter = await response.json();\n                setSavedFilters([...savedFilters, newFilter]);\n                onFilterChange(newFilter.id, criteria);\n            }\n        } catch (error) {\n            console.error(\"Error saving filter:\", error);\n        }\n    };\n\n    const handleDeleteFilter = async (filterId: string) => {\n        if (!confirm(\"¿Eliminar este filtro?\")) return;\n\n        try {\n            const response = await fetch(`/api/projects/${projectId}/filters/${filterId}`, {\n                method: \"DELETE\",\n            });\n\n            if (response.ok) {\n                setSavedFilters(savedFilters.filter(f => f.id !== filterId));\n                if (activeFilter === filterId) {\n                    onFilterChange(\"all\");\n                }\n            }\n        } catch (error) {\n            console.error(\"Error deleting filter:\", error);\n        }\n    };\n\n    const allFilters: FilterOption[] = [\n        ...PREDEFINED_FILTERS,\n        ...savedFilters.map(f => ({\n            id: f.id,\n            label: f.name,\n            description: \"Filtro personalizado\",\n            isCustom: true,\n        })),\n    ];\n\n    const activeFilterLabel = allFilters.find(f => f.id === activeFilter)?.label || \"Filtros\";\n\n    return (\n        <>\n            <div className=\"relative\">\n                {/* Filter Button */}\n                <button\n                    onClick={() => setIsOpen(!isOpen)}\n                    className=\"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 hover:shadow-md hover:scale-[1.02] active:scale-[0.98]\"\n                >\n                    <Filter size={16} className=\"text-gray-600\" />\n                    <span className=\"text-sm font-medium text-gray-700\">{activeFilterLabel}</span>\n                    <ChevronDown size={16} className={`text-gray-600 transition-transform ${isOpen ? \"rotate-180\" : \"\"}`} />\n                </button>\n\n                {/* Active Filter Indicator */}\n                {activeFilter !== \"all\" && (\n                    <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white\" />\n                )}\n\n                {/* Dropdown Menu */}\n                {isOpen && (\n                    <>\n                        {/* Backdrop */}\n                        <div\n                            className=\"fixed inset-0 z-10\"\n                            onClick={() => setIsOpen(false)}\n                        />\n\n                        {/* Menu */}\n                        <div className=\"absolute top-full left-0 mt-2 w-72 bg-white border border-gray-200 rounded-lg shadow-lg z-20 animate-in fade-in slide-in-from-top-2 duration-200\">\n                            <div className=\"p-2\">\n                                <div className=\"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3 py-2\">\n                                    Filtros Predefinidos\n                                </div>\n                                {PREDEFINED_FILTERS.map((filter) => (\n                                    <button\n                                        key={filter.id}\n                                        onClick={() => {\n                                            onFilterChange(filter.id as FilterType);\n                                            setIsOpen(false);\n                                        }}\n                                        className={`\n                      w-full text-left px-3 py-2 rounded-md transition-colors\n                      ${activeFilter === filter.id\n                                                ? \"bg-blue-50 text-blue-700\"\n                                                : \"hover:bg-gray-50 text-gray-700\"\n                                            }\n                    `}\n                                    >\n                                        <div className=\"font-medium text-sm\">{filter.label}</div>\n                                        <div className=\"text-xs text-gray-500 mt-0.5\">{filter.description}</div>\n                                    </button>\n                                ))}\n                            </div>\n\n                            {/* Custom Filters */}\n                            {savedFilters.length > 0 && (\n                                <div className=\"border-t border-gray-200 p-2\">\n                                    <div className=\"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3 py-2\">\n                                        Filtros Personalizados\n                                    </div>\n                                    {savedFilters.map((filter) => (\n                                        <div\n                                            key={filter.id}\n                                            className={`\n                        flex items-center justify-between px-3 py-2 rounded-md transition-colors\n                        ${activeFilter === filter.id\n                                                    ? \"bg-blue-50\"\n                                                    : \"hover:bg-gray-50\"\n                                                }\n                      `}\n                                        >\n                                            <button\n                                                onClick={() => {\n                                                    onFilterChange(filter.id, JSON.parse(filter.criteria));\n                                                    setIsOpen(false);\n                                                }}\n                                                className=\"flex-1 text-left\"\n                                            >\n                                                <div className=\"font-medium text-sm text-gray-700\">{filter.name}</div>\n                                            </button>\n                                            <button\n                                                onClick={(e) => {\n                                                    e.stopPropagation();\n                                                    handleDeleteFilter(filter.id);\n                                                }}\n                                                className=\"p-1 text-red-600 hover:bg-red-50 rounded transition-colors\"\n                                            >\n                                                <Trash2 size={14} />\n                                            </button>\n                                        </div>\n                                    ))}\n                                </div>\n                            )}\n\n                            {/* Create Filter Button */}\n                            <div className=\"border-t border-gray-200 p-2\">\n                                <button\n                                    onClick={() => {\n                                        setIsOpen(false);\n                                        setIsBuilderOpen(true);\n                                    }}\n                                    className=\"w-full flex items-center gap-2 px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-md transition-colors font-medium\"\n                                >\n                                    <Plus size={16} />\n                                    Crear Filtro Personalizado\n                                </button>\n                            </div>\n\n                            {/* Clear Filter */}\n                            {activeFilter !== \"all\" && (\n                                <div className=\"border-t border-gray-200 p-2\">\n                                    <button\n                                        onClick={() => {\n                                            onFilterChange(\"all\");\n                                            setIsOpen(false);\n                                        }}\n                                        className=\"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded-md transition-colors\"\n                                    >\n                                        <X size={14} />\n                                        Limpiar Filtro\n                                    </button>\n                                </div>\n                            )}\n                        </div>\n                    </>\n                )}\n            </div>\n\n            {/* Filter Builder Modal */}\n            {isBuilderOpen && (\n                <FilterBuilder\n                    projectId={projectId}\n                    availableUsers={availableUsers}\n                    availableColumns={availableColumns}\n                    onClose={() => setIsBuilderOpen(false)}\n                    onSave={handleSaveFilter}\n                />\n            )}\n        </>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4500, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,6LAAC;QACC,MAAM;QACN,WAAW,IAAA,4HAAE,EACX,kYACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 4535, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/select.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Trigger>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n    <SelectPrimitive.Trigger\n        ref={ref}\n        className={cn(\n            \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n            className\n        )}\n        {...props}\n    >\n        {children}\n        <SelectPrimitive.Icon asChild>\n            <ChevronDown className=\"h-4 w-4 opacity-50\" />\n        </SelectPrimitive.Icon>\n    </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n    <SelectPrimitive.ScrollUpButton\n        ref={ref}\n        className={cn(\n            \"flex cursor-default items-center justify-center py-1\",\n            className\n        )}\n        {...props}\n    >\n        <ChevronUp className=\"h-4 w-4\" />\n    </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n    <SelectPrimitive.ScrollDownButton\n        ref={ref}\n        className={cn(\n            \"flex cursor-default items-center justify-center py-1\",\n            className\n        )}\n        {...props}\n    >\n        <ChevronDown className=\"h-4 w-4\" />\n    </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n    SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Content>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n    <SelectPrimitive.Portal>\n        <SelectPrimitive.Content\n            ref={ref}\n            className={cn(\n                \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-white text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n                position === \"popper\" &&\n                \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n                className\n            )}\n            position={position}\n            {...props}\n        >\n            <SelectScrollUpButton />\n            <SelectPrimitive.Viewport\n                className={cn(\n                    \"p-1\",\n                    position === \"popper\" &&\n                    \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n                )}\n            >\n                {children}\n            </SelectPrimitive.Viewport>\n            <SelectScrollDownButton />\n        </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Label>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n    <SelectPrimitive.Label\n        ref={ref}\n        className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n        {...props}\n    />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Item>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n    <SelectPrimitive.Item\n        ref={ref}\n        className={cn(\n            \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n            className\n        )}\n        {...props}\n    >\n        <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n            <SelectPrimitive.ItemIndicator>\n                <Check className=\"h-4 w-4\" />\n            </SelectPrimitive.ItemIndicator>\n        </span>\n\n        <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n    </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n    React.ElementRef<typeof SelectPrimitive.Separator>,\n    React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n    <SelectPrimitive.Separator\n        ref={ref}\n        className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n        {...props}\n    />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n    Select,\n    SelectGroup,\n    SelectValue,\n    SelectTrigger,\n    SelectContent,\n    SelectLabel,\n    SelectItem,\n    SelectSeparator,\n    SelectScrollUpButton,\n    SelectScrollDownButton,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AAAA;AAAA;AAEA;AANA;;;;;;AAQA,MAAM,SAAS,6KAAoB;AAEnC,MAAM,cAAc,8KAAqB;AAEzC,MAAM,cAAc,8KAAqB;AAEzC,MAAM,8BAAgB,2KAAgB,MAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBAClC,6LAAC,gLAAuB;QACpB,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,mTACA;QAEH,GAAG,KAAK;;YAER;0BACD,6LAAC,6KAAoB;gBAAC,OAAO;0BACzB,cAAA,6LAAC,sOAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;;AAInC,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,qCAAuB,2KAAgB,CAG3C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC,uLAA8B;QAC3B,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,wDACA;QAEH,GAAG,KAAK;kBAET,cAAA,6LAAC,gOAAS;YAAC,WAAU;;;;;;;;;;;MAZvB;AAeN,qBAAqB,WAAW,GAAG,uLAA8B,CAAC,WAAW;AAE7E,MAAM,uCAAyB,2KAAgB,CAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC,yLAAgC;QAC7B,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,wDACA;QAEH,GAAG,KAAK;kBAET,cAAA,6LAAC,sOAAW;YAAC,WAAU;;;;;;;;;;;MAZzB;AAeN,uBAAuB,WAAW,GAC9B,yLAAgC,CAAC,WAAW;AAEhD,MAAM,8BAAgB,2KAAgB,OAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACvD,6LAAC,+KAAsB;kBACnB,cAAA,6LAAC,gLAAuB;YACpB,KAAK;YACL,WAAW,IAAA,4HAAE,EACT,qcACA,aAAa,YACb,mIACA;YAEJ,UAAU;YACT,GAAG,KAAK;;8BAET,6LAAC;;;;;8BACD,6LAAC,iLAAwB;oBACrB,WAAW,IAAA,4HAAE,EACT,OACA,aAAa,YACb;8BAGH;;;;;;8BAEL,6LAAC;;;;;;;;;;;;;;;;;AAIb,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC,8KAAqB;QAClB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,0CAA0C;QACvD,GAAG,KAAK;;;;;;;AAGjB,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW;AAE3D,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBAClC,6LAAC,6KAAoB;QACjB,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,6NACA;QAEH,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACZ,cAAA,6LAAC,sLAA6B;8BAC1B,cAAA,6LAAC,gNAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAIzB,6LAAC,iLAAwB;0BAAE;;;;;;;;;;;;;AAGnC,WAAW,WAAW,GAAG,6KAAoB,CAAC,WAAW;AAEzD,MAAM,gCAAkB,2KAAgB,QAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC,kLAAyB;QACtB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;;;;;;AAGjB,gBAAgB,WAAW,GAAG,kLAAyB,CAAC,WAAW"}},
    {"offset": {"line": 4758, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/ui/table.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n    HTMLTableElement,\n    React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n    <div className=\"relative w-full overflow-auto\">\n        <table\n            ref={ref}\n            className={cn(\"w-full caption-bottom text-sm\", className)}\n            {...props}\n        />\n    </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n    HTMLTableSectionElement,\n    React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n    <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n    HTMLTableSectionElement,\n    React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n    <tbody\n        ref={ref}\n        className={cn(\"[&_tr:last-child]:border-0\", className)}\n        {...props}\n    />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n    HTMLTableSectionElement,\n    React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n    <tfoot\n        ref={ref}\n        className={cn(\n            \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n            className\n        )}\n        {...props}\n    />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n    HTMLTableRowElement,\n    React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n    <tr\n        ref={ref}\n        className={cn(\n            \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n            className\n        )}\n        {...props}\n    />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n    HTMLTableCellElement,\n    React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n    <th\n        ref={ref}\n        className={cn(\n            \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n            className\n        )}\n        {...props}\n    />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n    HTMLTableCellElement,\n    React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n    <td\n        ref={ref}\n        className={cn(\n            \"p-4 align-middle [&:has([role=checkbox])]:pr-0\",\n            className\n        )}\n        {...props}\n    />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n    HTMLTableCaptionElement,\n    React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n    <caption\n        ref={ref}\n        className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n        {...props}\n    />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n    Table,\n    TableHeader,\n    TableBody,\n    TableFooter,\n    TableHead,\n    TableRow,\n    TableCell,\n    TableCaption,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAG5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YACG,KAAK;YACL,WAAW,IAAA,4HAAE,EAAC,iCAAiC;YAC9C,GAAG,KAAK;;;;;;;;;;;;AAIrB,MAAM,WAAW,GAAG;AAEpB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QAAM,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,mBAAmB;QAAa,GAAG,KAAK;;;;;;;AAE3E,YAAY,WAAW,GAAG;AAE1B,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACG,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGjB,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACG,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,2DACA;QAEH,GAAG,KAAK;;;;;;;AAGjB,YAAY,WAAW,GAAG;AAE1B,MAAM,yBAAW,2KAAgB,OAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACG,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,+EACA;QAEH,GAAG,KAAK;;;;;;;AAGjB,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACG,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,oGACA;QAEH,GAAG,KAAK;;;;;;;AAGjB,UAAU,WAAW,GAAG;AAExB,MAAM,0BAAY,2KAAgB,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACG,KAAK;QACL,WAAW,IAAA,4HAAE,EACT,kDACA;QAEH,GAAG,KAAK;;;;;;;AAGjB,UAAU,WAAW,GAAG;AAExB,MAAM,6BAAe,2KAAgB,QAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,6LAAC;QACG,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;;AAGjB,aAAa,WAAW,GAAG"}},
    {"offset": {"line": 4902, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/project/ProjectSettings.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useSession } from \"next-auth/react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n    Select,\n    SelectContent,\n    SelectItem,\n    SelectTrigger,\n    SelectValue,\n} from \"@/components/ui/select\";\nimport {\n    Table,\n    TableBody,\n    TableCell,\n    TableHead,\n    TableHeader,\n    TableRow,\n} from \"@/components/ui/table\";\nimport { usePermissions } from \"@/hooks/usePermissions\";\nimport { PERMISSIONS, ROLES } from \"@/lib/permissions\";\nimport { Trash2, UserPlus, Shield } from \"lucide-react\";\n\ninterface ProjectSettingsProps {\n    projectId: string;\n}\n\ninterface ProjectUser {\n    user: {\n        id: string;\n        name: string | null;\n        email: string | null;\n        image: string | null;\n    };\n    role: string;\n    source: 'project' | 'workspace' | 'owner';\n}\n\nexport function ProjectSettings({ projectId }: ProjectSettingsProps) {\n    const { data: session } = useSession();\n    const { can, isLoading: permissionsLoading } = usePermissions(projectId);\n    const [users, setUsers] = useState<ProjectUser[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [inviteEmail, setInviteEmail] = useState(\"\");\n    const [inviteRole, setInviteRole] = useState<string>(ROLES.ARTIST);\n    const [isInviting, setIsInviting] = useState(false);\n    const [invitations, setInvitations] = useState<any[]>([]);\n\n    useEffect(() => {\n        fetchUsers();\n        fetchInvitations();\n    }, [projectId]);\n\n    const fetchUsers = async () => {\n        try {\n            const res = await fetch(`/api/projects/${projectId}/users`);\n            if (res.ok) {\n                const data = await res.json();\n                setUsers(data);\n            }\n        } catch (error) {\n            console.error(\"Error fetching users:\", error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const fetchInvitations = async () => {\n        try {\n            const res = await fetch(`/api/projects/${projectId}/invitations`);\n            if (res.ok) {\n                const data = await res.json();\n                setInvitations(data);\n            }\n        } catch (error) {\n            console.error(\"Error fetching invitations:\", error);\n        }\n    };\n\n    const handleInviteUser = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!inviteEmail) return;\n\n        setIsInviting(true);\n        try {\n            const res = await fetch(`/api/projects/${projectId}/invitations`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ email: inviteEmail, role: inviteRole }),\n            });\n\n            if (res.ok) {\n                setInviteEmail(\"\");\n                alert(\"Invitation created successfully!\");\n                fetchInvitations();\n            } else {\n                const error = await res.json();\n                alert(error.message || \"Failed to invite user\");\n            }\n        } catch (error) {\n            console.error(\"Error inviting user:\", error);\n        } finally {\n            setIsInviting(false);\n        }\n    };\n\n    // ... (handleRoleChange and handleRemoveUser remain the same)\n\n    const handleRoleChange = async (userId: string, newRole: string) => {\n        try {\n            const res = await fetch(`/api/projects/${projectId}/users/${userId}`, {\n                method: \"PUT\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ role: newRole }),\n            });\n\n            if (res.ok) {\n                fetchUsers();\n            } else {\n                alert(\"Failed to update role\");\n            }\n        } catch (error) {\n            console.error(\"Error updating role:\", error);\n        }\n    };\n\n    const handleRemoveUser = async (userId: string) => {\n        if (!confirm(\"Are you sure you want to remove this user from the project?\")) return;\n\n        try {\n            const res = await fetch(`/api/projects/${projectId}/users/${userId}`, {\n                method: \"DELETE\",\n            });\n\n            if (res.ok) {\n                fetchUsers();\n            } else {\n                const error = await res.json();\n                alert(error.message || \"Failed to remove user\");\n            }\n        } catch (error) {\n            console.error(\"Error removing user:\", error);\n        }\n    };\n\n    // Check loading states first\n    if (loading || permissionsLoading) {\n        return <div className=\"p-4\">Loading...</div>;\n    }\n\n    // Check permissions after loading\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) {\n        return <div className=\"p-4\">You do not have permission to view project settings.</div>;\n    }\n\n    return (\n        <div className=\"space-y-8\">\n            <div className=\"flex justify-between items-center\">\n                <h2 className=\"text-xl font-bold flex items-center gap-2\">\n                    <Shield className=\"w-5 h-5\" /> Project Access & Roles\n                </h2>\n            </div>\n\n            {/* Invite User Form */}\n            <div className=\"bg-slate-50 p-4 rounded-lg border border-slate-200\">\n                <h3 className=\"text-sm font-medium mb-3 text-slate-700\">Invite User to Project</h3>\n                <form onSubmit={handleInviteUser} className=\"grid grid-cols-12 gap-4 items-center\">\n                    <div className=\"col-span-6 space-y-1.5\">\n                        <label className=\"text-sm font-medium text-slate-700\">Email Address</label>\n                        <Input\n                            type=\"email\"\n                            placeholder=\"user@example.com\"\n                            value={inviteEmail}\n                            onChange={(e) => setInviteEmail(e.target.value)}\n                            required\n                            className=\"bg-white h-10\"\n                        />\n                    </div>\n                    <div className=\"col-span-4 space-y-1.5\">\n                        <label className=\"text-sm font-medium text-slate-700\">Role</label>\n                        <Select value={inviteRole} onValueChange={setInviteRole}>\n                            <SelectTrigger className=\"bg-white h-10\">\n                                <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                                <SelectItem value={ROLES.PROJECT_MANAGER}>Project Manager</SelectItem>\n                                <SelectItem value={ROLES.ARTIST}>Artist</SelectItem>\n                                <SelectItem value={ROLES.VIEWER}>Viewer</SelectItem>\n                            </SelectContent>\n                        </Select>\n                    </div>\n\n                    <div className=\"col-span-2 pt-6\">\n                        <Button type=\"submit\" disabled={isInviting} className=\"w-full h-10\">\n                            {isInviting ? \"Inviting...\" : <><UserPlus className=\"w-4 h-4 mr-2\" /> Invite</>}\n                        </Button>\n                    </div>\n                </form>\n            </div>\n\n            {/* Pending Invitations */}\n            {invitations.length > 0 && (\n                <div>\n                    <h3 className=\"text-lg font-semibold mb-3\">Pending Invitations</h3>\n                    <div className=\"border rounded-lg overflow-hidden\">\n                        <Table>\n                            <TableHeader>\n                                <TableRow>\n                                    <TableHead>Email</TableHead>\n                                    <TableHead>Role</TableHead>\n                                    <TableHead>Sent At</TableHead>\n                                    <TableHead>Expires</TableHead>\n                                    <TableHead className=\"text-right\">Link</TableHead>\n                                </TableRow>\n                            </TableHeader>\n                            <TableBody>\n                                {invitations.map((inv) => (\n                                    <TableRow key={inv.id}>\n                                        <TableCell>{inv.email}</TableCell>\n                                        <TableCell>{inv.role}</TableCell>\n                                        <TableCell>{new Date(inv.createdAt).toLocaleDateString()}</TableCell>\n                                        <TableCell>{new Date(inv.expiresAt).toLocaleDateString()}</TableCell>\n                                        <TableCell className=\"text-right\">\n                                            <Button\n                                                variant=\"ghost\"\n                                                size=\"sm\"\n                                                onClick={() => {\n                                                    const link = `${window.location.origin}/invite/${inv.token}`;\n                                                    navigator.clipboard.writeText(link);\n                                                    alert(\"Invitation link copied to clipboard!\");\n                                                }}\n                                            >\n                                                Copy Link\n                                            </Button>\n                                        </TableCell>\n                                    </TableRow>\n                                ))}\n                            </TableBody>\n                        </Table>\n                    </div>\n                </div>\n            )}\n\n            {/* Users Table */}\n            <div>\n                <h3 className=\"text-lg font-semibold mb-3\">Project Members</h3>\n                <div className=\"border rounded-lg overflow-hidden\">\n                    <Table>\n                        <TableHeader>\n                            <TableRow>\n                                <TableHead>User</TableHead>\n                                <TableHead>Email</TableHead>\n                                <TableHead>Access Source</TableHead>\n                                <TableHead>Role</TableHead>\n                                <TableHead className=\"text-right\">Actions</TableHead>\n                            </TableRow>\n                        </TableHeader>\n                        <TableBody>\n                            {users.map((u) => (\n                                <TableRow key={u.user.id}>\n                                    <TableCell className=\"font-medium\">\n                                        <div className=\"flex items-center gap-2\">\n                                            {u.user.image && (\n                                                <img src={u.user.image} alt=\"\" className=\"w-6 h-6 rounded-full\" />\n                                            )}\n                                            {u.user.name || \"Unknown\"}\n                                        </div>\n                                    </TableCell>\n                                    <TableCell>{u.user.email}</TableCell>\n                                    <TableCell>\n                                        <span className={`text-xs px-2 py-1 rounded-full ${u.source === 'owner' ? 'bg-purple-100 text-purple-700' :\n                                            u.source === 'workspace' ? 'bg-blue-100 text-blue-700' :\n                                                'bg-green-100 text-green-700'\n                                            }`}>\n                                            {u.source === 'owner' ? 'Owner' :\n                                                u.source === 'workspace' ? 'Workspace' : 'Project'}\n                                        </span>\n                                    </TableCell>\n                                    <TableCell>\n                                        {u.source === 'owner' ? (\n                                            <span className=\"font-semibold text-slate-700\">Admin</span>\n                                        ) : (\n                                            <Select\n                                                value={u.role}\n                                                onValueChange={(val) => handleRoleChange(u.user.id, val)}\n                                                disabled={u.user.id === session?.user?.id} // Prevent changing own role\n                                            >\n                                                <SelectTrigger className=\"w-32 h-8\">\n                                                    <SelectValue />\n                                                </SelectTrigger>\n                                                <SelectContent>\n                                                    <SelectItem value={ROLES.ADMIN}>Admin</SelectItem>\n                                                    <SelectItem value={ROLES.PROJECT_MANAGER}>Manager</SelectItem>\n                                                    <SelectItem value={ROLES.ARTIST}>Artist</SelectItem>\n                                                    <SelectItem value={ROLES.VIEWER}>Viewer</SelectItem>\n                                                </SelectContent>\n                                            </Select>\n                                        )}\n                                    </TableCell>\n                                    <TableCell className=\"text-right\">\n                                        {u.source === 'project' && u.user.id !== session?.user?.id && (\n                                            <Button\n                                                variant=\"ghost\"\n                                                size=\"icon\"\n                                                className=\"text-red-500 hover:text-red-700 hover:bg-red-50\"\n                                                onClick={() => handleRemoveUser(u.user.id)}\n                                            >\n                                                <Trash2 className=\"w-4 h-4\" />\n                                            </Button>\n                                        )}\n                                    </TableCell>\n                                </TableRow>\n                            ))}\n                        </TableBody>\n                    </Table>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5650, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/gantt/GanttChart.tsx"],"sourcesContent":["\"use client\";\nimport React, { useMemo, useState, useRef } from \"react\";\n\ninterface GanttTask {\n    id: string;\n    title: string;\n    startDate?: string | null;\n    endDate?: string | null;\n    toleranceDate?: string | null;\n    parentId?: string | null;\n    children?: GanttTask[];\n    projectId: string;\n    columnId: string;\n    isHiddenInGantt?: boolean;\n}\n\ninterface GanttChartProps {\n    tasks: GanttTask[];\n    columns: { id: string; name: string; color?: string }[];\n    onTaskClick: (taskId: string) => void;\n    onTaskUpdate?: () => void;\n}\n\nexport function GanttChart({ tasks, columns, onTaskClick, onTaskUpdate }: GanttChartProps) {\n    const [resizing, setResizing] = useState<{ taskId: string; edge: 'start' | 'end' | 'tolerance'; newDate: string | null } | null>(null);\n    const [previewDates, setPreviewDates] = useState<Record<string, { startDate?: string; endDate?: string; toleranceDate?: string }>>({});\n    const timelineRef = useRef<HTMLDivElement>(null);\n    const timelineTrackRef = useRef<HTMLDivElement>(null);\n\n    // Filter out tasks that should be hidden in Gantt\n    const ganttVisibleTasks = useMemo(() => {\n        return tasks.filter(task => !task.isHiddenInGantt);\n    }, [tasks]);\n\n    // Filter tasks that have dates\n    const tasksWithDates = useMemo(() => {\n        return ganttVisibleTasks.filter(task => task.startDate && task.endDate);\n    }, [ganttVisibleTasks]);\n\n    // Calculate date range for the project\n    const dateRange = useMemo(() => {\n        if (tasksWithDates.length === 0) {\n            const today = new Date();\n            return {\n                start: new Date(today.getFullYear(), today.getMonth(), 1),\n                end: new Date(today.getFullYear(), today.getMonth() + 3, 0),\n            };\n        }\n\n        const dates = tasksWithDates.flatMap(task => [\n            new Date(task.startDate!),\n            new Date(task.endDate!),\n            task.toleranceDate ? new Date(task.toleranceDate) : null,\n        ].filter(Boolean) as Date[]);\n\n        const minDate = new Date(Math.min(...dates.map(d => d.getTime())));\n        const maxDate = new Date(Math.max(...dates.map(d => d.getTime())));\n\n        // Add padding\n        minDate.setDate(minDate.getDate() - 7);\n        maxDate.setDate(maxDate.getDate() + 7);\n\n        return { start: minDate, end: maxDate };\n    }, [tasksWithDates]);\n\n    // Generate month headers\n    const months = useMemo(() => {\n        const result: { label: string; days: number }[] = [];\n        const current = new Date(dateRange.start);\n\n        while (current <= dateRange.end) {\n            const year = current.getFullYear();\n            const month = current.getMonth();\n            const monthStart = new Date(year, month, 1);\n            const monthEnd = new Date(year, month + 1, 0);\n\n            const daysInMonth = monthEnd.getDate();\n            result.push({\n                label: current.toLocaleDateString('es-ES', { month: 'short', year: 'numeric' }),\n                days: daysInMonth,\n            });\n\n            current.setMonth(current.getMonth() + 1);\n        }\n\n        return result;\n    }, [dateRange]);\n\n    const totalDays = useMemo(() => {\n        return Math.ceil((dateRange.end.getTime() - dateRange.start.getTime()) / (1000 * 60 * 60 * 24));\n    }, [dateRange]);\n\n    // Calculate task bar position and width with preview support\n    const getTaskBarStyle = (task: GanttTask) => {\n        if (!task.startDate || !task.endDate) return null;\n\n        // Use preview dates if available\n        const preview = previewDates[task.id];\n        const startDate = preview?.startDate || task.startDate;\n        const endDate = preview?.endDate || task.endDate;\n\n        const start = new Date(startDate);\n        const end = new Date(endDate);\n\n        const startOffset = Math.ceil((start.getTime() - dateRange.start.getTime()) / (1000 * 60 * 60 * 24));\n        const duration = Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)) + 1;\n\n        const leftPercent = (startOffset / totalDays) * 100;\n        const widthPercent = (duration / totalDays) * 100;\n\n        return {\n            left: `${leftPercent}%`,\n            width: `${widthPercent}%`,\n        };\n    };\n\n    // Convert mouse position to date\n    const getDateFromMousePosition = (clientX: number) => {\n        if (!timelineTrackRef.current) return null;\n\n        const rect = timelineTrackRef.current.getBoundingClientRect();\n        const relativeX = clientX - rect.left;\n        const percentX = relativeX / rect.width;\n        const dayOffset = Math.round(percentX * totalDays);\n\n        const newDate = new Date(dateRange.start);\n        newDate.setDate(newDate.getDate() + dayOffset);\n\n        return newDate;\n    };\n\n    // Handle resize\n    const handleMouseDown = (e: React.MouseEvent, taskId: string, edge: 'start' | 'end' | 'tolerance') => {\n        e.stopPropagation();\n        setResizing({ taskId, edge, newDate: null });\n    };\n\n    const handleMouseMove = (e: MouseEvent) => {\n        if (!resizing) return;\n\n        const newDate = getDateFromMousePosition(e.clientX);\n        if (!newDate) return;\n\n        const task = tasksWithDates.find(t => t.id === resizing.taskId);\n        if (!task) return;\n\n        const dateString = newDate.toISOString().split('T')[0];\n\n        // Validate dates based on edge being dragged\n        if (resizing.edge === 'start' && task.endDate) {\n            const endDate = new Date(task.endDate);\n            if (newDate >= endDate) return;\n        } else if (resizing.edge === 'end' && task.startDate) {\n            const startDate = new Date(task.startDate);\n            if (newDate <= startDate) return;\n        }\n        // No validation needed for tolerance date\n\n        // Update preview dates for visual feedback\n        const fieldName = resizing.edge === 'start' ? 'startDate' :\n            resizing.edge === 'end' ? 'endDate' : 'toleranceDate';\n\n        setPreviewDates(prev => ({\n            ...prev,\n            [resizing.taskId]: {\n                ...prev[resizing.taskId],\n                [fieldName]: dateString,\n            }\n        }));\n\n        // Update the newDate in state\n        setResizing({ ...resizing, newDate: dateString });\n    };\n\n    const handleMouseUp = async () => {\n        if (!resizing || !resizing.newDate) {\n            setResizing(null);\n            setPreviewDates({});\n            return;\n        }\n\n        const task = tasksWithDates.find(t => t.id === resizing.taskId);\n        if (!task) {\n            setResizing(null);\n            setPreviewDates({});\n            return;\n        }\n\n        // Determine field name based on edge\n        const fieldName = resizing.edge === 'start' ? 'startDate' :\n            resizing.edge === 'end' ? 'endDate' : 'toleranceDate';\n\n        // Save to backend\n        try {\n            const response = await fetch(`/api/projects/${task.projectId}/tasks/${task.id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    [fieldName]: resizing.newDate,\n                }),\n            });\n\n            if (response.ok) {\n                // Refresh data without reloading the page\n                setPreviewDates({});\n                if (onTaskUpdate) {\n                    onTaskUpdate();\n                }\n            }\n        } catch (error) {\n            console.error('Error updating task date:', error);\n        }\n\n        setResizing(null);\n    };\n\n    // Add event listeners\n    React.useEffect(() => {\n        if (resizing) {\n            window.addEventListener('mousemove', handleMouseMove);\n            window.addEventListener('mouseup', handleMouseUp);\n\n            return () => {\n                window.removeEventListener('mousemove', handleMouseMove);\n                window.removeEventListener('mouseup', handleMouseUp);\n            };\n        }\n    }, [resizing, previewDates]);\n\n    // Flatten tasks with hierarchy info\n    const flatTasks = useMemo(() => {\n        const result: (GanttTask & { level: number })[] = [];\n        const taskMap = new Map(tasksWithDates.map(t => [t.id, t]));\n\n        const flatten = (task: GanttTask, level: number) => {\n            result.push({ ...task, level });\n            if (task.children) {\n                task.children.forEach(childRef => {\n                    const childTask = taskMap.get(childRef.id);\n                    if (childTask) {\n                        flatten(childTask, level + 1);\n                    }\n                });\n            }\n        };\n\n        const topLevelTasks = tasksWithDates.filter(task => !task.parentId);\n        topLevelTasks.forEach(task => flatten(task, 0));\n\n        return result;\n    }, [tasksWithDates]);\n\n    if (tasksWithDates.length === 0) {\n        return (\n            <div className=\"flex items-center justify-center h-full bg-gray-50 rounded-lg\">\n                <div className=\"text-center p-8\">\n                    <p className=\"text-gray-500 text-lg mb-2\">No hay tareas con fechas configuradas</p>\n                    <p className=\"text-gray-400 text-sm\">Agrega fechas de inicio y fin a tus tareas para verlas en el Gantt</p>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"h-full flex flex-col bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\">\n            {/* Timeline Header */}\n            <div className=\"flex border-b border-gray-200 bg-gray-50\">\n                <div className=\"w-64 flex-shrink-0 p-4 font-semibold text-gray-700 border-r border-gray-200\">\n                    Tarea\n                </div>\n                <div className=\"flex-1 flex\" ref={timelineTrackRef}>\n                    {months.map((month, idx) => (\n                        <div\n                            key={idx}\n                            className=\"flex-1 p-4 text-center font-semibold text-gray-700 border-r border-gray-200 last:border-r-0\"\n                            style={{ minWidth: `${(month.days / totalDays) * 100}%` }}\n                        >\n                            {month.label}\n                        </div>\n                    ))}\n                </div>\n            </div>\n\n            {/* Tasks */}\n            <div className=\"flex-1 overflow-y-auto\" ref={timelineRef}>\n                {flatTasks.map((task) => {\n                    const barStyle = getTaskBarStyle(task);\n                    if (!barStyle) return null;\n\n                    return (\n                        <div\n                            key={task.id}\n                            className=\"flex border-b border-gray-100 hover:bg-gray-50 transition-colors group\"\n                        >\n                            {/* Task Name */}\n                            <div\n                                className=\"w-64 flex-shrink-0 p-3 border-r border-gray-200 flex items-center cursor-pointer\"\n                                onClick={() => onTaskClick(task.id)}\n                                style={{ paddingLeft: `${task.level * 20 + 12}px` }}\n                            >\n                                {task.level > 0 && (\n                                    <span className=\"text-gray-400 mr-2\">└</span>\n                                )}\n                                <span className=\"text-sm text-gray-700 truncate hover:text-blue-600\">\n                                    {task.title}\n                                </span>\n                            </div>\n\n                            {/* Timeline */}\n                            <div className=\"flex-1 relative py-3 px-0\">\n                                {(() => {\n                                    const column = columns.find(c => c.id === task.columnId);\n                                    const columnColor = column?.color || '#E0F7FA';\n\n                                    return (\n                                        <div\n                                            className=\"absolute top-1/2 -translate-y-1/2 h-8 rounded shadow-sm hover:opacity-90 transition-opacity group/bar\"\n                                            style={{ ...barStyle, backgroundColor: columnColor }}\n                                            title={`${task.title}\\n${new Date(task.startDate!).toLocaleDateString()} - ${new Date(task.endDate!).toLocaleDateString()}`}\n                                        >\n                                            {/* Left resize handle */}\n                                            <div\n                                                className=\"absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize hover:bg-black hover:bg-opacity-20 opacity-0 group-hover/bar:opacity-100 transition-opacity\"\n                                                onMouseDown={(e) => handleMouseDown(e, task.id, 'start')}\n                                                title=\"Arrastrar para cambiar fecha de inicio\"\n                                            />\n\n                                            {/* Task title */}\n                                            <div\n                                                className=\"h-full flex items-center justify-center text-white text-xs font-medium px-2 truncate cursor-pointer\"\n                                                onClick={() => onTaskClick(task.id)}\n                                            >\n                                                {task.title}\n                                            </div>\n\n                                            {/* Right resize handle */}\n                                            <div\n                                                className=\"absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize hover:bg-black hover:bg-opacity-20 opacity-0 group-hover/bar:opacity-100 transition-opacity\"\n                                                onMouseDown={(e) => handleMouseDown(e, task.id, 'end')}\n                                                title=\"Arrastrar para cambiar fecha de fin\"\n                                            />\n                                        </div>\n                                    );\n                                })()}\n\n                                {/* Tolerance Date Indicator */}\n                                {task.toleranceDate && (\n                                    <div\n                                        className=\"absolute top-1/2 -translate-y-1/2 w-3 h-12 bg-red-500 opacity-70 hover:opacity-100 cursor-ew-resize transition-opacity group/tolerance\"\n                                        style={{\n                                            left: `${((new Date(previewDates[task.id]?.toleranceDate || task.toleranceDate).getTime() - dateRange.start.getTime()) / (1000 * 60 * 60 * 24) / totalDays) * 100}%`,\n                                        }}\n                                        onMouseDown={(e) => handleMouseDown(e, task.id, 'tolerance')}\n                                        title={`Fecha de tolerancia: ${new Date(previewDates[task.id]?.toleranceDate || task.toleranceDate).toLocaleDateString()}\\nArrastrar para cambiar`}\n                                    >\n                                        <div className=\"absolute inset-0 flex items-center justify-center\">\n                                            <div className=\"w-1 h-full bg-red-600\" />\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    );\n                })}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6136, "column": 0}, "map": {"version":3,"sources":["file:///Users/rubenoroz/scena-v1/src/components/kanban/KanbanBoard.tsx"],"sourcesContent":["\"use client\";\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport Link from \"next/link\";\nimport {\n  DndContext,\n  DragEndEvent,\n  DragOverlay,\n  DragStartEvent,\n  DragOverEvent,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  Active,\n  pointerWithin,\n} from \"@dnd-kit/core\";\nimport { arrayMove, SortableContext } from \"@dnd-kit/sortable\";\nimport { createPortal } from \"react-dom\";\nimport useSWR from \"swr\";\nimport { useSession } from \"next-auth/react\";\nimport { Column } from \"./Column\";\nimport { Task } from \"./Task\";\nimport { Button } from \"../ui/button\";\nimport { TaskDetailModal } from \"./TaskDetailModal\";\nimport { FilterBar, FilterType } from \"./FilterBar\";\nimport { FilterCriteria } from \"./FilterBuilder\";\nimport { usePermissions } from \"@/hooks/usePermissions\";\nimport { PERMISSIONS } from \"@/lib/permissions\";\nimport { ProjectSettings } from \"../project/ProjectSettings\";\nimport { GanttChart } from \"../gantt/GanttChart\";\nimport { Settings, X, BarChart3, Eye, EyeOff, Archive } from \"lucide-react\";\n\ninterface KanbanBoardProps {\n  projectId: string;\n}\n\ntype FetchedTask = {\n  id: string;\n  title: string;\n  description?: string;\n  order: number;\n  columnId: string;\n  projectId: string;\n  parentId?: string | null;\n  children?: FetchedTask[];\n  priority?: string | null;\n  tags?: string | null;\n  links?: string | null;\n  checklist?: string | null;\n  attachments?: string | null;\n  assignees?: { id: string; name: string | null; email: string | null; image: string | null }[];\n  endDate?: string | null;\n  progress?: number;\n  isArchived?: boolean; // Add isArchived\n};\n\ntype FetchedColumn = {\n  id: string;\n  name: string;\n  color?: string;\n  cardColor?: string;\n  order: number;\n  projectId: string;\n  tasks: FetchedTask[];\n};\n\nconst fetcher = (url: string) => fetch(url).then((res) => res.json());\n\nexport function KanbanBoard({ projectId }: KanbanBoardProps) {\n  const { data: session } = useSession();\n  const { can } = usePermissions(projectId);\n  const { data: fetchedColumns, error, mutate } = useSWR<FetchedColumn[]>(\n    `/api/projects/${projectId}/columns`,\n    fetcher,\n    {\n      revalidateOnFocus: true, // Refresh when user returns to tab\n      revalidateOnReconnect: true, // Refresh when internet reconnects\n      refreshInterval: 10000, // Poll every 10 seconds for real-time updates\n    }\n  );\n\n  const [columns, setColumns] = useState<FetchedColumn[]>([]);\n  const [tasks, setTasks] = useState<FetchedTask[]>([]);\n  const [activeItem, setActiveItem] = useState<Active | null>(null);\n  const [selectedTaskId, setSelectedTaskId] = useState<string | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [activeFilter, setActiveFilter] = useState<FilterType | string>(\"all\");\n  const [customFilterCriteria, setCustomFilterCriteria] = useState<FilterCriteria | null>(null);\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n\n  // Collapsed tasks state - persisted in localStorage\n  const [collapsedTasks, setCollapsedTasks] = useState<Set<string>>(() => {\n    if (typeof window !== 'undefined') {\n      const saved = localStorage.getItem(`collapsed-tasks-${projectId}`);\n      return saved ? new Set(JSON.parse(saved)) : new Set();\n    }\n    return new Set();\n  });\n\n  // Hidden tasks state - persisted in localStorage\n  const [hiddenTasks, setHiddenTasks] = useState<Set<string>>(() => {\n    if (typeof window !== 'undefined') {\n      const saved = localStorage.getItem(`hidden-tasks-${projectId}`);\n      return saved ? new Set(JSON.parse(saved)) : new Set();\n    }\n    return new Set();\n    return new Set();\n  });\n  const [showHiddenTasks, setShowHiddenTasks] = useState(false);\n  const [showArchivedTasks, setShowArchivedTasks] = useState(false); // New state for archived tasks\n\n  const [projectUsers, setProjectUsers] = useState<{ id: string; name: string | null; email: string | null; image: string | null }[]>([]);\n  const [viewMode, setViewMode] = useState<'kanban' | 'gantt'>('kanban');\n\n  // Fetch project users for assignment\n  useEffect(() => {\n    const fetchProjectUsers = async () => {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/users`);\n        if (response.ok) {\n          const users = await response.json();\n          // Extract user objects from the response\n          setProjectUsers(users.map((u: any) => u.user));\n        }\n      } catch (error) {\n        console.error(\"Error fetching project users:\", error);\n      }\n    };\n    fetchProjectUsers();\n  }, [projectId]);\n\n  const selectedTask = useMemo(() =>\n    tasks.find((task) => task.id === selectedTaskId) || null,\n    [tasks, selectedTaskId]\n  );\n\n  // Filter tasks based on active filter\n  const filteredTasks = useMemo(() => {\n    const currentUserId = session?.user?.id;\n\n    // Handle custom filters\n    if (customFilterCriteria && activeFilter !== \"all\" && activeFilter !== \"my-tasks\" &&\n      activeFilter !== \"unassigned\" && activeFilter !== \"overdue\" && activeFilter !== \"this-week\") {\n      return tasks.filter(task => {\n        const { conditions, operator } = customFilterCriteria;\n\n        const results = conditions.map(condition => {\n          switch (condition.field) {\n            case \"assignee\":\n              if (condition.operator === \"equals\") {\n                return task.assignees?.some(a => a.id === condition.value);\n              }\n              if (condition.operator === \"isEmpty\") {\n                return !task.assignees || task.assignees.length === 0;\n              }\n              if (condition.operator === \"isNotEmpty\") {\n                return task.assignees && task.assignees.length > 0;\n              }\n              return false;\n\n            case \"priority\":\n              if (condition.operator === \"equals\") {\n                return task.priority === condition.value;\n              }\n              return false;\n\n            case \"tags\":\n              if (condition.operator === \"contains\") {\n                const tags = task.tags ? JSON.parse(task.tags) : [];\n                return tags.some((tag: any) => tag.name === condition.value);\n              }\n              return false;\n\n            case \"column\":\n              if (condition.operator === \"equals\") {\n                return task.columnId === condition.value;\n              }\n              return false;\n\n            case \"dueDate\":\n              if (!task.endDate) return condition.operator === \"isEmpty\";\n              const dueDate = new Date(task.endDate);\n              const compareDate = new Date(condition.value as string);\n\n              if (condition.operator === \"before\") {\n                return dueDate < compareDate;\n              }\n              if (condition.operator === \"after\") {\n                return dueDate > compareDate;\n              }\n              if (condition.operator === \"isNotEmpty\") {\n                return !!task.endDate;\n              }\n              return false;\n\n            case \"hasAttachments\":\n              const hasAttachments = task.attachments && JSON.parse(task.attachments as any).length > 0;\n              return condition.value ? hasAttachments : !hasAttachments;\n\n            case \"checklistStatus\":\n              if (!task.checklist) return false;\n              const checklist = JSON.parse(task.checklist);\n              const allCompleted = checklist.every((item: any) => item.completed);\n              return condition.value ? allCompleted : !allCompleted;\n\n            default:\n              return false;\n          }\n        });\n\n        return operator === \"AND\" ? results.every(r => r) : results.some(r => r);\n      });\n    }\n\n    // Handle predefined filters\n    switch (activeFilter) {\n      case \"my-tasks\":\n        return tasks.filter(task =>\n          task.assignees?.some(assignee => assignee.id === currentUserId)\n        );\n\n      case \"unassigned\":\n        return tasks.filter(task =>\n          !task.assignees || task.assignees.length === 0\n        );\n\n      case \"overdue\":\n        return tasks.filter(task => {\n          if (!task.endDate) return false;\n          const dueDate = new Date(task.endDate);\n          return dueDate < new Date();\n        });\n\n      case \"this-week\":\n        return tasks.filter(task => {\n          if (!task.endDate) return false;\n          const dueDate = new Date(task.endDate);\n          const weekFromNow = new Date();\n          weekFromNow.setDate(weekFromNow.getDate() + 7);\n          return dueDate >= new Date() && dueDate <= weekFromNow;\n        });\n\n      case \"all\":\n      default:\n        return tasks;\n    }\n  }, [tasks, activeFilter, customFilterCriteria, session?.user?.id]);\n\n  React.useEffect(() => {\n    if (fetchedColumns && Array.isArray(fetchedColumns)) {\n      console.log(\"useEffect: fetchedColumns updated\", fetchedColumns);\n      setColumns(fetchedColumns);\n      const allTasks = fetchedColumns.flatMap((col) =>\n        col.tasks.map((task) => ({ ...task, columnId: col.id }))\n      );\n      setTasks(allTasks);\n    }\n  }, [fetchedColumns]);\n\n  // Save collapsed state to localStorage whenever it changes\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      localStorage.setItem(\n        `collapsed-tasks-${projectId}`,\n        JSON.stringify(Array.from(collapsedTasks))\n      );\n    }\n  }, [collapsedTasks, projectId]);\n\n  // Toggle collapse state for a task\n  const toggleTaskCollapse = (taskId: string) => {\n    setCollapsedTasks(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(taskId)) {\n        newSet.delete(taskId);\n      } else {\n        newSet.add(taskId);\n      }\n      return newSet;\n    });\n  };\n\n  // Save hidden state to localStorage whenever it changes\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      localStorage.setItem(\n        `hidden-tasks-${projectId}`,\n        JSON.stringify(Array.from(hiddenTasks))\n      );\n    }\n  }, [hiddenTasks, projectId]);\n\n  // Toggle hidden state for a task\n  const toggleTaskHide = (taskId: string) => {\n    setHiddenTasks(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(taskId)) {\n        newSet.delete(taskId);\n      } else {\n        newSet.add(taskId);\n      }\n      return newSet;\n    });\n  };\n\n  // Filter out subtasks of collapsed parent tasks (only if in same column) AND archived tasks AND hidden tasks\n  const visibleTasks = useMemo(() => {\n    return tasks.filter(task => {\n      // Handle archived tasks\n      if (task.isArchived) {\n        return showArchivedTasks; // Only show if toggle is on\n      }\n      // If showing archived tasks, hide non-archived ones? No, usually show both or toggle view.\n      // Let's assume \"Show Archived\" adds them to the view or switches view.\n      // User asked \"where can I view archived\", so maybe a toggle \"View Archived\" is best.\n      // If showArchivedTasks is true, maybe ONLY show archived tasks? Or show mixed?\n      // Common pattern: \"Archived\" is a separate filter/view.\n      // Let's make it so if showArchivedTasks is true, we ONLY show archived tasks.\n      if (showArchivedTasks) return false;\n\n      // Hide temporarily hidden tasks (unless showHiddenTasks is true)\n      if (!showHiddenTasks && hiddenTasks.has(task.id)) return false;\n\n      // If task has no parent, it's always visible (unless archived/hidden)\n      if (!task.parentId) return true;\n\n      // Check if any ancestor is collapsed AND in the same column\n      let currentParentId: string | null | undefined = task.parentId;\n      while (currentParentId) {\n        const parent = tasks.find(t => t.id === currentParentId);\n        if (!parent) break;\n\n        // Only hide if parent is collapsed AND task is in same column as parent\n        if (collapsedTasks.has(currentParentId) && task.columnId === parent.columnId) {\n          return false; // Hide if parent is collapsed and in same column\n        }\n\n        currentParentId = parent.parentId || null;\n      }\n      return true;\n    });\n  }, [tasks, collapsedTasks, hiddenTasks, showHiddenTasks, showArchivedTasks]);\n\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 3,\n      },\n    })\n  );\n\n  const columnsId = useMemo(() => {\n    const ids = columns.map((col) => col.id);\n    console.log(\"useMemo: columnsId updated\", ids);\n    return ids;\n  }, [columns]);\n\n  const findColumn = useCallback(\n    (id: string) => {\n      return columns.find((col) => col.id === id);\n    },\n    [columns]\n  );\n\n  const findTask = useCallback(\n    (id: string) => {\n      return tasks.find((task) => task.id === id);\n    },\n    [tasks]\n  );\n\n  const onDragStart = useCallback((event: DragStartEvent) => {\n    console.log(\"onDragStart: active\", event.active.id, \"type\", event.active.data.current?.type);\n    setActiveItem(event.active);\n  }, []);\n\n  const onDragOver = useCallback((event: DragOverEvent) => {\n    // Empty onDragOver to prevent state updates during drag\n  }, []);\n\n  const onDragEnd = useCallback(async (event: DragEndEvent) => {\n    const { active, over } = event;\n    console.log(\"onDragEnd: active\", active.id, \"over\", over?.id);\n    setActiveItem(null);\n\n    if (!over) {\n      console.log(\"onDragEnd: Dropped outside, calling mutate()\");\n      mutate(); // If dropped outside, re-mutate to revert\n      return;\n    }\n\n    const activeId = active.id.toString();\n    const overId = over.id.toString();\n\n    if (activeId === overId) return;\n\n    const isActiveATask = active.data.current?.type === \"Task\";\n    const isOverATask = over.data.current?.type === \"Task\";\n    const isActiveAColumn = active.data.current?.type === \"Column\";\n    const isOverAColumn = over.data.current?.type === \"Column\";\n\n    // Handle Column Reordering\n    if (isActiveAColumn && isOverAColumn) {\n      const activeColumnIndex = columns.findIndex((col) => col.id === activeId);\n      const overColumnIndex = columns.findIndex((col) => col.id === overId);\n\n      const newColumns = arrayMove(columns, activeColumnIndex, overColumnIndex);\n      setColumns(newColumns);\n\n      // Update order in backend\n      await Promise.all(\n        newColumns.map(async (col, index) => {\n          if (col.order !== index) {\n            await fetch(\n              `/api/projects/${projectId}/columns/${col.id}`,\n              {\n                method: \"PUT\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ order: index }),\n              }\n            );\n          }\n        })\n      );\n      console.log(\"onDragEnd: Column reordered, calling mutate()\");\n      mutate(); // Re-mutate to refetch and ensure state consistency\n      return;\n    }\n\n    // Handle Task Movement within or between Columns\n    if (isActiveATask) {\n      const activeTask = tasks.find((task) => task.id === activeId);\n      if (!activeTask) return;\n\n      let newColumnId = activeTask.columnId;\n      let newOrder = activeTask.order;\n\n      // Determine the destination column ID\n      if (isOverATask) {\n        const overTask = tasks.find((task) => task.id === overId);\n        if (overTask) {\n          newColumnId = overTask.columnId;\n        }\n      } else if (isOverAColumn) {\n        newColumnId = overId;\n      }\n\n      // Calculate new order for the task\n      const tasksInNewColumn = tasks.filter((t) => t.columnId === newColumnId && t.id !== activeId);\n\n      // Special handling for subtasks: if the task has a parent and the parent is in the new column,\n      // position the subtask immediately after its parent\n      if (activeTask.parentId) {\n        const parentTask = tasks.find((t) => t.id === activeTask.parentId);\n        if (parentTask && parentTask.columnId === newColumnId) {\n          // Find parent's position in the new column\n          const parentIndex = tasksInNewColumn.findIndex(t => t.id === activeTask.parentId);\n          if (parentIndex !== -1) {\n            // Position subtask right after parent\n            newOrder = parentIndex + 1;\n          } else {\n            // Parent not found in filtered list, use normal logic\n            if (isOverATask) {\n              const overTaskIndex = tasksInNewColumn.findIndex(t => t.id === overId);\n              newOrder = overTaskIndex === -1 ? tasksInNewColumn.length : overTaskIndex;\n            } else {\n              newOrder = tasksInNewColumn.length;\n            }\n          }\n        } else {\n          // Parent is not in the new column, use normal positioning logic\n          if (isOverATask) {\n            const overTaskIndex = tasksInNewColumn.findIndex(t => t.id === overId);\n            newOrder = overTaskIndex === -1 ? tasksInNewColumn.length : overTaskIndex;\n          } else {\n            newOrder = tasksInNewColumn.length;\n          }\n        }\n      } else {\n        // Not a subtask, use normal positioning logic\n        if (isOverATask) {\n          const overTaskIndex = tasksInNewColumn.findIndex(t => t.id === overId);\n          newOrder = overTaskIndex === -1 ? tasksInNewColumn.length : overTaskIndex;\n        } else { // Dropped over a column or at the end\n          newOrder = tasksInNewColumn.length;\n        }\n      }\n\n      // Optimistic update for tasks array\n      setTasks((prevTasks) => {\n        // Find the active task before modifying prevTasks\n        const activeTaskInPrev = prevTasks.find((task) => task.id === activeId);\n        if (!activeTaskInPrev) return prevTasks; // Should not happen if activeTask is valid\n\n        // Check if this task has children (is a parent task)\n        const hasChildren = activeTaskInPrev.children && activeTaskInPrev.children.length > 0;\n        const isColumnChanging = activeTaskInPrev.columnId !== newColumnId;\n\n        // Create the moved task with its new properties\n        const movedTask = { ...activeTaskInPrev, columnId: newColumnId, order: newOrder };\n\n        // Filter out the active task from its current position\n        let tasksWithoutActive = prevTasks.filter((t) => t.id !== activeId);\n\n        // If moving to a different column and has children, also move ALL descendants recursively\n        if (isColumnChanging && hasChildren) {\n          // Recursive function to get all descendant IDs\n          const getAllDescendantIds = (parentTaskId: string, allTasks: typeof prevTasks): string[] => {\n            const children = allTasks.filter(t => t.parentId === parentTaskId);\n            if (children.length === 0) return [];\n\n            const childIds = children.map(c => c.id);\n            const grandchildIds = childIds.flatMap(id => getAllDescendantIds(id, allTasks));\n\n            return [...childIds, ...grandchildIds];\n          };\n\n          const descendantIds = getAllDescendantIds(activeId, prevTasks);\n\n          // Update all descendants to the new column\n          tasksWithoutActive = tasksWithoutActive.map((t) => {\n            if (descendantIds.includes(t.id)) {\n              return { ...t, columnId: newColumnId };\n            }\n            return t;\n          });\n        }\n\n        if (activeTaskInPrev.columnId === newColumnId) {\n          // Moving within the same column\n          const columnTasks = tasksWithoutActive\n            .filter(t => t.columnId === newColumnId)\n            .concat(movedTask)\n            .sort((a, b) => a.order - b.order)\n            .map((t, index) => ({ ...t, order: index }));\n\n          const otherTasks = prevTasks.filter(t => t.columnId !== newColumnId);\n          return [...otherTasks, ...columnTasks];\n        } else {\n          // Moving between different columns\n          const tasksInSourceColumn = tasksWithoutActive\n            .filter(t => t.columnId === activeTaskInPrev.columnId)\n            .sort((a, b) => a.order - b.order) // Ensure stable sort for re-indexing\n            .map((t, index) => ({ ...t, order: index }));\n\n          const tasksInDestinationColumn = tasksWithoutActive\n            .filter(t => t.columnId === newColumnId)\n            .concat(movedTask) // Add the moved task to the destination column's tasks\n            .sort((a, b) => a.order - b.order) // Ensure stable sort for re-indexing\n            .map((t, index) => ({ ...t, order: index }));\n\n          // Tasks that were not in the source or destination column\n          const otherTasksUnmodified = prevTasks.filter(\n            t => t.columnId !== activeTaskInPrev.columnId && t.columnId !== newColumnId\n          );\n\n          // Combine all tasks back into a single array\n          return [...otherTasksUnmodified, ...tasksInSourceColumn, ...tasksInDestinationColumn];\n        }\n      });\n\n      // Update server in background\n      try {\n        const response = await fetch(`/api/projects/${projectId}/tasks/${activeId}`, {\n          method: \"PUT\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ columnId: newColumnId, order: newOrder }),\n        });\n        if (!response.ok) {\n          console.error(\"onDragEnd: Failed to move task on server\");\n          // Revert optimistic update on failure\n          mutate();\n          alert(\"Failed to move task. Please try again.\");\n          return;\n        }\n        console.log(\"onDragEnd: Task moved successfully on server\");\n        // Revalidate to ensure consistency with server\n        mutate();\n      } catch (error) {\n        console.error(\"onDragEnd: Error moving task\", error);\n        // Revert optimistic update on error\n        mutate();\n        alert(\"An error occurred while moving the task.\");\n      }\n      return;\n    }\n    console.log(\"onDragEnd: No valid drag operation\");\n  }, [columns, tasks, projectId, mutate]);\n\n  // Function to add a new column\n  const handleAddColumn = async () => {\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) return;\n    const newColumnName = prompt(\"Enter new column name:\");\n    if (newColumnName) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ name: newColumnName }),\n        });\n        if (response.ok) {\n          console.log(\"handleAddColumn: Column added successfully, calling mutate()\");\n          mutate(); // Re-fetch data to include the new column\n        } else {\n          console.error(\"Failed to add column\");\n        }\n      } catch (error) {\n        console.error(\"Error adding column:\", error);\n      }\n    }\n  };\n\n  // Function to create a new task within a column\n  const handleCreateTask = async (columnId: string) => {\n    if (!can(PERMISSIONS.CREATE_TASK)) return;\n    const newTaskTitle = prompt(\"Enter new task title:\");\n    if (newTaskTitle) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/tasks`, {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ title: newTaskTitle, columnId }),\n        });\n        if (response.ok) {\n          console.log(\"handleCreateTask: Task added successfully, calling mutate()\");\n          mutate(); // Re-fetch data to include the new task\n        } else {\n          console.error(\"Failed to add task\");\n        }\n      } catch (error) {\n        console.error(\"Error adding task:\", error);\n      }\n    }\n  };\n\n  const handleEditColumnName = async (columnId: string, currentName: string) => {\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) return;\n    const newName = prompt(\"Edit column name:\", currentName);\n    if (newName && newName !== currentName) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns/${columnId}`, {\n          method: \"PUT\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ name: newName }),\n        });\n        if (response.ok) {\n          console.log(\"handleEditColumnName: Column name edited successfully, calling mutate()\");\n          mutate();\n        } else {\n          console.error(\"Failed to edit column name\");\n        }\n      } catch (error) {\n        console.error(\"Error editing column name:\", error);\n      }\n    }\n  };\n\n  const handleColorChange = async (columnId: string, newColumnColor: string, newCardColor: string) => {\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) return;\n\n    // Optimistic update\n    const originalColumns = columns;\n    const newColumns = columns.map((col) =>\n      col.id === columnId ? { ...col, color: newColumnColor, cardColor: newCardColor } : col\n    );\n    setColumns(newColumns);\n\n    try {\n      const response = await fetch(`/api/projects/${projectId}/columns/${columnId}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ color: newColumnColor, cardColor: newCardColor }),\n      });\n\n      if (!response.ok) {\n        // Revert on failure\n        setColumns(originalColumns);\n        alert(\"Failed to update column color.\");\n      }\n      // No need to call mutate() on success as we already updated optimistically\n    } catch (error) {\n      // Revert on error\n      setColumns(originalColumns);\n      console.error(\"Error updating column color:\", error);\n      alert(\"An error occurred while updating the color.\");\n    }\n  };\n\n  const handleDeleteColumn = async (columnId: string) => {\n    if (!can(PERMISSIONS.MANAGE_PROJECT)) return;\n    if (confirm(\"Are you sure you want to delete this column and all its tasks?\")) {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/columns/${columnId}`, {\n          method: \"DELETE\",\n        });\n        if (response.ok) {\n          console.log(\"handleDeleteColumn: Column deleted successfully, calling mutate()\");\n          mutate();\n        } else {\n          console.error(\"Failed to delete column\");\n        }\n      } catch (error) {\n        console.error(\"Error deleting column:\", error);\n      }\n    }\n  };\n\n  const handleTaskClick = (taskId: string) => {\n    console.log(\"Task clicked:\", taskId); // Debugging\n    setSelectedTaskId(taskId);\n    setIsModalOpen(true);\n    console.log(\"isModalOpen set to true\"); // Debugging\n  };\n\n  const handleCloseModal = () => {\n    setIsModalOpen(false);\n    setSelectedTaskId(null);\n    console.log(\"Modal closed\"); // Debugging\n  };\n\n  const handleProgressChange = async (taskId: string, newProgress: number) => {\n    if (!can(PERMISSIONS.EDIT_ANY_TASK)) {\n      // Check if it's own task\n      const task = tasks.find(t => t.id === taskId);\n      const isOwnTask = task?.assignees?.some(a => a.id === session?.user?.id);\n      if (!isOwnTask && !can(PERMISSIONS.EDIT_OWN_TASK)) return;\n    }\n\n    // Optimistic update\n    const originalTasks = tasks;\n    const updatedTasks = tasks.map((t) =>\n      t.id === taskId ? { ...t, progress: newProgress } : t\n    );\n    setTasks(updatedTasks);\n\n    try {\n      const response = await fetch(`/api/projects/${projectId}/tasks/${taskId}`, {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ progress: newProgress }),\n      });\n\n      if (response.ok) {\n        mutate(); // Re-fetch to ensure consistency (especially for cascade updates)\n      } else {\n        setTasks(originalTasks);\n        console.error(\"Failed to update progress\");\n      }\n    } catch (error) {\n      setTasks(originalTasks);\n      console.error(\"Error updating progress:\", error);\n    }\n  };\n\n\n  if (error) return <div>Failed to load kanban board.</div>;\n\n  const activeTaskContent = activeItem?.data.current?.type === \"Task\"\n    ? tasks.find(t => t.id === activeItem.id)\n    : null;\n\n  return (\n    <div>\n      <div className=\"flex flex-col h-screen\">\n        {/* Header - Always visible */}\n        <div className=\"header\">\n          <Link href=\"/dashboard\" className=\"header-title hover:text-gray-300 transition-colors\">\n            {\"< Project\"}\n          </Link>\n          <div className=\"flex items-center gap-2\">\n            {/* Filter Bar integrated into header */}\n            <div className=\"mr-4\">\n              <FilterBar\n                projectId={projectId}\n                currentUserId={session?.user?.id || \"\"}\n                activeFilter={activeFilter}\n                onFilterChange={(filter, criteria) => {\n                  setActiveFilter(filter);\n                  setCustomFilterCriteria(criteria || null);\n                }}\n                availableUsers={projectUsers}\n                availableColumns={columns.map(col => ({ id: col.id, name: col.name }))}\n              />\n            </div>\n            {/* Show Archived Tasks Toggle */}\n            <Button\n              onClick={() => setShowArchivedTasks(!showArchivedTasks)}\n              variant=\"ghost\"\n              size=\"sm\"\n              className={`bg-white text-slate-700 hover:bg-slate-100 border border-slate-200 shadow-sm transition-all ${showArchivedTasks ? 'bg-amber-50 text-amber-600 border-amber-200' : ''}`}\n              title={showArchivedTasks ? \"Volver a tareas activas\" : \"Ver tareas archivadas\"}\n            >\n              <Archive className=\"w-4 h-4 mr-2\" />\n              {showArchivedTasks ? \"Activas\" : \"Archivadas\"}\n            </Button>\n            {/* Show Hidden Tasks Toggle */}\n            <Button\n              onClick={() => setShowHiddenTasks(!showHiddenTasks)}\n              variant=\"ghost\"\n              size=\"sm\"\n              className={`bg-white text-slate-700 hover:bg-slate-100 border border-slate-200 shadow-sm transition-all ${showHiddenTasks ? 'bg-blue-50 text-blue-600 border-blue-200' : ''}`}\n              title={showHiddenTasks ? \"Ocultar tareas escondidas\" : \"Mostrar tareas escondidas\"}\n            >\n              {showHiddenTasks ? <Eye className=\"w-4 h-4 mr-2\" /> : <EyeOff className=\"w-4 h-4 mr-2\" />}\n              {showHiddenTasks ? \"Ocultar\" : \"Mostrar\"}\n            </Button>\n            <Button\n              onClick={() => setViewMode(viewMode === 'kanban' ? 'gantt' : 'kanban')}\n              variant=\"ghost\"\n              size=\"sm\"\n              className={`${viewMode === 'gantt'\n                ? 'bg-blue-500 text-white hover:bg-blue-600'\n                : 'bg-white text-slate-700 hover:bg-slate-100'\n                } border border-slate-200 shadow-sm transition-all`}\n            >\n              <BarChart3 className=\"w-4 h-4 mr-2\" />\n              {viewMode === 'kanban' ? 'Ganttifícalo' : 'Kanban'}\n            </Button>\n            {can(PERMISSIONS.MANAGE_PROJECT) && (\n              <>\n                <Button\n                  onClick={() => setIsSettingsOpen(true)}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"bg-white text-slate-700 hover:bg-slate-100 border border-slate-200 shadow-sm\"\n                >\n                  <Settings className=\"w-4 h-4 mr-2\" />\n                  Settings\n                </Button>\n                {/* Add Column Button - Only for Managers */}\n                {can(PERMISSIONS.MANAGE_PROJECT) && (\n                  <Button onClick={handleAddColumn} className=\"btn-primary\">Add Column</Button>\n                )}\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* Content Area - Show loading only if initial load */}\n        {!fetchedColumns && columns.length === 0 ? (\n          <div className=\"flex-1 flex items-center justify-center\">\n            <div>Loading...</div>\n          </div>\n        ) : (\n          <div className=\"flex-1 overflow-hidden\">\n\n            {/* Conditional View: Kanban or Gantt */}\n            {viewMode === 'kanban' ? (\n              <DndContext\n                sensors={sensors}\n                collisionDetection={pointerWithin}\n                onDragStart={onDragStart}\n                onDragEnd={onDragEnd}\n                onDragOver={onDragOver}\n              >\n                <div className=\"h-full overflow-x-auto overflow-y-hidden px-8 pt-8 pb-10 bg-neutral-50\">\n                  <SortableContext items={columnsId}>\n                    <div className=\"flex gap-4 h-full\">\n                      {columns.map((col) => {\n                        // Filter tasks for this column\n                        const columnTasks = visibleTasks.filter(task => task.columnId === col.id && filteredTasks.includes(task)).sort((a, b) => a.order - b.order);\n\n                        return (\n                          <Column\n                            key={col.id}\n                            id={col.id}\n                            title={col.name}\n                            color={col.color}\n                            cardColor={col.cardColor}\n                            tasks={columnTasks}\n                            onEditName={handleEditColumnName}\n                            onDelete={handleDeleteColumn}\n                            onCreateTask={handleCreateTask}\n                            onTaskClick={handleTaskClick}\n                            onColorChange={handleColorChange}\n                            onProgressChange={handleProgressChange} // Pass handler\n                            collapsedTasks={collapsedTasks}\n                            onToggleCollapse={toggleTaskCollapse}\n                            onToggleHide={toggleTaskHide}\n                            hiddenTasks={hiddenTasks}\n                          />\n                        );\n                      })}\n                    </div>\n                  </SortableContext>\n                </div>\n                {createPortal(\n                  <DragOverlay>\n                    {activeItem && activeItem.data.current?.type === \"Task\" && activeTaskContent ? (\n                      <Task\n                        id={activeTaskContent.id}\n                        title={activeTaskContent.title} // Pass title here\n                        subtasksCount={activeTaskContent.children?.length || 0}\n                      />\n                    ) : null}\n                    {activeItem && activeItem.data.current?.type === \"Column\" ? (\n                      <div className=\"column dragging\">\n                        <h2 className=\"column-title\">{findColumn(activeItem.id.toString())?.name}</h2>\n                        {/* Optionally render tasks in the dragged column */}\n                      </div>\n                    ) : null}\n                  </DragOverlay>,\n                  document.body\n                )}\n              </DndContext>\n            ) : (\n              <div className=\"h-full px-8 pt-8 pb-10\">\n                <GanttChart\n                  tasks={filteredTasks}\n                  columns={columns}\n                  onTaskClick={handleTaskClick}\n                  onTaskUpdate={mutate}\n                />\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      {/* Project Settings Modal */}\n      {isSettingsOpen && createPortal(\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto relative\">\n            <button\n              onClick={() => setIsSettingsOpen(false)}\n              className=\"absolute top-4 right-4 text-gray-500 hover:text-gray-700\"\n            >\n              <X size={24} />\n            </button>\n            <div className=\"p-6\">\n              <ProjectSettings projectId={projectId} />\n            </div>\n          </div>\n        </div>,\n        document.body\n      )}\n\n      {selectedTask && isModalOpen && (\n        <TaskDetailModal\n          key={selectedTask.id}\n          task={selectedTask}\n          onClose={handleCloseModal}\n          onTaskUpdate={mutate}\n          availableUsers={projectUsers}\n        />\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}